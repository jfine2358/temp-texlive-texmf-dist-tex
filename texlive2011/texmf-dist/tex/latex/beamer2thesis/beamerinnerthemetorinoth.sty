%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% Copyright 2011 by Fiandrino Claudio
%
% This file may be distributed and/or modified
%
% 1. under the LaTeX Project Public License and/or
% 2. under the GNU Public License.
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\mode<presentation>

% Logo to use in the title page
\def\beamer@torinoth@titlepagelogo{}
\DeclareOptionBeamer{titlepagelogo}{\def\beamer@torinoth@titlepagelogo{#1}}

% Second optional logo to use in the title page
\DeclareOptionBeamer{secondlogo}[true]{\def\beamer@torinoth@secondlogo{#1}}
\ExecuteOptionsBeamer{secondlogo=false}

% Language
\DeclareOptionBeamer{language}[italian]{\def\beamer@torinoth@language{#1}}
\ExecuteOptionsBeamer{language=english}

% Second candidate
\DeclareOptionBeamer{secondcandidate}[true]{\def\beamer@torinoth@secondcandidate{#1}}
\ExecuteOptionsBeamer{secondcandidate=false}


% Bullet shape
\DeclareOptionBeamer{bullet}{\def\beamer@torinoth@bullet{#1}}
\ExecuteOptionsBeamer{bullet=circle}

\ProcessOptionsBeamer

% Definition of second logo if request
\def\beamer@torinoth@secondlogotext{true}%
\ifx\beamer@torinoth@secondlogo\beamer@torinoth@secondlogotext%
  \def\titlepagesecondlogo#1{\gdef\@titlepagesecondlogo{#1}}%
\fi%

% Package usage according to language
\def\beamer@torinoth@italiantext{italian}%
  \ifx\beamer@torinoth@language\beamer@torinoth@italiantext%
    \RequirePackage[italian]{babel}%
  \else%
    \RequirePackage[english]{babel}%
  \fi%

% Ateneo
\providecommand{\ateneo}{\institute}%
\providecommand{\insertateneo}{\insertinstitute}%

% Supervisor
\def\rel#1{\gdef\@rel{#1}}

% Second candidate
\def\beamer@torinoth@secondcandtext{true}%
\ifx\beamer@torinoth@secondcandidate\beamer@torinoth@secondcandtext%
     \def\secondcandidate#1{\gdef\@secondcandidate{#1}}%
\fi

% Margins
\newlength{\beamer@torinoth@normalmargin}
\setlength{\beamer@torinoth@normalmargin}{.055\paperwidth}
\setbeamersize{text margin left=\beamer@torinoth@normalmargin}
\setbeamersize{text margin right=\beamer@torinoth@normalmargin}
\setlength\leftmargini{.6\beamer@torinoth@normalmargin}
\setlength\leftmarginii{.6\beamer@torinoth@normalmargin}
\setlength\leftmarginiii{.6\beamer@torinoth@normalmargin}

% Thesis title page
\defbeamertemplate*{title page}{torinoth}[1][]
{

   % Logo & Ateneo
   \begin{centering}
     \begin{beamercolorbox}[rounded=true,shadow=true,wd=.9\paperwidth,sep=8pt,center,#1]{ateneo page header}%
       \usebeamerfont{ateneo}\insertateneo\par%
     \end{beamercolorbox}
     \vskip0.5em%
     % Check-second-logo
     \def\beamer@torinoth@secondlogotext{true}%
     \ifx\beamer@torinoth@secondlogo\beamer@torinoth@secondlogotext%
        \hbox{
            % First-column
            \begin{beamercolorbox}[wd=0.475\paperwidth,center]{}
            \includegraphics[height=.225\paperheight]{\beamer@torinoth@titlepagelogo}%
            \end{beamercolorbox}
            % Second-column
            \begin{beamercolorbox}[wd=0.325\paperwidth,center]{}
            \includegraphics[height=.225\paperheight]{\@titlepagesecondlogo}%
            \end{beamercolorbox}}
     \else%
        \includegraphics[height=.225\paperheight]{\beamer@torinoth@titlepagelogo}%
     \fi%
     \vfill%
   \end{centering}
  % Title
  \begin{centering}
     \begin{beamercolorbox}[wd=\paperwidth,sep=8pt,center,#1]{title page header}
       \usebeamerfont{title}\inserttitle\par% 
     \end{beamercolorbox}%
  \end{centering}
  \vskip1em\par%
  
  % definitions
  \begin{columns}
    % First column
    \column{.5\paperwidth}%
    % Supervisor-language-check
    \def\beamer@torinoth@italiantext{italian}%
    \ifx\beamer@torinoth@language\beamer@torinoth@italiantext%
      \def\beamer@torinoth@superv{Relatore}%
    \else%
      \def\beamer@torinoth@superv{Supervisor}%
    \fi%
    \begin{beamercolorbox}[sep=8pt,center,#1]{rel}
      \usebeamerfont{definition}\beamer@torinoth@superv%
    \end{beamercolorbox}
    % Second column
    \column{.5\paperwidth}%
    % Number-candidates-check
    \def\beamer@torinoth@secondcandtext{true}%
    \ifx\beamer@torinoth@secondcandidate\beamer@torinoth@secondcandtext%
       % Candidate-language-check
       \def\beamer@torinoth@italiantext{italian}%
       \ifx\beamer@torinoth@language\beamer@torinoth@italiantext%
         \def\beamer@torinoth@cand{Candidati}%
       \else%
         \def\beamer@torinoth@cand{Candidates}%
       \fi%
    \else%
       % Candidate-language-check
       \def\beamer@torinoth@italiantext{italian}%
       \ifx\beamer@torinoth@language\beamer@torinoth@italiantext%
         \def\beamer@torinoth@cand{Candidato}%
       \else%
         \def\beamer@torinoth@cand{Candidate}%
       \fi%
    \fi%
    \begin{beamercolorbox}[sep=8pt,center,#1]{author}
      \usebeamerfont{definition}\beamer@torinoth@cand%
    \end{beamercolorbox}
  \end{columns}
  \vskip-0.5em%
  % Check-number-candidates
  \def\beamer@torinoth@secondcandtext{true}%
  \ifx\beamer@torinoth@secondcandidate\beamer@torinoth@secondcandtext%
     \begin{columns}
       \column{.5\paperwidth}%
       % Supervisor
       \begin{beamercolorbox}[sep=8pt,center,#1]{rel}%
         \usebeamerfont{person}\@rel%
       \end{beamercolorbox}
       \column{.5\paperwidth}
       % First-candidate
       \begin{beamercolorbox}[sep=8pt,center,#1]{author}%
         \usebeamerfont{person}\insertauthor%
       \end{beamercolorbox}
     \end{columns}
     \vskip-0.75em%
     \begin{columns}
       \column{.5\paperwidth}%
       % No-Supervisor
       \column{.5\paperwidth}
       % First-candidate
       \begin{beamercolorbox}[sep=8pt,center,#1]{author}%
         \usebeamerfont{person}\@secondcandidate%
       \end{beamercolorbox}
     \end{columns}
  \else%
    \begin{columns}
    \column{.5\paperwidth}%
    % Supervisor
    \begin{beamercolorbox}[sep=8pt,center,#1]{rel}%
      \usebeamerfont{person}\@rel%
    \end{beamercolorbox}
    \column{.5\paperwidth}
    % Candidate
    \begin{beamercolorbox}[sep=8pt,center,#1]{author}%
      \usebeamerfont{person}\insertauthor%
    \end{beamercolorbox}
    \end{columns}
  \fi%
  \vskip2em%
  % Date
  \begin{centering}
    \begin{beamercolorbox}[sep=8pt,center,#1]{date}%
      \usebeamerfont{date}\insertdate%
    \end{beamercolorbox}%\vskip0.5em
    \end{centering}
  \vfill
}

% Itemize environment thesis-modifications

% Square mode
\defbeamertemplate{itemize item}{squarem}%
{\tiny\raise.5ex\hbox{\donotcoloroutermaths$\blacksquare$}}
\defbeamertemplate{itemize subitem}{squarem}%
{\tiny\raise.4ex\hbox{\donotcoloroutermaths$\square$}}
\defbeamertemplate{itemize subsubitem}{squarem}%
{\tiny\raise.3ex\hbox{\donotcoloroutermaths$\blacksquare$}}

% Diamond mode
\defbeamertemplate{itemize item}{diamondm}%
{\tiny\raise.5ex\hbox{\donotcoloroutermaths$\blacklozenge$}}
\defbeamertemplate{itemize subitem}{diamondm}%
{\tiny\raise.4ex\hbox{\donotcoloroutermaths$\lozenge$}}
\defbeamertemplate{itemize subsubitem}{diamondm}%
{\tiny\raise.3ex\hbox{\donotcoloroutermaths$\blacklozenge$}}

% Triangle mode
\defbeamertemplate{itemize item}{trianglem}%
{\tiny\raise.5ex\hbox{\donotcoloroutermaths$\blacktriangleright$}}
\defbeamertemplate{itemize subitem}{trianglem}%
{\tiny\raise.4ex\hbox{\donotcoloroutermaths$\vartriangleright$}}
\defbeamertemplate{itemize subsubitem}{trianglem}%
{\tiny\raise.3ex\hbox{\donotcoloroutermaths$\blacktriangleright$}}

% Circle mode
\defbeamertemplate{itemize item}{circlem}%
{\small\raise.2ex\hbox{\donotcoloroutermaths$\bullet$}}
\defbeamertemplate{itemize subitem}{circlem}%
{\small\raise.1ex\hbox{\donotcoloroutermaths$\circ$}}
\defbeamertemplate{itemize subsubitem}{circlem}%
{\scriptsize\raise.1ex\hbox{\donotcoloroutermaths$\bullet$}}

\def\options{square}
\def\optiond{diamond}
\def\optiont{triangle}
\def\optionc{circle}

\ifx\beamer@torinoth@bullet\options
  \setbeamertemplate{items}[squarem]
\fi
\ifx\beamer@torinoth@bullet\optiond
  \setbeamertemplate{items}[diamondm]
\fi
\ifx\beamer@torinoth@bullet\optiont
  \setbeamertemplate{items}[trianglem]
\fi
\ifx\beamer@torinoth@bullet\optionc
  \setbeamertemplate{items}[circlem]
\fi

\mode<all>

