\chyph % pou¾ijte csplain

% Pøimlovám se k tomu nepøeznaèkovávat èlánek do LaTeXu
% Na èlánku toti¾ demonstruji vlastnosti OFS a opírám se
% o OFS z plainu. Pøechod na LaTeX se zachováním tìchto vlastností
% by nebyl jednoduchý. Mù¾ete rozbalit metriky
% a virtuální fonty k Charteru (pøilo¾ený charter8z.zip) do 
% pracovního adresáøe a zpracovat csplainem na instalaci TeXu, 
% která obsahuje OFS. Pøed spu¹tìním dvips je pak potøeba doplnit 
% do psfonts.map ètyøi øádky uvedené v souboru mapfile. Mù¾ete mì také
% informovat o tom, na kterých stránkách se dokument bude ve sborníku
% nacházet, já opravím údaj \firstpage, zplainuji to, zdvipsuji a
% po¹lu obratem zpátky.

\newcount\firstpage   \firstpage=79
\newcount\numpages    \numpages=14

\def\addcmd #1#2{\expandafter\def\expandafter\tmpa\expandafter{#1}%
   \def\tmpb{#1}%
   \ifx\tmpa\tmpb % the #1 is not a macro
      \expandafter\let\csname \string#1-original\endcsname =#1%
      \expandafter\def\expandafter #1\expandafter{%
           \csname\string#1-original\endcsname #2}%
   \else          % the #1 is a macro
      \expandafter\def\expandafter #1\expandafter{#1#2}%
   \fi}

\input ofs [ffonts]                  % Charter je ve skupinì free fonts
\setfonts [Charter/10pt]             % výchozí rodina
\setmath[//]                         % inicializace matematiky
\fontdef\tt [CMTypewriter/mag1.1]    % strojopis, korekce støední vý¹ky
\fontdef\verbtt [CMTypewriter-rm/8]  % strojopis pro display ukázky
\fontdef\small [!/9]                 % zmen¹ení pro abstrakt a záhlaví
\addcmd \small {\baselineskip11pt \rm \def\mathversion{normal}\setmath[//]}
\fontdef\fontsekce [!/12]            % pro nadpisy sekcí
\addcmd \fontsekce {\bf \let\it=\bi \def\mathversion{bold}\setmath[//]} 
\fontdef\fonttitul [!-bf/14.4]       % titul

\hsize=12,2cm
\vsize=19,3cm
\hoffset=63pt
\voffset=43pt
\parindent=14pt

\lineskiplimit=-10pt
\raggedbottom

\exhyphenpenalty=10000
\widowpenalty=10000
\clubpenalty=10000

\showboxdepth=10 \showboxbreadth=50

\def\starthead{\global\headline=
     {\small \ifodd\pageno \hfil \thetitul \headspace \the\pageno 
     \else \the\pageno \headspace \theauthor \hfil \fi}}
\headline={\hfil\starthead}
\def\headspace{\hskip2.5em\relax}
\def\makeheadline{\vbox to0pt{\vskip-25pt
  \line{\vbox to8.5pt{}\the\headline}\vss}\nointerlineskip}
\footline={\setfonts[/7]\setmath[//]\baselineskip=9pt
     \vbox{\hbox{\copytext}\hbox{\copykonvoj}}\hfil
     \global\footline={}}
\def\lastpage{\advance\firstpage by\numpages \advance\firstpage by-1
     \the\firstpage}

\def\copytext{Jan Kasprzak, Petr Sojka (editoøi): \SLT~2002 -- sborník
       semináøe o~Linuxu a \TeX{}u, str. \the\firstpage--\lastpage, 2002.}
\def\copykonvoj{\copyright~Konvoj, CSTUG, CZLUG 2002}

\newcount\subnum

\def\kap #1\par{\advance\subnum by1
   \removelastskip %\goodbreak
   \vskip17pt plus2pt minus1pt\noindent{\fontsekce
   \ifnum\subnum>1 \the\subnum\enspace\enspace\fi #1}%
   \par\nobreak\vskip11pt plus2pt minus1pt 
   \everypar{\setbox0=\lastbox \everypar={}}}
\def\reference {\subnum=-1 \kap Reference\par \small}
\def\bib{\par\advance\subnum by1 \leftskip=\parindent 
   \noindent\llap{\the\subnum.\enspace}\ignorespaces}

\let\orifootnote=\footnote
\newcount\footnotenum
\def\footnote#1{\global\advance\footnotenum by1
   \orifootnote{$\setmath[//]^\the\footnotenum$}{\small 
        \hangindent=\parindent #1\par}}
\def\footnoterule{\kern-3pt \hrule width 2cm \kern2.6pt }

\def\titul #1 \par{\def\thetitul{#1}\pageno=\firstpage
   \centerline{\fonttitul #1}\vskip20pt\relax}
\def\autor #1 \par{\def\theauthor{#1}
   \centerline{#1}\vskip10pt\relax}
\def\institut #1 \par{\centerline{\small #1}}
\def\email #1 \par{\centerline{\small Email: \tt #1}\vskip20pt\relax}
\def\abstrakt #1\par{\bgroup \small
   \leftskip=3em \rightskip=3em
   \noindent{\bf Abstrakt:}\enspace #1\par \egroup\bigskip}
\def\url#1{{\tt#1}}

\font\mflogo=logo10                       % METAFONT logo
\font\boldsy=cmbsy10 at12pt               % Tuèné \CS, \AMS.
\font\bboldsy=cmbsy10 scaled\magstep2     % Tuèné \CS v titulu

\def\CS{$\cal C\kern-.1667em\lower.5ex\hbox{$\cal S$}\kern-.075em $}
\def\bCS{{\boldsy C\kern-.1667em\lower.5ex\hbox{S}\kern-.04em}}
\def\CSTeX{\CS\TeX}
\def\CSTUG{\CS TUG}
\def\CSfont{\CS\kern.1em font}
\def\csplain{\CS\kern.1em plain} \let\CSplain=\csplain
\def\mf{{\mflogo META}\-{\mflogo FONT}}
\def\mp{{\mflogo META}\-{\mflogo POST}}
\def\LaTeX{L\kern-.2em\raise.45ex\hbox{\setfonts[/mag.7] A}\kern-.05em\TeX}
\def\twoe{$2_{\textstyle\varepsilon}$}
\def\LaTeXe{\LaTeX\thinspace\twoe}
\def\cslatex{\CS\kern.05em\LaTeX} \let\CSLaTeX=\cslatex
\def\twoe{$2_{\textstyle\varepsilon}$}
\def\LaTeXe{\LaTeX\thinspace\twoe}
\def\AMS{$\cal A\kern-.166em\lower.5ex\hbox{$\cal M$}\kern-.075em S$}
\def\bAMS{{\boldsy A\kern-.166em\lower.5ex\hbox{M}\kern-.075em S}}
\def\ps{Post\-Script}
\def\SLT{S\kern-0.025em\lower.5ex\hbox{L}\kern-.2emT}
\def\DOS{\hbox{DOS}}

%% Definice verbatim prostøedí %%          !verb.
\catcode`\"=13
\def"{\hbox\bgroup\let"=\egroup\setverb\tt}
\def\setverb{\def\do##1{\catcode`##1=12}\dospecials\obeyspaces}
\def\begtt{\medskip\bgroup
   \nobreak\setverb \parskip=0pt %\parindent=0pt
   \catcode`\"=12\catcode`\~=13 \obeylines
   \baselineskip=10pt
   \let\tt=\verbtt \startverb}
{\catcode`\|=0 \catcode`\\=12
  |gdef|startverb#1\endtt{%
        |tt#1|nobreak|egroup|penalty0|medskip|scannexttoken}}
{\obeyspaces\gdef {\ }}
\long\def\scannexttoken#1{\ifx#1\par\else\noindent#1\fi}

\def\citeref #1 #2 {\expandafter\def\csname cit:#1\endcsname{#2}}
\citeref pismolijna  1
\citeref ofsftp      2
\citeref ofsdoc      3
\citeref stormcl     4
\def\cite#1{\expandafter\ifx \csname cit:#1\endcsname\relax
   \message{Warning: cite{#1} is not defined}[??]%
   \else [\csname cit:#1\endcsname]\fi}

%-------------------------------------------------------------------------

\titul  Makro OFS
        %%%%%%%%%

\autor Petr Ol¹ák

\institut Elektrotechnická fakulta ÈVUT, Praha

\email olsak@math.feld.cvut.cz

\abstrakt 
   OFS (Ol¹ákùv fontový systém) je balíèek TeXových maker, který
   umo¾ní získat vìt¹í pøehled nad rozsáhlými kolekcemi fontù a umo¾ní
   s~nimi pomìrnì snadnou manipulaci. Balík byl vyvinut pro získání
   pøehledu nad fonty z~Typokatalogu Støe¹ovické písmolijny~\cite{pismolijna}.
   Na základì poptávky \LaTeX{}ových u¾ivatelù byl balík
   napsán je¹tì jednou pro \LaTeX, kde vyu¾ívá NFSS a pokou¹í se je
   tro¹ièku vylep¹it. Základní u¾ivatelské pøíkazy OFS jsou pak v~obou
   prostøedích (plain i \LaTeX) stejné. Na pøedná¹ce pøedvedu pou¾ití
   OFS na u¾ivatelské i konfiguraèní úrovni.

\kap Úvodem
%----------

Makro OFS jsem si napsal hlavnì proto, abych se vyznal ve stovkách
fontù, které pocházely ze Støe¹ovické písmolijny a pro které jsem
pøed rokem udìlal \TeX{}ovou podporu. Proto¾e jsem plainista, ¹lo mi
hlavnì o~to udìlat makro co nejvíce srozumitelné u¾ivateli plainu,
který potøebuje pøesnì vìdìt, co to makro dìlá. Tento po¾adavek
napøíklad \LaTeX{}ové NFSS nesplòuje.

Pozdìji se zaèali o~OFS zajímat té¾ nìkteøí u¾ivatelé \LaTeX{}u. To¾
jsem se pøemohl a pokusil OFS napsat je¹tì jednou, tentokrát pod
\LaTeX{}em s~vyu¾itím~NFSS. Cílem tohoto pøepsání bylo hlavnì to, aby
se u¾ivatelské pøíkazy pro vyhledávání a pøepínání rodin fontù
zcela shodovaly v~\LaTeX{}ové verzi s~verzí plainovou. \LaTeX{}ová
verze pøesto umí podstatnì ménì vìcí, ne¾ plainová, proto¾e pokud by
mìla umìt v¹e, musel bych NFSS zcela odmítnout a fontový modul
\LaTeX{}u si napsat po svém. Tím bych ale popøel \LaTeX{} jako
takový, tak¾e jsem zùstal u~respektování principù NFSS. Vìci, které
se v~NFSS dají dìlat velmi tì¾ko, jsem radìji nedìlal. 

Z~tìchto dùvodù jsem se v~\LaTeX{}u nepou¹tìl ani do podpory
matematických fontù. Koncepce matematiky v~NFSS mi pøipadá jako
plainistovi ponìkud nesrozumitelná. Navíc velké kolekce fontù, které byly
hlavní motivací OFS, jsou vìt¹inou textové. Pokud chce nìkdo
pou¾ít matematickou sadu fontù v~\LaTeX{}u, pou¾ije
"\usepackage{styl}" a ten styl je k~té matematické sadì vìt¹inou
dodáván. Nepova¾oval jsem tedy øe¹ení matematiky 
v~\LaTeX{}u za prioritní. Na druhou stranu matematické rodiny v~plainu
se pomocí OFS doplòují a zavádìjí ve v¹ech velikostech velmi
elegantnì. Vìøím, ¾e alespoò nìjakému plainistovi (kromì mì) se toto
øe¹ení bude hodit.

Makro OFS jsem zveøejnil na \cite{ofsftp} pod \TeX-like licencí, 
tj. je volnì k~mání, ale zmìny pod stejným názvem nesmí dále ¹íøit nikdo
jiný, ne¾ autor. Do \TeX{}ových distribucí jsem makro zatím 
neprosadil, proto¾e bohu¾el chybí anglická dokumentace. Domnívám se,
¾e kdyby anglická dokumentace byla, nebyl by se zaøazením do \TeX{}ových
distribucí problém a makro by mohlo vyu¾ít daleko více lidí. Bohu¾el,
nejsem v~angliètinì natolik zdatný, abych tento problém rychle pøekonal.
Pro leto¹ní letní prázdniny jsem sice plánoval, ¾e se pokusím anglickou
dokumentaci napsat, jen¾e pøi¹la voda\dots

K~OFS existuje samozøejmì èeská dokumentace~\cite{ofsdoc} podrobì
popisující chování makra. Navíc jsem se o~OFS zmínil u¾ v~èlánku 
o~\TeX{}ové podpoøe ©tormových fontù~\cite{stormcl}. Dovolil jsem si
zde pøesto znovu k~tomuto tématu vrátit. Nechci  být nyní
tak technicky exaktní, jako v~manuálu~\cite{ofsdoc}, ale zase mám zde
více místa k~rozepsání mo¾ností makra, ne¾ jsem mìl ve
èlánku~\cite{stormcl}, který byl pøedev¹ím o~©tormových fontech.


\kap Základy u¾ivatelského rozhraní
%----------------------------------

U¾ivatelské rozhraní je shodné v~\LaTeX{}ové verzi OFS i 
v~plainové s~výjimkou snad zavedení makra OFS, které v~plainu
provedeme jednodu¹e pomocí "\input ofs [kolekce, fontù]", zatímco 
v~záhlaví \LaTeX{}ového dokumentu pí¹eme
"\usepackage [kolekce, fontù] {ofs}".

Abych v~tomto textu nemusel ka¾dou chvíli vìtvit svùj výklad na situaci
vhodnou pro plain a pro \LaTeX{}, rozhodl jsem se zde pøedpokládat, ¾e
pracujeme pouze s~plainem (napøíklad s~\csplain{}em).
\LaTeX{}ový u¾ivatel si bude muset dohledat specifika verze OFS pro
svùj formát v~dokumentaci~\cite{ofsdoc}. 

\bigskip

Pøíkazem "\fontusage" dostaneme na terminál a do logu základní
informace o~u¾ivatelských pøíkazech:

\begtt
$ tex ofs \\fontusage
This is TeX, Version 3.14159 (Web2C 7.3beta5)
(/usr/local/share/texmf/tex/csplain/ofs.tex
OFS (Olsak's Font System) based on plain initialized. <Oct. 2002>
(/usr/local/share/texmf/tex/csplain/ofsdef.tex))
\fontusage: ============== Olsak's Font System, usage: =================
\input ofs [sjannon, sdynamo, a35] ... for example
\showfonts  ... shows all loaded font families (by previous \input)
\setfonts [Family/] ... local switch to the new family, after this, the
  \rm, \bf, \it, bi will switch to the variants. The current size is used.
\setfonts [/size] ... local switch to the new size of fonts, the family is
  not changed. The "size" has the following possible formats:
    at<dimen>       ... the same as \font\something=file at<dimen>
    <dimen>         ... the same as at<dimen>
    <number>        ... the same as at<number>pt
    scaled<number>  ... the same as \font\something=file scaled<number>
    mag<decimal-number> fonts will be magnified by given coefficient
                        depend on current size of the fonts.
\setfonts [Family/size] ... switch to the new family at given size
\setfonts [Family-vr/]  ... switch to the specified font, the current size
  is used. The "vr" is acronym for variant (bf for example).
\setfonts [Family-vr/size] ... switch to the specified font.
\fontdef\name [Family/size] ... same as \gdef\name{\setfonts[Family/size]}
  The "Family" or "size" parameter may be empty.
\fontdef\name [Family-vr/size] ... \name is fixed-font switch iff:
  "size" is no empty and no mag<dec-number>.
  Fixed-font switch "\name" is implemented as \global\font\name=file.
\setmath [size/size/size] ... set math it/rm as current it/rm + use PS Symbol
\nofontmessages, \logfontmessages, \displayfontmessages, \detailfontmessages
  ... the levels of log.
*
\endtt

Vidíme, ¾e pøíkaz "\showfonts" nám uká¾e kolekce fontù. Pokud jsme
nepou¾ili \uv{previous "\input"}, dopadne základní kolekce
(implementovaná pøímo uvnitø OFS) takto:

\begtt
*\showfonts
OFS (l.0): The list of known font families:
defaults:
   [CMRoman/]            \rm, \bf, \it, \bi, \sl
   [CMSans/]             \rm, \bf, \it,  - 
   [CMTypewriter/]       \rm,  - , \it,  - , \sl
   [Times/]              \rm, \bf, \it, \bi
   [Helvetica/]          \rm, \bf, \it, \bi, \nrm, \nbf, \nit, \nbi
   [Courier/]            \rm, \bf, \it, \bi
\endtt

Názvy fontových rodin jsou zde uvedeny v~hranatých závorkách a vedle jsou
uvedeny pøepínaèe variant, které pro danou rodinu je mo¾né pou¾ít.

Vidíme, ¾e nejbì¾nìj¹í textové fonty Computer Modern jsou zaneseny 
v~OFS do tøí rodin "CMRoman", "CMSans" a "CMTypewriter". Myslím, ¾e
netøeba dodávat, co to znamená. V~rodinách "CMSans" a "CMTypewriter"
není k~dispozici jinak obvyklá varianta "BoldItalic", pro kterou je
vyhrazen pøepínaè "\bi". V~rodinì "CMTypewriter" nenajdeme ani
pøepínaè "\bf" pro tuènou variantu, ale zato mù¾eme pou¾ít
\uv{nadstandardní} variantu "\sl" (slanted), která je k~dispozici i
v~rodinì "CMRoman".

%OFS také pøímo pracuje s~rodinami "Times", "Helvetica" a
%"Courier". 
%Rodina "Helvetica" má kromì bì¾ných variant je¹tì varianty
%zú¾ené, napøíklad "\nbf" znamená "NarrowBold". Pokud písmová rodina
%nemá skuteènou kurzívu, ale jen sklonìnou variantu, je pøesto tato
%varianta vymezena pøepínaèem "\it". 
%Vìt¹ina písmových rodin toti¾
%dodr¾uje \uv{logiku ètyø variant}, pro které jsou v~OFS vyhrazeny
%právì pøepínaèe "\rm", "\bf", "\it", "\bi".

Deklarace dal¹ích písmových rodin jsou zaná¹eny do deklaraèních 
souborù s~pøíponou "tex"%
\footnote{V \LaTeX{}ovém OFS se jedná o~pøíponu {\tt sty}.}.
V~ka¾dém distribuci \TeX{}u 
doporuèuji udr¾ovat soubor volající v¹echny deklaraèní soubory 
"allfonts.tex". Napøíklad na mém poèítaèi vypadá tento soubor takto:

\begtt
$ cat `kpsewhich allfonts.tex`
%%% All OFS families declared on this TeX
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%                            Petr Olsak
\input a35       % PostScript 35
\input ffonts    % Another free fonts
\input btfonts   % Bitstream fonts
\input skatalog  % Stromtype foundry, 89 families
\endtt
%
Kdy¾ tedy napí¹u "$ tex allfonts \\showfonts \\end | less"~, dostanu
na svém poèítaèi výpis zhruba tøí set písmových rodin, ka¾dá obvykle
ve ètyøech variantách. Dùle¾ité je, ¾e se v tom vyznám a nemusím
vzpomínat, jak se která metrika jmenuje.  Následuje jen èást výpisu.

\begtt
OFS (l.0): The list of known font families:
defaults:
   [CMRoman/]            \rm, \bf, \it, \bi, \sl
   [CMSans/]             \rm, \bf, \it,  - 
   [CMTypewriter/]       \rm,  - , \it,  - , \sl
   [Times/]              \rm, \bf, \it, \bi
   [Helvetica/]          \rm, \bf, \it, \bi, \nrm, \nbf, \nit, \nbi
   [Courier/]            \rm, \bf, \it, \bi
a35.tex:
   [AvantGarde/]         \rm, \bf, \it, \bi
   [Bookman/]            \rm, \bf, \it, \bi
   [NewCentury/]         \rm, \bf, \it, \bi
   [Palatino/]           \rm, \bf, \it, \bi
   [ZapfChancery/]       \rm,  - , \it,  - 
   [ZapfDingbats/]       \rm,  - ,  - ,  - 
   [Symbol/]             \rm,  - , \it,  - 
ffonts.tex:
   [Charter/]            \rm, \bf, \it, \bi
...
sjannon.tex:
   [JannonAntikva/]      \rm, \bf, \it, \bi, \mr, \mi
   [JannonText/]         \rm, \bf, \it, \bi, \mr, \mi
   [JannonCaps/]         \rm, \bf, \it, \bi
...
sdynamo.tex:
...
   [DynaGroteskLE/]      \rm, \bf, \it, \bi
   [DynaGroteskD/]       \rm, \bf, \it, \bi
   [DynaGroteskR/]       \rm, \bf, \it, \bi
...
stitul.tex:
   [Alcoholica/]         \rm, \bf, \it,  - 
   [Monarchia/]          \rm, \bf,  - ,  - 
   [MonarchiaText/]      \rm, \bf,  - ,  - 
   [Clichee/]            \rm, \bf, \it, \bi
   [Regula/]             \rm,  - , \it,  - 
   [Splendid/]           \rm, \bf, \it,  - , \script, \sans
   [Cobra/]              \rm, \bf,  - ,  - 
   [ExcelScript/]        \rm,  - ,  - ,  - , \ext
   [ExcelScriptText/]    \rm,  - ,  - ,  - , \ext
   [Zeppelin/]           \rm, \bf,  - ,  - , \lr, \coll
   [Negro/]              \rm,  - ,  - ,  - 
   [Farao/]              \rm, \bf,  - ,  - , \kr, \coll
...
slido.tex:
   [Lido/]               \rm, \bf, \it, \bi, \crm, \cbf
\endtt

Ve výpisu je uveden i \TeX{}ový soubor, kde se deklarace odpovídajících
rodin skuteènì nachází. Vidíme tedy, ¾e "a35.tex" u¾ obsahuje
deklarace rodin, ale napøíklad soubor "skatalog.tex" zøejmì obsahuje jen dal¹í
"\input sjannon", "\input sdynamo", "\input stitul" atd.
Kdy¾ si pro svùj dokument vyberu tøeba rodiny "JannonText", 
"DynaGroteskR" a "Farao", pak místo toho, abych psal

\begtt
\input ofs [allfonts]
\endtt
%
si vystaèím~s
\begtt
\input ofs [sjannon, sdynamo, stitul]
\endtt
%
co¾ zpùsobí naèítání podstatnì ménì souborù s~deklaracemi fontových rodin.

Pokud potøebuji vìdìt, jak ty fonty vypadají, napí¹u napøíklad:

\begtt
$ pdfcsplain ofscatal [sjannon, sdynamo, stitul] ; acroread ofscatal.pdf
\endtt
%
Soubor "ofscatal.tex", který vytvoøí katalog, byl zaøazen do balíku 
OFS od verze~"Oct 2002".

\kap Pøepínaè rodin a velikostí

Hlavním pøíkazem OFS na u¾ivatelské úrovni je "\setfonts". Jedná se
pøedev¹ím o~pøepínaè rodin, viz výpis "\fontusage" v~pøedchozí sekci.
Pøepínaè má dva parametry v~hranaté závorce oddìlené lomítkem. Prvním
parametrem je název rodiny a druhým po¾adovaná velikost fontù. Pokud
nìkterý parametr chybí, pøepínaè nebude jeho nastavení mìnit. Pøepínaè
samozøejmì funguje lokálnì ve skupinách, jako bývá u~fontových
pøepínaèù obvyklé. Po pøepnutí rodiny pracují pøepínaèe variant
(obvykle "\rm", "\bf", "\it", "\bi") pro novou rodinu. Varianta se po
pøepnutí rodiny inicializuje stejná, jako byla pøed pøepnutím,
tj. jsme-li zrovna v~kurzívì rodiny Times a pøepneme do Helveticy,
zùstáváme ve variantì "\it" rodiny Helvetica, tj. sklonìné
písmo. Pokud ale pøi pøepnutí rodiny aktuální varianta v~nové rodinì
neexistuje, inicializuje se varianta "\rm", kterou musí obsahovat
ka¾dá rodina.

Pøíklady

\begtt
\setfonts [JannonText/10.5]  % nastavím na zaèátku dokumentu
\setfonts [/14]\bf           % napøíklad pro nadpisy
\setfonts [/8]\rm            % pro poznámky pod èarou
\setfonts [DynagroteskR/]\it % tøeba pro citáty
\setfonts [CMTypewriter/]    %  pro strojopis.
       % tento pøepínaè napø. v kurzívì nastaví automaticky
       % variantu kurzíva-strojopis.
\endtt

Výhodou tedy je, ¾e si nemusím pamatovat názvy matrik (v~\LaTeX{}u pak
nesrozumitelné zkratky rodin pou¾ívané v~NFSS), ale pí¹u název rodiny
do dokumentu stejným zpùsobem, jak jej vidím v~písmovém katalogu.
Pokud udìlám v~názvu rodiny pøeklep (tøeba nedodr¾ím velká a malá
písmena), pøíkaz "\setfonts" spustí "\showfonts", tj. na obrazovce 
a v~logu vidím seznam v¹ech rodin, které mohu pou¾ít.

Velikost fontù mohu nastavit pøímo udáním v~jednotce "pt", nebo
pøipsáním jiné jednotky (napø. "mm"), nebo jako u~primitivu "\font"
pomocí slova "scaled" (koeficient zvìt¹ení se vá¾e k~základní
velikosti fontu) a koneènì i pomocí zcela nového prefixu "mag", který
udává zvìt¹ení vzhledem ke zrovna pou¾ité velikosti fontù, napøíklad:

\begtt
\def\maly{\setfonts [/mag0.8]}
stanu se {\maly men¹ím a {\maly men¹ím a {\maly je¹tì men¹ím}}} 
a u¾ jsem se z toho dostal.
\endtt
% 
dopadne takto:

\medskip
\def\maly{\setfonts[/mag0.8]}
stanu se {\maly men¹ím a {\maly men¹ím a {\maly je¹tì men¹ím}}} a
u¾ jsem se z~toho dostal.
\medskip

Prefix "mag" pro velikost vyu¾ijeme napøíklad v~logu \LaTeX{}, které
jsem si v~plainu definoval jako

\begtt
\def\LaTeX{L\kern-.2em\raise.45ex\hbox{\setfonts[/mag.7] A}\kern-.05em\TeX}
\endtt
%
a funguje to v~nadpisech (je tam tuèné vyvý¹ené A~odpovídající
velikosti) i v~poznámkách pod èarou. V~\LaTeX{}u samotném mají toto
logo definováno tak, ¾e se pro vyvý¹ené A~pou¾ije font v~indexové
velikosti. No jo, zde jim to náhodou prochází, ale co kdyby se
(napøíklad v~jiném v~logu) hodilo pro nìkteré písmeno pou¾ít 
velikost "mag.8", která není jako indexová velikost pou¾ita?
Bez OFS bychom to pak dìlali dost obtí¾nì, proto¾e NFSS nám øe¹ení
nenabízí. 

Dal¹ím vyu¾itím prefixu "mag" je mo¾nost korigovat nestejné støední
vý¹ky písma. Napøíklad v~tomto sborníku je pro strojopis pou¾it
"CMTypewriter". Pokud si v¹imnete v~jiných pøíspìvcích, ne¾ tento,
vidíte, ¾e uvnitø odstavcù ten strojopis s~fontem Charter moc nesedí, proto¾e
strojopis má men¹í støední vý¹ku písma. Staèí ale pro pøepínaè "\tt"
pou¾ít "\setfonts [CMTypewriter/mag1.1]", a støední vý¹ka je 
v~lati. To vidíme napøíklad v~tomto pøíspìvku.
A~funguje to vèetnì zmen¹ených variant, které jsou 
v~pøíspìvcích pro \SLT{} pou¾ity v~abstaktu, poznámce pod èarou, 
nebo tøeba v~údaji \uv{Email}, uvedeném v~záhlaví pøíspìvku.

Pøíkaz "\setfonts" mù¾e obsahovat i specifikaci varianty (viz výpis
pøíkazu "\fontusage"). Pak se u¾ nejedná o~pøepínaè rodiny, ale fontu
samotného. V~takovém pøípadì pøepínaè "\setfonts" neovlivní pøepínaèe
variant "\rm", "\bf" a dal¹ích, ale nastaví jen po¾adovaný jediný
font. Napøíklad pro nadpisy by ¹lo psát "\setfonts[-bf/14]" místo
"\setfonts[/14]\bf", ale museli bychom mít jistotu, ¾e v~nadpisu
nepou¾ijeme pøepínaè varianty, proto¾e ten by vrátil font do velikosti
aktuální rodiny. Tou velikostí je tøeba 10pt.

Abychom v~nadpisu mohli pou¾ít pøepínaè "\it", a pøitom se dostali do
varianty "\bi" (co¾ je ¾ádoucí), je potøeba pøepínaè fontu v~makru
pro nadpis naprogramovat zhruba takto:

\begtt
\def\nadpis #1{{\setfonts[/14]\bf \let\it=\bi #1}}
\endtt
%
Kvùli tomuto jednoduchému obratu, který zvládne snad ka¾dý plainista,
jsem se rozhodl nekomplikovat jádro OFS podobným zpùsobem jako NFSS a
nezavádìt tedy dal¹í \uv{nezávislou souøadnici} popisující duktus fontu.
Pro speciální rodiny fontù (jako je tøeba rodina
"DynaGrotesk") jsem ale snadno pomocí doplòujících maker vytvoøil
pøepínaè, který respektuje je¹tì o~jednu \uv{nezávislou souøadnici}
více, ne¾ zvládá NFSS. V~tomto pøípadì to nebyl jen duktus, ale 
i stupeò zú¾ení písma. Navíc tento pøepínaè doká¾e \uv{poskakovat} po
jednotkách vpøed a vzad podél zvolené souøadnice. To také NFSS
nezvládá.

Èasto se hodí vytváøet zkratky pro pøepínaèe rodin. K~tomu slou¾í
makro "\fontdef\pøepínaè[Rodina/velikost]", které funguje podobnì,
jako pou¾ití konstrukce "\gdef\pøepínaè{\setfonts[Rodina/velikost]}".
V~záhlaví tohoto dokumentu mám napøíklad uvedeno:

\begtt
\input ofs [ffonts]                 % Charter je ve skupinì free fonts
\setfonts [Charter/10pt]            % výchozí rodina
\fontdef\tt [CMTypewriter/mag1.1]   % strojopis, korekce støední vý¹ky
\fontdef\verbtt [CMTypewriter/8]    % strojopis pro display ukázky
\fontdef\small [Charter/9]          % zmen¹ení pro abstrakt a záhlaví
\endtt

Mo¾ná ètenáøe napadne, ¾e jsem nemusel psát podruhé slovo "Charter" 
v~deklaraci pøepínaèe "\small". Pøi kompletní zmìnì základní rodiny
dokumentu na jinou bych pak mohl zmìnit slovo "Charter" jen na 
jediném místì  (u~pøíkazu "\setfonts") a byl bych hotov. 
Bohu¾el, vynechání rodiny v~pøíkazu "\small" vede 
k~problémùm, proto¾e tento pøíkaz je pou¾it v~záhlaví dokumentu, 
tj. ~v~"\output" rutinì. Pokud zde neuvedeme explicitnì rodinu, dìdí se
rodina aktuálnì pou¾itá, která ov¹em mù¾e být jakákoli, proto¾e
"\output" rutina je vyvolávaná z~rùzných míst pøi zpracování
dokumentu. Mít záhlaví jednou strojopisem a podruhé Charterem podle
toho, odkud byla "\output" rutina zavolána, je samozøejmì ne¾ádoucí.

Tento problém se dá øe¹it \uv{vykøièníkovou} konvencí, kterou umí
zpracovat pøíkaz "\fontdef":

\begtt
\fontdef\small [!/9] \addcmd\small {\rm} % pro abstrakt a záhlaví
\endtt
%
Vykøièník je nahrazen aktuální rodinou u¾ v~dobì èinnosti pøíkazu
"\fontdef", nikoli tedy a¾ v~dobì provádìní pøepínaèe.  V~"\output"
rutinì se musíme je¹tì postarat o~potlaèení dìdiènosti aktuální
varianty. Proto jsem pou¾il je¹tì pøíkaz "\addcmd" (zaveden novì od
verze OFS "Oct 2002"), který k~existujícímu makru pøidá dal¹í pøíkazy
na jeho konec. Celá deklarace fontù v~tomto dokumentu tedy vypadá
zhruba takto:

\begtt
\input ofs [ffonts]                   % Charter je ve skupinì free fonts
\setfonts [Charter/10pt]              % výchozí rodina
\fontdef\tt [CMTypewriter/mag1.1]     % strojopis, korekce støední vý¹ky
\fontdef\verbtt [CMTypewriter-rm/8]   % strojopis pro display ukázky
\fontdef\small [!/9] 
\addcmd \small {\baselineskip11pt\rm} % zmen¹ení pro abstrakt a záhlaví
\fontdef\fontsekce [!/12]            
\addcmd \fontsekce {\bf \let\it=\bi}  % pro nadpisy sekcí
\fontdef\fonttitul [!-bf/14.4]        % v titulu nebudeme pøepínat varianty
\endtt

Povedlo se tedy ve¹keré aktivity související s~výbìrem fontù
soustøedit na jedno místo dokumentu bez nutnosti pou¾ívat názvy
metrik. 


\kap Kódování fontù
%------------------

OFS pro plain implicitnì pracuje v~kódování \CSfont{}ù, ale mù¾ete
jej pøepnout do jiného kódování. 
\footnote{OFS pro \LaTeX{} pøenechává starost o~kódování zcela na~NFSS.}

Základem informace o~kódování v~OFS pro plain je makro "\fotenc",
které má implicitnì hodnotu "8z". To znamená, ¾e rodiny "CMRoman",
"CMTypewriter" a "CMSans" budou pracovat s~\CSfont{}y.
Kdyby u¾ivatel nastavil "\def\fotenc{8t}", zaèalo by OFS pracovat 
v~pøípadì tìchto rodin s~DC nebo EC fonty. Jaké je technické pozadí
vysvìtlíme v~následující sekci.

Vìt¹ina metrik \ps{}ových fontù má varianty "*8t" (pro
kódování podle Corku) a "*8z" (pro kódování podle \CSfont{}ù).
Makro "\fotenc" tedy musí obsahovat koncovku metrik, které chceme
pou¾ít. Tím volíme kódování. Pøíklad:

\begtt
\input ofs
\setfonts [Times/]  text 1 % metrika: ptmr8z, tj. kódování CSfontù
\def\fotenc{8t}
\setfonts [/]       text 2 % metrika: ptmr8t  tj. kódování podle Corku
\endtt
%
Máte-li své fonty v~nìjakém dal¹ím kódování a koncovky metrik máte
s~názvy tøeba "*8x", pak není problém napsat "\def\fotenc{8x}"
a mù¾ete zaèít pou¾ívat své vlastní metriky.

Pokud pou¾íváte kódování podle Corku, doporuèuji definovat makro
"\fotenc" jako "8t" pøed zavedením makra OFS. Pøi pou¾ití slo¾itìji
deklarovaných rodin se to hodí.

V~balíku OFS jsou soubory "ofs-8z.tex" a "ofs-8t.tex", ve kterých je
deklarace akcentù a nìkterých na kódování závislých maker, jako
napøíklad "\promile". Implicitnì není naèten ani jeden z~tìchto
souborù, tj.~jsou respektována makra pro akcenty z~originálního 
plainu, která expandují na "\accent" podle kódování CMfontù.

Pokud je toto chování nevyhovující, mù¾ete naèíst pomocí "\input"
jeden nebo oba dva vý¹e zmínìné soubory (v~libovolném poøadí -- jejich
definice se nehádají). Pokud naètete oba soubory, pak makra pro
akcenty expandují na znaky podle kódování, které je aktuálnì nastaveno
v~makru "\fotenc" ("8z" nebo "8t").

Podívejme se do souborù "ofs-8z.tex" a "ofs-8t.tex" (výraznì kráceno):

\begtt
%%% Default accents in CM
\accentdef  \` *    8z  {\accent 18 }                   % grave
\accentdef  \' *    8z  {\accent 19 }                   % acute
\accentdef  \v *    8z  {\accent 20 }                   % caron
\accentdef  \u *    8z  {\accent 21 }                   % breve
...
%%% Standard characters in plain (redefined here)
\def\aa{\r a} 
\def\AA{\r A}
\characterdef \i    8z  16 
\characterdef \j    8z  17
\characterdef \SS   8z  {SS}
\characterdef \AE   8z  29
...
%%% Extra characters from CS-fonts
\characterdef \promile      8z  141
\characterdef \varhyphen    8z  156
\characterdef \flqq         8z  158
\characterdef \frqq         8z  159
\characterdef \clqq         8z  254
\characterdef \crqq         8z  255
...
%%% Accented letters from CS fonts
\accentdef  \` A      8z  152
\accentdef  \' A      8z  193
\accentdef  \" A      8z  196
\accentdef  \` a      8z  184
\accentdef  \' a      8z  225
...
%%% Default accents in Cork
\accentdef  \` *    8t  {\accent 0 }               
\accentdef  \' *    8t  {\accent 1 }
\accentdef  \^ *    8t  {\accent 2 }
\accentdef  \~ *    8t  {\accent 3 }
\accentdef  \" *    8t  {\accent 4 }
...
%%% Standard characters in plain (redefined here)
\def\aa{\r a} 
\def\AA{\r A}
\characterdef \i    8t  25
\characterdef \j    8t  26
\characterdef \SS   8t  223
\characterdef \AE   8t  198
...
\characterdef \promile              8t {\%\char 24 }        
\characterdef \textpertenthousand   8t {\%\char 24\char 24 } 
...
%%% Accented letters from Cork encoding
\accentdef  \. i    8t `\i
\accentdef  \u A    8t 128
\accentdef  \k A    8t 129
\accentdef  \' C    8t 130
\accentdef  \v C    8t 131
...
\endtt

Myslím, ¾e syntaxe a význam pøíkazù "\characterdef" a "\accentdef" je
v~této ukázce samovysvìtlující. Pokud ne, odkazuji ètenáøe do
dokumentace~\cite{ofsdoc}, která do posledního detailu (vèetnì popisu 
jednotlivých fází expanze) vysvìtluje èinnost tìchto pøíkazù.

\LaTeX{}ovému u¾ivateli to mù¾e pøipomínat pøíkazy
"\DeclareTextSymbol" a "\DeclareTextComposite" a jim podobné, které
dìlají zhruba toté¾ (jen ponìkud komplikovanìji, nepøehlednìji a
tì¾kopádnìji).

OFS také poèítá s~mo¾ností, ¾e nìkteré znaky jsou pøidány do extra
fontu, který s~pùvodním fontem vytváøí uspoøádanou dvojici. Takové
dvojice metrik jsou pou¾ity napøíklad pro fonty ©tormovy písmolijny,
proto¾e obsahují více ne¾ 256 znakù. Pøitom by bylo ¹koda nìkteré
znaky nevyu¾ít. Ke ka¾dé metrice tìchto fontù ("*8z" i "*8t") je
pøiøazena extra metrika "*6s", obsahující zbylé znaky.
Pomocí "\characterdef" a "\accentdef" mù¾eme deklarovat pøítomnost
tìchto znakù v~kódování "6s" (viz soubor "stormenc.tex"). Pokud 
aktuální metrika má k~sobì extra font v~kódování "6s" a je po¾adován 
znak z~tohoto fontu, OFS jej automaticky \uv{vyloví} pomocí 
pøechodného pøepnutí na extra metriku.


\kap Deklarace rodin
%-------------------

Podívejme se nyní do souboru "a35.tex", který deklaruje rodiny pro
základních 35 \ps{}ových fontù (kráceno):

\begtt
%%% Times, Helvetica, Courier is in OFS defaults

\ofsdeclarefamily [AvantGarde] {% -------------------- AvantGarde
   \loadtextfam (Book)         pagk\fotenc;%
                (Demi)         pagd\fotenc;%
                (BookOblique)  pagko\fotenc;%
                (DemiOblique)  pagdo\fotenc;;%
   \def\TeX{T\kern-.08em\lower.3333ex\hbox{E}\kern-0.09emX}%
}
\ofsdeclarefamily [NewCentury] {% -------------------- NewCenturySchlbk
   \loadtextfam (Roman)        pncr\fotenc;%
                               pncb\fotenc;%
                               pncri\fotenc;%
                               pncbi\fotenc;;%
   \def\TeX{T\kern-.1667em\lower.5ex\hbox{E}\kern-.125emX}%
}
...
\endtt

Zde je tedy deklarováno zobrazení mezi názvy rodin a metrikami.%
\footnote{
   V~OFS pro \LaTeX{} takové soubory neexistují; tam se pouze
   deklaruje zobrazení mezi (dlouhými) názvy rodin v~OFS a zkratkami
   rodin v~NFSS.  
} 
Ka¾dá rodina má ètyøi povinné metriky (pro bì¾né ètyøi
varianty). Metriky jsou zapsány pomocí "\fotenc", aby fungovalo
pøepínání kódování. Mezi pøedposledním a posledním støedníkem mù¾e být
uvedeno extra kódování, pokud je font rozlo¾en do dvou metrik (v~tomto
pøíkladì není). Pøíkazy uvedené v~parametru "\ofsdeclarefamily" se
provedou pøi ka¾dém pøepnutí rodiny pøíkazem "\setfonts".
V~ukázce tam máme alternativní definice loga "\TeX", aby toto logo pìknì
vypadalo v~ka¾dém fontu.

Od verze OFS "Oct 2002" je pøidána mo¾nost pou¾ít nepovinné parametry
v~argumentech pøíkazu "\loadtextfam". Tyto parametry pí¹eme do kulaté
závorky a znaèí název varianty, pokud je odli¹ný od bì¾ného názvu.
Tato informace se pou¾ije v logu a pøi tisku katalogu.

Podívejme se je¹tì do souboru "sjannon.tex" z~podpory ©tormových fontù
(výpis je zde neúplný):

\begtt
\ofsdeclarefamily [JannonAntikva] {% -------- Jannon Antikva
   \loadtextfam sjnr\fotenc;%
                sjnb\fotenc;%
                sjnri\fotenc;%
                sjnbi\fotenc;6s;%
   \newvariant2 \mr (Medium)        sjnm\fotenc;6s;%
   \newvariant3 \mi (MediumItalic)  sjnmi\fotenc;6s;%
}
\ofsdeclarefamily [JannonText] {% ------------ Jannon Text
   \loadtextfam sjnrg\fotenc;%
                sjnbg\fotenc;%
                sjnrig\fotenc;%
                sjnbig\fotenc;6s;%
   \newvariant2 \mr (Medium)        sjnmg\fotenc;6s;%
   \newvariant3 \mi (MediumItalic)  sjnmig\fotenc;6s;%
}
...
\endtt
%
Vidíme, ¾e navíc je zde deklarována extra metrika v~kódování~"6s" a ¾e
se zde deklarují doplòující pøepínaèe variant "\mr" a "\mi" mimo
základní ètyøi varianty. Podrobnìj¹í vysvìtlení pou¾itých pøíkazù
ètenáø opìt najde v~dokumentaci~\cite{ofsdoc}.

Jak jsou pomocí expanze "\fotenc" mapovány metriky \CSfont{}ù
resp. DC~fontù, které v~názvech koncovku "8z" ani "8t" nemají?
To souvisí rovnì¾ s~tím, ¾e tyto fonty mají pro rùzné velikosti rùzné
metriky. V~deklaraèních souborech je pak tento problém vyøe¹en
zpùsobem \uv{dvì mouchy jednou ranou} (viz soubor "ofsdef.tex"):

\begtt
\registertfm cmr8z     -      csr10  % metrika pro v¹echny velikosti
\registertfm cmr8z  0pt-6pt   csr5
\registertfm cmr8z  6pt-7pt   csr6
\registertfm cmr8z  7pt-8pt   csr7
\registertfm cmr8z  8pt-9pt   csr8
\registertfm cmr8z  9pt-10pt  csr9
\registertfm cmr8z  10pt-12pt csr10
\registertfm cmr8z  12pt-17pt csr12
\registertfm cmr8z  17pt-*    csr17
...
\registertfm cmr8t     -   dcr10     % metrika pro v¹echny velikosti
...
\ofsdeclarefamily [CMRoman] {% ------------ Computer Modern Roman
   \loadtextfam cmr\fotenc;%
                cmbx\fotenc;%
                cmti\fotenc;%
                cmbxti\fotenc;;%
   \newvariant8 \sl (Slanted) cmsl\fotenc;;%
}
\endtt
%
Centrálním pøíkazem je zde makro "\registertfm", které mapuje
neexistující metriky formálnì vytvoøené pomocí expanze "\fotenc" do
skuteèných metrik. Toto makro také umí registrovat rùzné metriky
pro rùzné velikosti. Pokud tedy budeme chtít font daný pomocí
"\setfonts[CMRoman-rm/12.5]", vyvolá se pøi "\fotenc"
s~hodnotou "8z" metrika "csr12 at12.5pt". \uv{Metrika pro v¹echny
velikosti} se pou¾ije v~pøípadì, ¾e je velikost fontu deklarovaná
s~\hbox{prefixem} "scaled", tak¾e "\setfonts[CMRoman-rm/scaled1250]" vyvolá
metriku "csr10 scaled1250". Ztrácíte-li pøehled o~tom, jaká metrika se
ve skuteènosti pou¾ila, mù¾ete zapnout logovací pøepínaè
"\detailfontmessages". 

Podíváte-li se do souboru "ofsdef.tex" podrobnìji, mù¾ete si v¹imnout, ¾e
jsem metriky rodiny "CMRoman" a dal¹ích "CM"~rodin pro kódování~"8t" ponìkud
odbyl. Registroval jsem je jako metriky DC fontù bez støídání metrik pro
rùzné velikosti. Nechtìlo se mi to toti¾ vypisovat a nevìdìl jsem, zda
u¾ivatel tohoto kódování radìji nepou¾ije EC fonty místo DC fontù.
Ve zmínìném souboru jsou pøíklady, jak by se ta deklarace mìla
provést. Pokud ji nìkdo dopí¹e (napøíklad pro DC i EC fonty do zvlá¹tních
souborù), rád ji do balíku OFS zaøadím. Osobnì ale fonty kódované 
v~"8t" nepou¾ívám, tak¾e mì zatím nic nemotivuje to udìlat.


\kap Matematické fonty
%---------------------

Ka¾dý plainista ví, ¾e fonty pro matematiku se sdru¾ují do matematických
rodin obsahující font pro základní, indexovou a index-indexovou
velikost. Rovnì¾ ví, ¾e první ètyøi matematické rodiny (s~èíslem 0 a¾~3)
jsou s~\TeX{}em jistým zpùsobem pevnì významovì svázány a dal¹í rodiny
se dají deklarovat.

Aby plainista pøi deklarování matematických rodin nemusel psát tøikrát
za sebou "\font" a potom je¹tì 
"\textfont\rodina=...", "\scriptfont...", atd, je v~OFS k~tomu
vytvoøena zkratka "\loadmathfam", jak uká¾u za chvíli.

Inicializaci matematických fontù v~OFS pro plain provedeme pomocí
pøíkazu "\setmath". Dokud tento pøíkaz nepou¾ijeme, jsou matematické
fonty ve stavu, jak je inicializoval plain. Ve tøech parametrech
pøíkazu "\setmath" (oddìlených lomítky) dáváme najevo, jakou chceme
základní velikost, jakou pro indexy a jakou pro indexy
indexù. Jsou-li tyto parametry prázdné, je pou¾ito relativní zmen¹ení
podle aktuální velikosti textového fontu pomocí prefixu "mag" takto:

\begtt
\setmath [//] je toté¾ jako \setmath [mag1.0/mag.7/mag.5]
\endtt

Pøíkaz "\setmath" vypoèítá po¾adované velikosti a startuje makro pro
zavedení fontù "\mathfonts". Dále tento pøíkaz startuje makro pro
inicializaci matematického kódování "\mathchars". Tato makra si mù¾e
plainista definovat jak chce, nicménì vìt¹inou vyu¾ije ji¾
pøipravených maker "\defaultmathfonts" a "\defaultmathchars", která
jsou udìlána tak, ¾e spou¹tìjí rùzné varianty kódu podle hodnoty maker
"\fomenc" a "\mathversion".

Pøi "\def\fomenc{PS}" (imlicitní hodnota: PostScriptové fonty) se zavedou
fonty tak, ¾e matematická kurzíva se ztoto¾ní s~aktuální textovou
kurzívou a podobnì rodina~0 pro èíslice a textové symboly zùstává
nastavena podle aktuální textové rodiny varianty "\rm". 
Matematické symboly se berou
(pokud to je mo¾né) z~bì¾nì dostupného \ps{}ového fontu
"Symbol". Zbytek (napø. natahovací závorky) pak zùstává v~Computer
Modern. Matematické kódování je pro tuto situaci výraznì
pozmìnìno obvyklými primitivy "\mathchardef" a podobnými, aby byly
dosa¾itelné v¹echny znaky plainu. Napøíklad pro øecká písmena musela být
zavedena nová rodina se sklonìným fontem "Symbol" a pøíkazy typu "\alpha" jsou
pøekódovány z~pùvodní matematické rodiny~1 na tuto novou rodinu.

Nastavíte-li "\def\fomenc{CM}", pak pøíkaz "\setmath" zavede
stejné matematické fonty z~rodiny Computer Modern, jako 
v~plainu. Pøíkaz "\setmath[//]" pak pouze aktualizuje velikosti tìchto fontù
podle velikosti aktuálního textového fontu.

Nakoupíte-li fonty MathTimes, dále naètete soubor "ofsmtdef.tex" (souèástí
OFS od verze "Jun. 2002") a definujete "\def\fomenc{MT}", pak pøíkaz
"\setmath" zavede kurzívu a rodinu~0 stejnì jako pøi
"\def\fomenc{PS}", ale navíc pou¾ije pro {\it v¹echny\/} symboly vèetnì
natahovacích závorek fonty MathTimes.

Kromì hodnoty "\fomenc" se pøíkaz "\setmath" vìtví i vzhledem 
k~hodnotì makra "\mathversion". Implicitnì OFS poèítá se dvìma
hodnotami tohoto mak\-ra: "\def\mathversion{normal}" nebo "bold".
Pøi verzi "bold" jsou naèteny do matematických rodin tuèné alternativy
fontù, pokud to jde. V¹e názornì vysvìtlí pohled do souboru
"ofsdef.tex":

\begtt
\def\defaultmathfonts{\csname load\fomenc\mathversion math\endcsname}
\def\defaultmathchars{\csname set\fomenc mathchars\endcsname}
\def\mathfonts{\defaultmathfonts}
\def\mathchars{\defaultmathchars 
   \let\mathchars=\relax % to protect the twice math-setting
}
\def\loadPSnormalmath{%
  \loadmathfam 0[tenrm/]%              Actual Roman font
  \loadmathfam 1[tenit/]%              Actual Italic font
  \loadmathfam 2[/cmsy]%               Standard symbols from CM
  \noindexsize\loadmathfam 3[tenex/]%  Standard extra symbols from CM
  \chardef\itfam=1 \chardef\bifam=5 
  \loadmathfam \bffam [tenbf/]%        Actual Bold font
  \loadmathfam \bifam [tenbi/]%        Actual Bold Italic  
  \newmathfam\symbfam
  \loadmathfam \symbfam [/psyr]%       PostScript Symbol
  \newmathfam\symbofam
  \loadmathfam \symbofam [/psyro]%     PostScript Symbol Oblique
}
\def\loadPSboldmath{%
  \loadmathfam 0[tenbf/]%              Actual Bold font
  \loadmathfam 1[tenbi/]%              Actual Bold-Italic font
...
}
\def\loadCMnormalmath{%
  \loadmathfam 0[/cmr8z]%                    Roman font
  \loadmathfam 1[/cmmi]%                     Math Italic font
  \loadmathfam 2[/cmsy]%                     Standard symbols from CM
  \noindexsize\loadmathfam 3[/cmex10]%       Standard extra symbols from CM
...
}
\def\loadCMboldmath{%
  \loadmathfam 0[/cmbx8z]%                     Roman font
  \loadmathfam 1[/cmmib10]%                    Math Italic font
...
}
\def\setPSmathchars{%
  \fontmessage{\ofsmessageheader Math codes are set for PS encoding}%
  \mathcode`\,="602C
  \mathcode`\.="002E
  \delcode`\<="\hex\symbfam E130A
  \delcode`\>="\hex\symbfam F130B
  \delcode`\|="\hex\symbfam 7C30C
  \edef\langle{\delimiter"4\hex\symbfam E130A }%
  \edef\rangle{\delimiter"5\hex\symbfam F130B }%
  \mathchardef\alpha    "0\hex\symbofam 61
  \mathchardef\beta     "0\hex\symbofam 62
  \mathchardef\gamma    "0\hex\symbofam 67
...
}
\endtt

Chceme-li pøidat nìjaké dal¹í matematické rodiny (v~terminologii NFSS
matematické abecedy), pak mù¾eme postupovat tøeba takto:

\begtt
\def\mathfonts{\defaultmathfonts
  \newmathfam\bbfam 
  \loadmathfam \bbfam [/bbold12]%  Dvojitá vertikální kresba
  \def\bb{\fam\bbfam}%
}
\def\mathchars{\defaultmathchars 
  \mathchardef\balpha    "0\hex\bbfam 0B
  \mathchardef\bbeta     "0\hex\bbfam 0C
  ...
} 
\endtt

Pøíklad z~konce sekce~3 nyní obohatíme o~mo¾nost práce 
s~matematikou v~libovolných velikostech:

\begtt
\input ofs [ffonts]                  % Charter je ve skupinì free fonts
\setfonts [Charter/10pt]             % výchozí rodina
\setmath[//]                         % inicializace matematiky
\fontdef\tt [CMTypewriter/mag1.1]    % strojopis, korekce støední vý¹ky
\fontdef\verbtt [CMTypewriter-rm/8]  % strojopis pro display ukázky
\fontdef\small [!/9]                 % zmen¹ení pro abstrakt a záhlaví
\addcmd \small {\baselineskip11pt \rm \def\mathversion{normal}\setmath[//]}
\fontdef\fontsekce [!/12]            % pro nadpisy sekcí
\addcmd \fontsekce {\bf \let\it=\bi \def\mathversion{bold}\setmath[//]} 
\fontdef\fonttitul [!-bf/14.4]       % titul
\endtt

Nyní i v~abstraktech, poznámkách pod èarou a záhlavích je matematika
ve v¹ech velikostech v¹ech mo¾ných indexù zmen¹ená odpovídajícím
zpùsobem. Pokud by se matematika mìla pou¾ít v~názvu sekce, pak bude
také tuèná a správnì veliká.


\reference

\bib \url{www.pismolijna.cz}, \url{www.cstug.cz/stormtype}.

\bib \url{ftp://math.feld.cvut.cz/pub/olsak/ofs}.

\bib Petr Ol¹ák. {\it OFS: Ol¹ákùv fontový systém}. 2001.
     Dokumentace k~balíku je v~souborech "ofsdoc.tex", "ofsdoc.pdf".

\bib Petr Ol¹ák. {\it Jak \TeX{} k~fontùm ze Støe¹ovic pøi¹el}. Zpravodaj
     Èeskoslovenského sdru¾ení u¾ivatelù \TeX{}u, 4/2001, pp~153--180.

\bye 

