%%  BibArts 2.2 assists you to write LaTeX texts in arts and humanities.
%%  Copyright (C) 2019  Timo Baumann  bibarts[at]gmx.de  (2019/03/03)
%%
%%  This program is free software; you can redistribute it and/or modify
%%  it under the terms of the GNU General Public License as published by
%%  the Free Software Foundation; either version 2 of the License, or
%%  (at your option) any later version.
%%
%%  This program is distributed in the hope that it will be useful,
%%  but WITHOUT ANY WARRANTY; without even the implied warranty of
%%  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
%%  GNU General Public License for more details.
%%
%%  You should have received a copy of the GNU General Public License
%%  along with this program; if not, write to the Free Software
%%  Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.



%%  FILES OF THE PACKAGE AND DOCUMENTATION
%%  CTAN mirrors > BibArts > bibarts.zip
%%    bibarts.sty   This file (a LaTeX style)
%%    ba-short.pdf  Short documentation (English)
%%    ba-short.tex  Source of ba-short.pdf
%%    bibarts.pdf   Full documentation (German)
%%    bibarts.tex   Source of bibarts.pdf
%%    bibsort.exe   Binary to create the lists
%%    bibsort.c     Source of bibsort.exe
%%    COPYING       The license of the package



%%  COMPATIBILITY
%%  Change \DeclareRobustCommand into \def before using LaTeX 2.09.
%%  Then, you still NOT have to \protect BibArts-cmds in args of v-cmds.
%%  BibArts 2.2 ONLY has an EMULATION for 1.3 texts:  Keep copies of 1.x?




                         %% INTERNE MINIMALIA %%

%% ~"<`'>:;!? may be active:

\def\grave@ba{\string`}
 {\catcode\grave@ba\~=13%
  \catcode\grave@ba\"=13%
  \catcode\grave@ba\:=13%
  \catcode\grave@ba\;=13%
  \catcode\grave@ba\!=13%
  \catcode\grave@ba\?=13%
  \catcode\grave@ba\'=13%
  \catcode\grave@ba\`=13%
  \catcode\grave@ba\<=13%
  \catcode\grave@ba\>=13%
\gdef\protectchars@active{%
  \ifnum\catcode\grave@ba\~=13\def~{\string~}\fi%
  \ifnum\catcode\grave@ba\"=13\def"{\string"}\fi%
  \ifnum\catcode\grave@ba\:=13\def:{\string:}\fi%
  \ifnum\catcode\grave@ba\;=13\def;{\string;}\fi%
  \ifnum\catcode\grave@ba\!=13\def!{\string!}\fi%
  \ifnum\catcode\grave@ba\?=13\def?{\string?}\fi%
  \ifnum\catcode\grave@ba\'=13\def'{\string'}\fi%
  \ifnum\catcode\grave@ba\`=13\def`{\string`}\fi%
  \ifnum\catcode\grave@ba\<=13\def<{\string<}\fi%
  \ifnum\catcode\grave@ba\>=13\def>{\string>}\fi%
}%
}


\def\typeout@ba#1{{\protectchars@active\typeout{#1}}}

\def\errmessage@ba#1{{\protectchars@active\errmessage{#1.^^J \space. . . . . . . . . . . }}}

\typeout@ba{Style Option BibArts, Version 2.2 [2019] ...}

\def\msg@bafontsubst#1#2{\typeout@ba{{\string#1 ...} is unknown; I'll substitute {\string#2 ...}.}}

\expandafter\ifx\csname bfseries\endcsname\relax\def\bfseries{\bf}\msg@bafontsubst{\bfseries}{\bf}\fi
\expandafter\ifx\csname scshape\endcsname\relax\def\scshape{\sc}\msg@bafontsubst{\scshape}{\sc}\fi
\expandafter\ifx\csname sffamily\endcsname\relax\def\sffamily{\sf}\msg@bafontsubst{\sffamily}{\sf}\fi
\expandafter\ifx\csname slshape\endcsname\relax\def\slshape{\sl}\msg@bafontsubst{\slshape}{\sl}\def\ba@sls{}\else\let\ba@sls=\slshape\fi
\expandafter\ifx\csname itshape\endcsname\relax\def\itshape{\it}\msg@bafontsubst{\itshape}{\it}\def\ba@its{}\else\let\ba@its=\itshape\fi
\expandafter\ifx\csname normalfont\endcsname\relax\def\normalfont{\rm}\msg@bafontsubst{\normalfont}{\rm}\fi
\expandafter\ifx\csname upshape\endcsname\relax
 \def\pupshape{\ifdim\fontdimen\@ne\font=\z@\else\rm\relax\fi}%
 \def\upshape{\protect\pupshape}\msg@bafontsubst{\upshape}{\rm[if it/sl]}\fi




                %% corr for slanted fonts %%

\def\resetcorr@ba{\gdef\bacorr{}\gdef\barefcorr{}}
\resetcorr@ba

\def\bakxxcorr{\bacorr}
\def\baabkcorr{\bacorr}
\def\balistcorr{\bacorr}
\def\bakntsepcorr{\bacorr}
%% Only \barefcorr not yet unified in 2.2 %%

\def\setup@ba#1#2{\let\@bahdtest-{#1{%
   \ifdim\fontdimen\@ne\font=\z@{\ignorespaces #2\ba@textmode\iflasthasdot@ba{\global\let\@bahdtest+}{}}\else
   \if@reportbaup\type@bawarn{Add \string\upshape \space to \string#1}\fi
   {\upshape{\ignorespaces #2\ba@textmode\iflasthasdot@ba{\global\let\@bahdtest+}{}}}\fi}}%
   \iflasthasdot@ba{}{\ifx\@bahdtest+\@bahasdot\fi}}

\def\init@bacorr#1#2#3{\ifdim\lastskip=\hasdotcode@ba\gdef#3{}\else
  {\let\@testa=-\bagetnext@arg#1\endlist@ba
  \ifx\@testa-\makecorrcmd@ba{#2}{#3}\else\gdef#3{}\@bahasdot\fi}\fi}

\def\init@baXcorr#1#2#3{\ifdim\lastskip=\hasdotcode@ba\gdef#3{}\else
  {\let\@testa=-\bagetnext@arg#1\endlist@ba
  \ifx\@testa-\makeXcorrcmd@ba{#2}{#3}\else\gdef#3{}\@bahasdot\fi}\fi}

\def\finddot@ba#1{\ifdim\lastskip=\hasdotcode@ba\let\@testa=+\else
  \bagetnext@arg#1\endlist@ba\fi}

\def\corrrrule@ba{\vrule width 0.1pt height 3pt depth 1pt\kern -0.1pt}
\let\TeXitcorr@ba=\/ 
\def\dofrco@ba@abk{%
  \if@bafrontcorr\ifhmode
  \TeXitcorr@ba \if@showbacorr\ifdim\lastkern=\z@\else\corrrrule@ba\fi\fi
 \fi\fi}
\def\dofrco@ba{\ba@textmode
  \if@bafrontcorr\ifhmode
  \TeXitcorr@ba \if@showbacorr\ifdim\lastkern=\z@\else\corrrrule@ba\fi\fi
 \fi\fi}

\def\@bacorrkern{\kern0.1em\if@showbacorr\corrrrule@ba\fi}
\def\@baXcorrkern{\kern0.1em\if@showbacorr\corrrrule@ba\kern-0.1em\strut\kern0.1em\fi}
\def\@banegkern{\kern-0.1em}

\def\makeXcorrcmd@ba#1#2{{#1{\ifdim\fontdimen\@ne\font=\z@%
  \gdef#2{}\else\gdef#2{\ifdim\fontdimen\@ne\font=\z@\nulskip@ba\strut\@baXcorrkern\fi{}}\fi}}}

\def\makecorrcmd@ba#1#2{{#1{\ifdim\fontdimen\@ne\font=\z@%
  \gdef#2{}\else\gdef#2{\ifdim\fontdimen\@ne\font=\z@\@bacorrkern\nulskip@ba\fi}\fi}}}

\def\@baupcorr{\ifhmode\ifdim\fontdimen\@ne\font=\z@\else\@bacorrkern\nulskip@ba\fi\fi}
\def\pbaupcorr{\iflasthasdot@ba{\nulskip@ba\strut}{\@baupcorr}}
\def\baupcorr{\protect\pbaupcorr}

\def\@badowncorr{\ifhmode\ifdim\fontdimen\@ne\font=\z@\@banegkern\nulskip@ba\fi\fi}
\def\@baendcorr{\ifhmode\ifdim\fontdimen\@ne\font=\z@\else\@banegkern\nulskip@ba\fi\fi}

\def\bagetnext@arg{\afterassignment\do@ba@pt\let\next@ba= }
\def\do@ba@pt{%
  \ifx \next@ba\endlist@ba \let\next@ba\relax
  \else
     \ifx .\next@ba \let\@testa=+\else
        \ifx\egroup\next@ba \else
           \let\@testa=-%
     \fi\fi
     \let\next@ba\bagetnext@arg
  \fi \next@ba}



                %% emphes %%

\def\kxxemph{} %{\itshape}
 
\def\peremph{\normalfont\scshape} %{\upshape}

\def\authoremph{\normalfont\scshape} %{\upshape}

\def\balistnumemph{\sffamily} %{} %{\small\itshape}

\def\arqemph{\normalfont\sffamily} %{\upshape}

\def\edibidemph{\scshape}  %% do not change because of IBIDEM %%



                %% types %%

\def\originalquotetype{\small}  %{\small\itshape}

\def\balisttype{}  %{\slshape}



                %% names and seps for lists %%

\def\killname{$\sim$\kern 0.05em}
\def\femalename{\cap@ba{eadem}}   %%  \vli{\female ...}{...}{...}
\def\malename{\cap@ba{idem}}      %%  \vli{\male ...}{...}{...}


\newif\ifgendering\genderingfalse
\newif\iffemale\femalefalse
\def\female{\global\genderingtrue\global\femaletrue} %% not for use in \vauthor ...
\def\male{\global\genderingtrue\global\femalefalse}  %% ... or \midvauthor!
\def\Ikillname{\ifgendering 
   \iffemale \femalename \else \malename \fi 
 \else \killname \fi}
\def\Pkillname{\cap@ba{iidem}}


\def\prep@bakntsepcorr{\def\bacorr{\ifdim\fontdimen\@ne\font=\z@\else{\kxxemph{\ifdim\fontdimen\@ne\font=\z@\@bacorrkern\nulskip@ba\fi}}\fi}}
\def\not@bakntsepcorr{\def\bacorr{}}
\def\ntsep{: \bacorr}  %{\ifbashortcite{:\hskip0pt plus 0pt\bacorr}{: }}
\def\ppntsep{{\@kxxbafalse\not@bakntsepcorr\ntsep}}
\def\printntsep{\protect\ppntsep}

\def\nsep{\baslash}  %{, }  %{ / \baupcorr}  %{\upshape{\protect\nolinebreak[3] /\protect\linebreak[3] }}


\def\listlnfnsep{, }

\def\arqsep{, }  %{: }  %{\bapoint\newsentence}




                %% switches %%

\def\pnotaffixhints{\@affixhintsfalse}
\def\notaffixhints{\protect\pnotaffixhints}

\def\paffixhints{\@affixhintstrue}
\def\affixhints{\protect\paffixhints}

\def\pannouncektit{\@heraldktittrue}
\def\announcektit{\protect\pannouncektit}

\def\pnotannouncektit{\@heraldktitfalse}
\def\notannouncektit{\protect\pnotannouncektit}

\def\pshowbacorr{\@showbacorrtrue}
\def\showbacorr{\protect\pshowbacorr}

\def\pnotshowbacorr{\@showbacorrfalse}
\def\notshowbacorr{\protect\pnotshowbacorr}

\def\pnotbafrontcorr{\@bafrontcorrfalse}
\def\notbafrontcorr{\protect\pnotbafrontcorr}

\def\pbafrontcorr{\@bafrontcorrtrue}
\def\bafrontcorr{\protect\pbafrontcorr}

\def\pprinthints{\@printhinttrue}
\def\printhints{\protect\pprinthints}

\def\pnotprinthints{\@printhintfalse}
\def\notprinthints{\protect\pnotprinthints}

\def\pktitaddtok{\@makektitktrue}
\def\ktitaddtok{\protect\pktitaddtok}

\def\pnotktitaddtok{\@makektitkfalse}
\def\notktitaddtok{\protect\pnotktitaddtok}


\def\pkurzaddtoarq{\@kurztoarqtrue}
\def\kurzaddtoarq{\protect\pkurzaddtoarq}

\def\pnotkurzaddtoarq{\@kurztoarqfalse}
\def\notkurzaddtoarq{\protect\pnotkurzaddtoarq}


\def\pibidemize{\@ibidemizetrue}
\def\ibidemize{\protect\pibidemize}

\def\pnotibidemize{\@ibidemizefalse}
\def\notibidemize{\protect\pnotibidemize}

\def\pclearbamem{\clearmem@ba}
\def\clearbamem{\protect\pclearbamem}

\def\pshowbamem{\@bashowmemtrue}
\def\showbamem{\protect\pshowbamem}

\def\pnotshowbamem{\@bashowmemfalse}
\def\notshowbamem{\protect\pnotshowbamem}


\def\pnotwriteidemwarnings{\wriwarn@bafalse}
\def\notwriteidemwarnings{\protect\pnotwriteidemwarnings}

\def\pwriteidemwarnings{\wriwarn@batrue}
\def\writeidemwarnings{\protect\pwriteidemwarnings}
%% \bullet   : Ders. fehlt moeglicherweise (gleiche Nachnamen registriert).
%% \heartsuit: Ders. ist offenbar richtig gesetzt (gleiche Nachnamen registriert).
%% \nabla    : Ders. wegen fehlender Autoren in vorausgehender Fussnote unberechtigt.
%% \spadesuit: Ders. ueberscheibt einen Namen, der nicht der vorausgehende ist.
%% \clubsuit : Ders. steht irrefuehrenderweise nach einer Fussnote mit mehreren Autoren.


\def\pconferize{\ba@varstringtrue}
\def\conferize{\protect\pconferize}

\def\pnotconferize{\ba@varstringfalse}
\def\notconferize{\protect\pnotconferize}

\def\pexeditnum{\@bamathaufltrue}
\def\exponenteditionnumber{\protect\pexeditnum}

\def\pnotexeditnum{\@bamathauflfalse}
\def\notexponenteditionnumber{\protect\pnotexeditnum}

\def\pprintlpafo{\@prnbapftrue}
\def\printlongpagefolio{\protect\pprintlpafo}

\def\pnotprintlpafo{\@prnbapffalse}
\def\notprintlongpagefolio{\protect\pnotprintlpafo}

\def\pprintlpevo{\@prnbapevotrue}
\def\printlongpervol{\protect\pprintlpevo}

\def\pnotprintlpevo{\@prnbapevofalse}
\def\notprintlongpervol{\protect\pnotprintlpevo}

\def\if@batone#1#2{{\def\@testa{T1}\ifx\@testa\encodingdefault{#1}\else{#2}\fi}}
\def\ifbatone{\protect\if@batone}
\def\ifbaibidem#1#2{\ifx\isibidem@ba+{#1}\else{#2}\fi}
\def\ifbaperiodical#1#2{\if@perba{#1}\else{#2}\fi}
\def\ifbashortcite#1#2{\if@kxxba{#1}\else{#2}\fi}
\def\ifbaprinthints#1#2{\if@printhint{#1}\else{#2}\fi}
\def\ifbahaspervol#1#2{\ifx\lockpevo@ba+{#1}\else{#2}\fi}

\def\hasdotcode@ba{0.0011pt}
\def\notdotcode@ba{0.0021pt}
\def\@bahasdot{{\nobreak \hskip \hasdotcode@ba}}
\def\@banotdot{{\nobreak \hskip \notdotcode@ba}}
\def\pbahasdot{\@bahasdot}
\def\pbanotdot{\@banotdot}
\def\bahasdot{\protect\pbahasdot}
\def\banotdot{\protect\pbanotdot}
\def\iflasthasdot@ba#1#2{\ifdim\lastskip=\hasdotcode@ba #1\relax\else #2\relax\fi}
\def\pifbahasdot#1#2{\iflasthasdot@ba{{#1}}{{#2}}}
\def\ifbahasdot{\protect\pifbahasdot}
\def\iflastnotdot@ba#1#2{\ifdim\lastskip=\notdotcode@ba #1\relax\else #2\relax\fi}
\def\pbapoint{\iflasthasdot@ba{\nulskip@ba\strut}{\iflastnotdot@ba{\nulskip@ba\strut}{.}}}
\def\bapoint{\protect\pbapoint}

\def\pbadelsb{\ifhmode\ifdim\lastkern=\z@\else\kern-\lastkern\nobreak\fi
   \ifdim\lastskip=\z@\nobreak\else\ifdim\lastskip=\hasdotcode@ba\nobreak\else\ifdim\lastskip=\notdotcode@ba\nobreak\else\hskip-\lastskip\fi\fi\fi\fi}
\def\badelspacebefore{\protect\pbadelsb}

\def\pernosep{\bacorr\nobreak\ }  %{\bastrut\ \bacorr}
\def\pervolshortsep{\ifbaperiodical{\ifbaibidem{, }{\pernosep}}{, }}  %{\bastrut\ \bacorr}
\def\pagefolioshortsep{\bacorr : }  %{\bastrut\ \bacorr}

\def\pwnsn{\@wnsntrue}
\def\warnsamename{\protect\pwnsn}

\def\pnotwnsn{\@wnsnfalse}
\def\notwarnsamename{\protect\pnotwnsn}

\def\@bastrut{\iflasthasdot@ba{\strut}{}\iflastnotdot@ba{\strut}{}}
\def\pbastrut{\protect\@bastrut}
\def\bastrut{\protect\pbastrut}
\def\frompagesep{\bastrut\hskip 1.25em minus 0.25em\bacorr}  %{, }  %{\bacorr; }  %{\bapoint\space ---\nobreak\ }

\def\fromnopagevxxsep{\bapoint}
\def\fromnopagevkcsep{}  %{\bapoint}

\def\fromnopagexrrsep{}
\def\fromnopagearqsep{\bapoint}
\def\fromnopageabksep{}  %{\bapoint}
\def\fromnopagepersep{\bapoint}

  \def\pxrrlo{\bastrut\ \bacorr(}
  \def\pxrrlc{)}
\def\xrrlistopen{\protect\pxrrlo}
\def\xrrlistclose{\protect\pxrrlc}

  \def\parqlo{\bastrut\hskip 1em minus 0.3em\bacorr}
  \def\parqlc{}
\def\arqlistopen{\protect\parqlo}
\def\arqlistclose{\protect\parqlc}

\def\arqsectionopen{\bastrut\ \bacorr $-$ }
\def\arqsectionclose{\bahasdot}
\def\arqsubsectionopen{\bastrut\ \bacorr $-$ }
\def\arqsubsectionclose{\bahasdot}
\def\arqsubsubsectionopen{\bastrut\ \bacorr $-$ }
\def\arqsubsubsectionclose{\bahasdot}

\def\arqsectionbegin{\vskip 4ex plus 1ex minus 1ex\pagebreak[3]\normalsize\bfseries}
\def\arqsubsectionbegin{\vskip 3.5ex plus 0.8ex minus 0.8ex\pagebreak[2]\small\bfseries}
\def\arqsubsubsectionbegin{\vskip 3ex plus 0.6ex minus 0.6ex\pagebreak[2]\footnotesize\bfseries}
\def\arqsectionend{\nopagebreak[3]\vspace{0.5ex}\nopagebreak[3]}
\def\arqsubsectionend{\nopagebreak[3]\vspace{0.5ex}\nopagebreak[3]}
\def\arqsubsubsectionend{\nopagebreak[3]\vspace{0.5ex}\nopagebreak[3]}

  \def\pperlo{\bastrut\ \bacorr $-$ }
  \def\pperlc{}
\def\perlistopen{\protect\pperlo}
\def\perlistclose{\protect\pperlc}

  \def\pabklo{\bastrut\hskip 1.2em minus 0.3em\bacorr}
  \def\pabklc{}
\def\abklistopen{\protect\pabklo}
\def\abklistclose{\protect\pabklc}

\def\abkdefopen{\bacorr\ (}
\def\abkdefclose{)}
\def\defabkopen{\bastrut\ (\bacorr}
\def\defabkclose{\bacorr)}

\def\xrrlistemph{}  %{\itshape}
\def\arqlistemph{\arqemph\relax\normalsize}
\def\perlistemph{\peremph}
\def\abklistemph{\bfseries}  %{\abkemph}




                %% Captions %%


\newif\if@ibidhp\@ibidhpfalse
\newif\if@giep\@giepfalse
\newif\if@fiep\@fiepfalse
\newif\if@eiep\@eiepfalse

\def\psetibid#1#2#3{%\@bsphack
  \def\@testa{#1}%
  \ifx#1g\def\gibidemname{#2#3}\ifx#3.\@gieptrue\else\@giepfalse\fi\fi
  \ifx#1f\def\fibidemname{#2#3}\ifx#3.\@fieptrue\else\@fiepfalse\fi\fi
  \ifx#1e\def\eibidemname{#2#3}\ifx#3.\@eieptrue\else\@eiepfalse\fi\fi
  \ifx\@testa\langcap@ba\ifx#3.\@ibidhptrue\else\@ibidhpfalse\fi\fi
  {\errhelp{Usage:
   ^^J\setibidem{g}{abbr}{.} OR \setibidem{e}{abbr}{.} OR \setibidem{f}{abbr}{.}
   ^^J\setibidem{g}{text}{} OR \setibidem{e}{text}{} OR \setibidem{f}{text}{}}%
  \ifx#1g\else\ifx#1f\else\ifx#1e\else\errorcontextlines=-1%
  \@qqertypeout{setibid}{...}\errmessage@ba{Reject undefined language {#1}}%
  \fi\fi\fi}%
  \def\@testa{}%\@esphack
  }
\def\setibidem{\protect\psetibid}

\def\cap@ba#1{{\csname \langcap@ba#1name\endcsname}}
\def\pbacaptionsgerman{\def\langcap@ba{g}\if@giep\@ibidhptrue\else\@ibidhpfalse\fi}
\def\pbacaptionsfrench{\def\langcap@ba{f}\if@fiep\@ibidhptrue\else\@ibidhpfalse\fi}
\def\pbacaptionsenglish{\def\langcap@ba{e}\if@eiep\@ibidhptrue\else\@ibidhpfalse\fi}
\def\bacaptionsgerman{\protect\pbacaptionsgerman}
\let\bacaptionsngerman=\bacaptionsgerman
\def\bacaptionsfrench{\protect\pbacaptionsfrench}
\def\bacaptionsenglish{\protect\pbacaptionsenglish}

\expandafter\ifx\csname fup\endcsname\relax
\def\pfup#1{\iflasthasdot@ba{}{\@baupcorr}\escb@ba
   \lower-0.75ex\hbox{\scriptsize{\upshape\ignorespaces #1\ba@textmode}}{\@baendcorr}{\kern 0.01pt}}%
\def\fup{\protect\pfup}%
\else
\typeout{\string\fup-command used. I do not redefine.}%
\fi

\expandafter\ifx\csname editor\endcsname\relax
%\def\peditor{\dofrco@ba\setup@ba{\edibidemph}{\cap@ba{editor}}}%
\def\peditor{\cap@ba{editor}}%
\def\editor{\protect\peditor}%
\else
\typeout{\string\editor-command used. I do not redefine.}%
\fi

\expandafter\ifx\csname editors\endcsname\relax
%\def\peditors{\dofrco@ba\setup@ba{\edibidemph}{\cap@ba{editorp}}}%
\def\peditors{\cap@ba{editorp}}%
\def\editors{\protect\peditors}%
\else
\typeout{\string\editors-command used. I do not redefine.}%
\fi

\def\ibidemname@ba{\setup@ba{\edibidemph}{\cap@ba{ibidem}}}

\def\pbaplural{\let\@testb=+}
\def\baplural{\protect\pbaplural}

\def\pbasingular{\let\@testb=.}
\def\basingular{\protect\pbasingular}  %% at the end of __||()[] %%

{\catcode\grave@ba\;=12\gdef\dopassemi@ba{\ifx;\next@ba \let\@testb=+\fi}}
{\catcode\grave@ba\;=13\gdef\doaktsemi@ba{\ifx;\next@ba \let\@testb=+\fi}}
\def\kommin@string#1{\getnext@km#1\endlist@ba}
\def\getnext@km{\afterassignment\do@ba@km\let\next@ba= }
\def\do@ba@km{%
  \ifx \next@ba\endlist@ba \let\next@ba\relax
  \else
   \ifx    -\next@ba \let\@testb=+\fi
   \ifx    ,\next@ba \let\@testb=+\fi
   \ifx  \hy\next@ba \let\@testb=+\fi
   \ifx \fhy\next@ba \let\@testb=+\fi
  %\ifx \phy\next@ba \let\@testb=+\fi
  %\ifx\pfhy\next@ba \let\@testb=+\fi
   \ifx   \f\next@ba \let\@testb=+\fi
   \ifx  \ff\next@ba \let\@testb=+\fi
   \ifx  \pf\next@ba \let\@testb=+\fi
   \ifx \pff\next@ba \let\@testb=+\fi
   \ifx  \sq\next@ba \let\@testb=+\fi
   \ifx \sqq\next@ba \let\@testb=+\fi
   \ifx \psq\next@ba \let\@testb=+\fi
   \ifx\psqq\next@ba \let\@testb=+\fi
   \ifx \basingular\next@ba \basingular\fi
   \ifx \baplural  \next@ba \baplural  \fi
   \ifx\pbasingular\next@ba \basingular\fi
   \ifx\pbaplural  \next@ba \baplural  \fi
   \dopassemi@ba
   \doaktsemi@ba
   \let\next@ba\getnext@km
  \fi \next@ba}

\def\erripfpevo@ba#1{%{ \erri@ba}%
   \ifx#1x\type@bawarn{Empty [] or ()}\else\type@bawarn{Empty || or __}\fi}

\def\printpf@ba#1#2{\if@pfvba{\errorcontextlines=-1%
  \def\@testa{#2}%
  \let\@testb=.%
  \ifx\@testa\@leer \erripfpevo@ba{x}\else
  \ifx\@testa\@leerz\erripfpevo@ba{x}\else
  \if@prnbapf\kommin@string{#2}\fi
  {\if@prnbapf\ifx.\@testb\cap@ba{#1}\else\cap@ba{#1p}\fi
   \else{\pagefolioshortsep}\fi
   {\ignorespaces #2}\let\@testa=-\finddot@ba{#2}\ifx\@testa+\@bahasdot\fi}\fi\fi}\fi}

\def\printpevo@ba#1#2{\if@pfvba{\errorcontextlines=-1%
  \def\@testa{#1}%
  \let\@testb=.%
  \ifx\@testa\@leer \erripfpevo@ba{}\else
  \ifx\@testa\@leerz\erripfpevo@ba{}\else
  \if@prnbapevo\kommin@string{#1}\fi
  {\if@prnbapevo\ifx.\@testb\cap@ba{#2}\else\cap@ba{#2p}\fi
   \else{\pervolshortsep}\fi
   {\ignorespaces #1}\let\@testa=-\finddot@ba{#1}\ifx\@testa+\@bahasdot\fi\gdef\bacorr{}}\fi\fi}\fi}

\def\prints@ba#1#2{{\@herefunctions
  \def\@testa{#2}%
  \def\@testb{#1}%
  \ifx\@testa\@leer \global\let\isibidem@ba=-%
  \else\ifx\@testa\@leerz \global\let\isibidem@ba=-%
  \else{\upshape{%
     \let\@testa=-% 
     \ifx\@testb\@leer {\ignorespaces #2\ba@textmode}\finddot@ba{#2}\else
        \ifx\@testb\@leerz {\ignorespaces #2\ba@textmode}\finddot@ba{#2}\else
           {\ignorespaces #1\ba@textmode}\finddot@ba{#1}\fi\fi
        \ifx\@testa+\@bahasdot\fi \arqsep}}%
  \fi\fi}}

\def\initprintpf@ba#1#2#3{\if@pfvba
   {\@memfunctions\@outsavety\@herefunctions\fillpref@ba{#2}{#3}}%
   {\if@footnote
      \ifx\pmem@ba\pref@ba
         \ifx\isibidem@ba-\printpf@ba{#1}{#3}%
         \else\ifx\lastp@ba+\printpf@ba{#1}{#3}%
              \else \global\let\lookpage@ba=+%
              \fi
         \fi
      \else\printpf@ba{#1}{#3}%
         \if@baouter
            \ifx\isibidem@ba+\ifx\pos@ba1\else\global\let\thisp@ba=+\fi\fi
         \fi
      \fi
    \else\printpf@ba{#1}{#3}\fi
    \global\let\lastp@ba=-%
   }\global\let\pmem@ba=\pref@ba\fi}

\def\initprintpevo@ba#1#2{\if@pfvba
   {\@memfunctions\@outsavety\@herefunctions\fillvolref@ba{#1}}%
   {\if@footnote
      \ifx\volmem@ba\volref@ba
         \ifx\isibidem@ba-\printpevo@ba{#1}{#2}%
         \else\ifx\lastvol@ba+\printpevo@ba{#1}{#2}%
              \else \global\let\onlypevo@ba=-%
              \fi
         \fi
      \else\printpevo@ba{#1}{#2}%
         \fillpmem@ba{}{}%
         \global\let\pfilled@ba=-%
         \if@baouter
            \ifx\isibidem@ba+\ifx\pos@ba1\else\global\let\thisvol@ba=+\fi\fi
         \fi
      \fi
    \else\printpevo@ba{#1}{#2}\fi
    \global\let\lastvol@ba=-%
   }\global\let\volmem@ba=\volref@ba\fi}


\def\initprints@ba#1#2{%
   {\@memfunctions\@outsavety\@herefunctions\fillsref@ba{#2}}%
   {\if@footnote
      \ifx\smem@ba\sref@ba
         \ifx\isibidem@ba-\prints@ba{#1}{#2}%
         \else \ifx\lasts@ba+\prints@ba{#1}{#2}\fi
         \fi
      \else\prints@ba{#1}{#2}%
         \if@baouter
            \ifx\isibidem@ba+\ifx\pos@ba1\else\global\let\thiss@ba=+\fi\fi
         \fi
      \fi
    \else\prints@ba{#1}{#2}\fi
    \global\let\lasts@ba=-%
   }\global\let\smem@ba=\sref@ba}

\def\@bapg#1{\initprintpf@ba{isonpage}{p}{#1}}
\def\@baxpg#1{\initprintpf@ba{isonxpage}{p}{#1}}
\def\@bafolio#1{\initprintpf@ba{isonfolio}{f}{#1}}
\def\@baxfolio#1{\initprintpf@ba{isonxfolio}{f}{#1}}


\bacaptionsgerman   %% default
%% German:
\def\ganonymousname{[Anonym]}
\def\geditorname{[\kern 0.04em Hrsg.]\kern 0.02em}
\let\geditorpname=\geditorname
\setibidem{g}{ebd\kern -0.07em}{.}
\def\gidemname{ders\kern -0.04em.\bahasdot}     %%
\def\geademname{dies\kern -0.04em.\bahasdot}    %% \bahasdot new in 2.2 %%
\def\giidemname{diesn\kern -0.07em.\bahasdot}   %%
\def\gvolname{, Bd.\,}
\def\gvolpname{, Bde.\,}
\def\gpername{\ifbaibidem{, Nr.\,}{\pernosep}}
\def\gperpname{\ifbaibidem{, Nr.\,}{\pernosep}}
\def\gisonfolioname{, Bl.\,}
\def\gisonfoliopname{, Bl.\,}
\def\gisonxfolioname{, dort: Bl.\,}
\def\gisonxfoliopname{, dort: Bl.\,}
\def\gisonpagename{, S.\,}
\def\gisonpagepname{, S.\,}
\def\gisonxpagename{, dort: S.\,}
\def\gisonxpagepname{, dort: S.\,}
\def\gabktitlename{Ab\-k\"ur\-zungen}
\def\gbibtitlename{Quellen und Literatur} %% (Bibliographie:)
\def\gvlititlename{Literatur}             %% <- [L]  (Sekundaerliteratur)
\def\gvqutitlename{Gedruckte Quellen}     %% <- [Q]  (Primaerliteratur)
\def\ghinttovliname{[L]}                  %% -> [L] Literatur
\def\ghinttovquname{[Q]}                  %% -> [Q] Gedruckte Quellen
\def\gpertitlename{Zeitschriften}
\def\garqtitlename{Ungedruckte Quellen}
\def\gvkctitlename{Verwendete Kurztitel}
\def\ggrrtitlename{Ortsregister}
\def\gprrtitlename{Personenregister}
\def\gsrrtitlename{Sachregister}
\def\gannouncektitname{\bastrut\ (\kern 0.015em im Folgenden \baupcorr} %at:fortan
\def\gannouncekendname{)}
\def\grefvbegname{(}
\def\grefverbname{siehe}
\def\grefvpagname{S.\,}
\def\grefvfntname{, Anm.\,}
\def\grefvendname{\barefcorr)}
\def\gconfername{\kern -0.03em wie}
\def\gerscheditionname{\teskip Auf{\kern.03em}l.,} %{\teskip Aufl.,}
\def\gerschvolumename{Bd.,}
\def\gerschvolumepname{Bde.,}
\def\gerschnohousename{\oO,} %{ohne Ort,}
\def\gerschnoyearname{\oJ} %.% %{ohne Jahr}
 \def\oD{\protect\poD} \def\poD{o.\kern 0.1em D\kern -0.08em.\bahasdot}
 \def\oO{\protect\poO} \def\poO{o.\kern 0.1em O\kern -0.08em.\bahasdot}
 \def\oJ{\protect\poJ} \def\poJ{o.\kern 0.1em J\kern -0.09em.\bahasdot}
\def\gfolpagename{\badelspacebefore\,f\kern -0.1pt.\bahasdot}
\def\gxfolpagename{\badelspacebefore\,ff\kern -0.1pt.\bahasdot}

\expandafter\ifx\csname f\endcsname\relax
 \def\f{\protect\pf}%
 \def\pf{\cap@ba{folpage}}%
\else
\typeout{\string\f-command used. I do not redefine.}%
\fi

\expandafter\ifx\csname sq\endcsname\relax
 \def\sq{\protect\psq}%
 \def\psq{\cap@ba{folpage}}%
\else
\typeout{\string\sq-command used. I do not redefine.}%
\fi

\expandafter\ifx\csname ff\endcsname\relax
 \def\ff{\protect\pff}%
 \def\pff{\cap@ba{xfolpage}}%
\else
\typeout{\string\ff-command used. I do not redefine.}%
\fi

\expandafter\ifx\csname sqq\endcsname\relax
 \def\sqq{\protect\psqq}%
 \def\psqq{\cap@ba{xfolpage}}%
\else
\typeout{\string\sqq-command used. I do not redefine.}%
\fi

%% French:
\def\fanonymousname{[Anonyme]}
\def\feditorname{(\kern -0.03em \'ed.\kern -0.06em)\kern 0.02em}
\let\feditorpname=\feditorname
\setibidem{f}{ibid\kern -0.07em}{.}
\def\fidemname{le m\^e\-me}
\def\feademname{la m\^e\-me}
\def\fiidemname{les m\^e\-mes}
\def\fvolname{, vol.\,}
\def\fvolpname{, vol.\,}
\def\fpername{\ifbaibidem{, n\fup{o}\,}{\pernosep}}
\def\fperpname{\ifbaibidem{, n\fup{os}\,}{\pernosep}}
\def\fisonfolioname{, folio\nobreak \ }
\def\fisonfoliopname{, folii\nobreak \ }
\def\fisonxfolioname{, l\`a: Folio\nobreak \ }
\def\fisonxfoliopname{, l\`a: Folii\nobreak \ }
\def\fisonpagename{, p.\,}
\def\fisonpagepname{, p.\,}
\def\fisonxpagename{, l\`a: p.\,}
\def\fisonxpagepname{, l\`a: p.\,}
\def\fabktitlename{Ab\-r\'e\-viations}
\def\fbibtitlename{Bibliographie}             %% (Travaux+Sources:)
\def\fvlititlename{Travaux}                   %% <- [T]
\def\fvqutitlename{Sources im\-pri\-m\'ees}   %% <- [S]
\def\fhinttovliname{[T]}                      %% -> [T] Travaux
\def\fhinttovquname{[S]}                      %% -> [S] Sources imprim\'ees
\def\fpertitlename{P\'e\-riodiques}
\def\farqtitlename{Sources in\-\'edi\-tes}
\def\fvkctitlename{Titres ab\-r\'e\-g\'ees}
\def\fgrrtitlename{Registre g\'eo\-graphique}
\def\fprrtitlename{Registre des personnes}
\def\fsrrtitlename{Registre des sujets}
\def\fannouncektitname{\bastrut\ (\kern 0.02em par la suite \baupcorr}
\def\fannouncekendname{)}
\def\frefvbegname{(}
\def\frefverbname{voir}
\def\frefvpagname{p.\,}
\def\frefvfntname{, n.\,}
\def\frefvendname{\barefcorr)}
\def\fconfername{\kern -0.03em op.\ cit.\bahasdot}
\def\ferscheditionname{\fupskip \'edi\-tion,}   %% -> \fordinal=\fordinalf
\def\ferschvolumename{vol.,}
\def\ferschvolumepname{vol.,}
\def\ferschnohousename{s.\kern 0.15em l\kern 0.02em.,}  %% sans lieu
\def\ferschnoyearname{s.\kern 0.13em d.\bahasdot}  %% sans date
\def\ffolpagename{\badelspacebefore\ sq.\bahasdot}
\def\fxfolpagename{\badelspacebefore\ sqq.\bahasdot}

%% English:
\def\eanonymousname{[Anonymous]}
\def\eeditorname{(\kern -0.03em ed.\kern -0.06em)\kern 0.02em}
\def\eeditorpname{(\kern -0.03em eds.\kern -0.08em)\kern 0.02em}
\setibidem{e}{ibidem}{}
\def\eidemname{idem}
\def\eeademname{eadem}
\def\eiidemname{iidem}
\def\evolname{, vol.\,}
\def\evolpname{, vols.\,}
\def\epername{\ifbaibidem{, no.\,}{\pernosep}}
\def\eperpname{\ifbaibidem{, no.\,}{\pernosep}}
\def\eisonfolioname{, folio\nobreak \ }%{, f.\,}
\def\eisonfoliopname{, folii\nobreak \ }
\def\eisonxfolioname{, there: Folio\nobreak \ }
\def\eisonxfoliopname{, there: Folii\nobreak \ }
\def\eisonpagename{, p.\,}
\def\eisonpagepname{, pp.\,}
\def\eisonxpagename{, there: p.\,}
\def\eisonxpagepname{, there: pp.\,}
\def\eabktitlename{Abbreviations}
\def\ebibtitlename{Bibliography}          %% (Literature+Sources:)
\def\evlititlename{Literature}            %% <- [L]  (Secondary Literature)
\def\evqutitlename{Published Documents}   %% <- [D]  (Primary Literature)
\def\ehinttovliname{[L]}                  %% -> [L] Literature
\def\ehinttovquname{[D]}                  %% -> [D] Printed Sources
\def\epertitlename{Periodicals}
\def\earqtitlename{Unpublished Documents}
\def\evkctitlename{Shortened References}
\def\egrrtitlename{Geographical index}
\def\eprrtitlename{Person index}
\def\esrrtitlename{Subject index}
\def\eannouncektitname{\bastrut\ (\kern -0.02em cited as \baupcorr}  %henceforth
\def\eannouncekendname{)}
\def\erefvbegname{[\nobreak \hskip 1pt plus 0pt}
\def\erefverbname{see}
\def\erefvpagname{p.\,}
\def\erefvfntname{, n.\,}
\def\erefvendname{\nobreak \hskip 1pt plus 0pt\barefcorr]}
\def\econfername{\kern -0.05em cf.\bahasdot}
\def\eerscheditionname{\fupskip edition,}
\def\eerschvolumename{vol.,}
\def\eerschvolumepname{vols.,}
\def\eerschnohousename{n.\kern 0.15em p.,}  %% no place
\def\eerschnoyearname{n.\kern 0.13em d.\bahasdot}  %% no date
\def\efolpagename{\badelspacebefore\,f\kern -0.1pt.\bahasdot}
\def\exfolpagename{\badelspacebefore\,ff\kern -0.1pt.\bahasdot}

\def\pnewsentence{{\ifnum\sfcode\grave@ba\.=3000\spacefactor3000\@leerz\fi\@leerz}}
\def\newsentence{\protect\pnewsentence}
\def\spacefactorMMM@ba{\if@unusedbib\else\ifhmode\ifnum\sfcode\grave@ba\.=3000\spacefactor3000\fi\fi\fi}
\def\spacefactorM@ba{\if@unusedbib\else\ifhmode\ifnum\sfcode\grave@ba\.=3000\spacefactor1000\fi\fi\fi}

%%

\def\ba@textmode{\ifmmode $\type@bawarn{Set forgotten \string$}\fi}


\def\@herefunctions{%
   \errorcontextlines=-1% 
   \def\onlyout##1{}%     %% Genauso in \@hereRfunctions.
   \def\onlyhere##1{##1}% %% Dito.
   \def\onlyvoll##1{##1}% %% Umgekehrt in \@hereRfunctions.
   \def\onlykurz##1{}%    %% Dito.
   \def\sort##1{}%
   \def\bago{}%
   \def\verb{\errmessage{verbatim is forbidden inside BibArts args}}%
}


%%


\def\@outsavety{%         %% not protect \nsep %%
   \protectchars@active%
   \def\newpage{\protect\newpage}%
   \def\frq{\protect\frq}%
   \def\flq{\protect\flq}%
   \def\frqq{\protect\frqq}%
   \def\flqq{\protect\flqq}%
   \def\"{\string\"}%
    \def\ddot{\protect\ddot}%
   \def\.{\string\.}%
    \def\dot{\protect\dot}%
   \def\={\string\=}%
    \def\bar{\protect\bar}%
     \def\vec{\protect\vec}%
   \def\^{\string\^}%
    \def\hat{\protect\hat}%
   \def\'{\string\'}%
    \def\acute{\protect\acute}%
   \def\`{\string\`}%
    \def\grave{\protect\grave}%
   \def\~{\string\~}%
    \def\tilde{\protect\tilde}%
   \def\P{\protect\P}%
   \def\S{\protect\S}%
   \def\aa{\protect\aa}%
   \def\ae{\protect\ae}%
   \def\AA{\protect\AA}%
   \def\AE{\protect\AE}%
   \def\b{\protect\b}%
   \def\c{\protect\c}%
   \def\d{\protect\d}%
   \def\H{\protect\H}%
   \def\i{\protect\i}%
   \def\j{\protect\j}%
   \def\l{\protect\l}%
   \def\L{\protect\L}%
   \def\o{\protect\o}%
   \def\O{\protect\O}%
  \def\ss{\protect\ss}%
  \def\3{\string\3}%
  \def\newhyss{\protect\newhyss}%
  \def\NEWHYSS{\protect\NEWHYSS}%
  \def\oldhyss{\protect\oldhyss}%
  \def\OLDHYSS{\protect\OLDHYSS}%
  \def\oldhyc{\protect\oldhyc}%
  \def\OLDHYC{\protect\OLDHYC}%
  \def\oldhyf{\protect\oldhyf}%
  \def\OLDHYF{\protect\OLDHYF}%
  \def\oldhyl{\protect\oldhyl}%
  \def\OLDHYL{\protect\OLDHYL}%
  \def\oldhym{\protect\oldhym}%
  \def\OLDHYM{\protect\OLDHYM}%
  \def\oldhyn{\protect\oldhyn}%
  \def\OLDHYN{\protect\OLDHYN}%
  \def\oldhyp{\protect\oldhyp}%
  \def\OLDHYP{\protect\OLDHYP}%
  \def\oldhyr{\protect\oldhyr}%
  \def\OLDHYR{\protect\OLDHYR}%
  \def\oldhyt{\protect\oldhyt}%
  \def\OLDHYT{\protect\OLDHYT}%
  \def\ck{\protect\ck}%
  \def\CK{\protect\CK}%
   \def\k{\protect\k}%
   \def\r{\protect\r}%
    \def\mathring{\protect\mathring}%
   \def\t{\protect\t}%
   \def\u{\protect\u}%
    \def\breve{\protect\breve}%
   \def\v{\protect\v}%
    \def\check{\protect\check}%
   %%\def\|{\string\|}%  %% \fnsymbol ? %%
   \def\,{\string\,}%
   \def\*{\string\*}%
   \def\@{\string\@}%
   \def\-{\string\-}%
   \def\_{\string\_}%
   \def\${\string\$}%
   \def\\{\string\\}%
     \def\{{\string\{}%
     \def\}{\string\}}%
   \def\leavevmode{\protect\leavevmode}%
   \def\rlap{\protect\rlap}%
   \def\llap{\protect\llap}%
   \def\nobreak{\protect\nobreak}%
   \def\mathhexbox{\protect\mathhexbox}%
    \def\authoremph{\protect\authoremph}%
     \def\cal{\protect\cal}%
     \def\mit{\protect\mit}%
     \def\footnotesize{\protect\footnotesize}%
     \def\huge{\protect\huge}%
     \def\Huge{\protect\Huge}%
     \def\large{\protect\large}%
     \def\Large{\protect\Large}%
     \def\LARGE{\protect\LARGE}%
     \def\scriptsize{\protect\scriptsize}%
     \def\small{\protect\small}%
     \def\tiny{\protect\tiny}%
     \def\normalsize{\protect\normalsize}%
   %\def\label##1{}%
   \def\label{\protect\label}%  %% 2.09/2e? %%
   \def\index{\protect\index}%
   \def\glossary{\protect\glossary}%
   \def\Alpha{\protect\Alpha}%
   \def\Beta{\protect\Beta}%
   \def\Epsilon{\protect\Epsilon}%
   \def\Zeta{\protect\Zeta}%
   \def\Eta{\protect\Eta}%
   \def\Iota{\protect\Iota}%
   \def\Kappa{\protect\Kappa}%
   \def\Mu{\protect\Mu}%
   \def\Nu{\protect\Nu}%
   \def\Rho{\protect\Rho}%
   \def\Tau{\protect\Tau}%
   \def\Chi{\protect\Chi}%
   \def\Omicron{\protect\Omicron}%
   \def\omicron{\protect\omicron}%
   \def\backslash{\protect\backslash}%
   \def\sz{\protect\sz}%
   \def\SZ{\protect\SZ}%
   \def\selectlanguage{\protect\selectlanguage}%
   \def\sethyphenation{\protect\sethyphenation}%
   \def\frac{\protect\frac}%
   \def\nosort{\protect\nosort}%
   \def\hy{\protect\hy}%
   \def\fhy{\protect\fhy}%
   \def\bastrut{\protect\bastrut}%
}


%%


%% Only single-line-eintries in .AUX-Files (LaTeX 2.09):
\expandafter\ifx\csname GenericError\endcsname\relax
  \typeout@ba{* Redefine \string\@ctrerr \space to get single-line entries in .aux-file.}%
  \def\@ctrerr{{\errorcontextlines=-1\errmessage{Counter too large (alph/Alph/fnsymbol)}}}%
\fi


\def\@outfunctions{%
   \errorcontextlines=-1%
   \def\protect{\noexpand\noexpand\noexpand}%
   \def\protect@onlyout{\protect}%
   \def\par{}%   %% Fehlermeldungen verringen %%
   \if@unusedbib\def\setn@ba{{}{}{-}}\fi%
   \def\onlyhere{\protect\onlyhere}%
   \def\onlyout{\protect\onlyout}%
   \def\onlyvoll{\protect\onlyvoll}%
   \def\onlykurz{\protect\onlykurz}%
    \def\kurz{\if@baouter\protect\outkurz\else\protect\delkurz\fi}%
    \def\ktit{\protect\ktit}%
   \def\vauthor{\protect\vauthor}%
   \def\midvauthor{\protect\midvauthor}%
   \def\kauthor{\protect\kauthor}%
   \def\midkauthor{\protect\midkauthor}%
   \def\addtovli{\protect\shadowv}%
   \def\addtovqu{\protect\shadowv}%
   \def\addtokli{\protect\shadowk}%
   \def\addtokqu{\protect\shadowk}%
   \def\vli{\protect\printonlyvli}%
   \def\vqu{\protect\printonlyvqu}%
   \def\kli{\protect\printonlykli}%
   \def\kqu{\protect\printonlykqu}%
   \def\printonlyvli{\protect\printonlyvli}%
   \def\printonlyvqu{\protect\printonlyvqu}%
   \def\printonlykli{\protect\printonlykli}%
   \def\printonlykqu{\protect\printonlykqu}%
   \def\xaddtovli{\protect\shadowv}%
   \def\xaddtovqu{\protect\shadowv}%
   \def\xaddtokli{\protect\shadowk}%
   \def\xaddtokqu{\protect\shadowk}%
   \def\xvli{\protect\xprintonlyvli}%
   \def\xvqu{\protect\xprintonlyvqu}%
   \def\xkli{\protect\xprintonlykli}%
   \def\xkqu{\protect\xprintonlykqu}%
   \def\xprintonlyvli{\protect\xprintonlyvli}%
   \def\xprintonlyvqu{\protect\xprintonlyvqu}%
   \def\xprintonlykli{\protect\xprintonlykli}%
   \def\xprintonlykqu{\protect\xprintonlykqu}%
   \def\per{\protect\printonlyper}%
   \def\abkper{\protect\printonlyper}%
   \def\fillper{\protect\shadowtwo}%
   \def\arq{\protect\printonlyarq}%
   \def\fillarq{\protect\shadowtwo}%
   \def\fillgrr{\protect\shadowtwo}%
   \def\fillprr{\protect\shadowtwo}%
   \def\fillsrr{\protect\shadowtwo}%
   \def\abk{\protect\printonlyabk}%
   \def\defabk{\protect\printonlydefabk}%
   \def\abkdef{\protect\printonlyabkdef}%
   \def\addtoper{\protect\shadowo}%
   \def\addtoarq{\protect\shadowt}%
   \def\addtoabk{\protect\shadowone}%
   \def\addtodefabk{\protect\shadowtwo}%
   \def\addtoabkdef{\protect\shadowtwo}%
   \def\addtogrr{\protect\shadowone}%
   \def\addtoprr{\protect\shadowone}%
   \def\addtosrr{\protect\shadowone}%
   \def\printonlyper{\protect\printonlyper}%
   \def\printonlyarq{\protect\printonlyarq}%
   \def\printonlyabk{\protect\printonlyabk}%
   \def\printonlydefabk{\protect\printonlydefabk}%
   \def\printonlyabkdef{\protect\printonlyabkdef}%
   \def\female{\protect\female}%
   \def\male{\protect\male}%
   \def\sort{\protect\sort}%
   \def\bago{\protect\bago}%
   \def\bahasdot{\protect\bahasdot}%
   \def\bacorr{\protect\bacorr}%
   \def\verb{\errmessage{verbatim is forbidden inside BibArts args}}%
}


%%


\def\@memfunctions{%
   \errorcontextlines=-1%
   \def\protect{\noexpand\noexpand\noexpand}%
   \def\kurz{\protect\kurz}%
   \def\ktit{\protect\ktit}%
   \def\addtovli{\protect\addtovli}%
   \def\addtovqu{\protect\addtovqu}%
   \def\addtokli{\protect\addtokli}%
   \def\addtokqu{\protect\addtokqu}%
   \def\printonlyvli{\protect\printonlyvli}%
   \def\printonlyvqu{\protect\printonlyvqu}%
   \def\printonlykli{\protect\printonlykli}%
   \def\printonlykqu{\protect\printonlykqu}%
   \def\vli{\protect\vli}%
   \def\vqu{\protect\vqu}%
   \def\kli{\protect\kli}%
   \def\kqu{\protect\kqu}%
   \def\xaddtovli{\protect\xaddtovli}%
   \def\xaddtovqu{\protect\xaddtovqu}%
   \def\xaddtokli{\protect\xaddtokli}%
   \def\xaddtokqu{\protect\xaddtokqu}%
   \def\xprintonlyvli{\protect\xprintonlyvli}%
   \def\xprintonlyvqu{\protect\xprintonlyvqu}%
   \def\xprintonlykli{\protect\xprintonlykli}%
   \def\xprintonlykqu{\protect\xprintonlykqu}%
   \def\xvli{\protect\xvli}%
   \def\xvqu{\protect\xvqu}%
   \def\xkli{\protect\xkli}%
   \def\xkqu{\protect\xkqu}%
   \def\per{\protect\per}%
   \def\abkper{\protect\abkper}%
   \def\fillper{\protect\fillper}%
   \def\arq{\protect\arq}%
   \def\fillarq{\protect\fillarq}%
   \def\fillgrr{\protect\fillgrr}%
   \def\fillprr{\protect\fillprr}%
   \def\fillsrr{\protect\fillsrr}%
   \def\abk{\protect\abk}%
   \def\abkdef{\protect\abkdef}%
   \def\defabk{\protect\defabk}%
   \def\addtoper{\protect\addtoper}%
   \def\addtoarq{\protect\addtoarq}%
   \def\addtoabk{\protect\addtoabk}%
   \def\addtoabkdef{\protect\addtoabkdef}%
   \def\addtodefabk{\protect\addtodefabk}%
   \def\addtogrr{\protect\addtogrr}%
   \def\addtoprr{\protect\addtoprr}%
   \def\addtosrr{\protect\addtosrr}%
   \def\printonlyper{\protect\printonlyper}%
   \def\printonlyarq{\protect\printonlyarq}%
   \def\printonlyabk{\protect\printonlyabk}%
   \def\printonlyabkdef{\protect\printonlyabkdef}%
   \def\printonlydefabk{\protect\printonlydefabk}%
   \def\onlyhere{\protect\onlyhere}%
   \def\onlyout{\protect\onlyout}%
   \def\onlyvoll{\protect\onlyvoll}%
   \def\onlykurz{\protect\onlykurz}%
   \def\vauthor{\protect\vauthor}%
   \def\midvauthor{\protect\midvauthor}%
   \def\kauthor{\protect\kauthor}%
   \def\midkauthor{\protect\midkauthor}%
   \def\female{}%
   \def\male{}%
   \def\sort{\protect\sort}%  %% Nur wirksam in \protec@scr %%
   \def\bahasdot{}%
   \def\banotdot{}%
   \def\bago{}%
}


%%


\def\@hereRfunctions{%
   \def\onlyout##1{}%       %% Genauso in \@herefunctions
   \def\onlyhere##1{##1}%   %% Genauso in \@herefunctions
   \def\onlyvoll##1{}%      %% Umgekehrt in \@herefunctions
   \def\onlykurz##1{##1}%   %% Umgekehrt in \@herefunctions
   \def\vauthor##1##2{\kauthor{##2}}%        %% Vgl. \@hereFfunctions %%
   \def\midvauthor##1##2{\kauthor{##2}{\nsep}\ignorespaces}%
   \def\sort##1{}%
}


\def\@hereFfunctions{%
   \def\vauthor##1##2{\kauthor{##2}}%        %% Vgl. \@hereRfunctions %%
   \def\midvauthor##1##2{\midkauthor{##2}}%
}


%%


                %% commands for users %%


\def\pBibArts{{\upshape{B\kern -.7pt\lower .5ex\hbox{i}\kern -1.45pt\lower -.285ex\hbox{\itshape{b}}\kern -2.5pt\lower .5ex\hbox{A}\kern -2.6pt\lower -.6ex\hbox{r}\kern -1.4pt\lower .2ex\hbox{t}\kern -1.4pt\lower -.303ex\hbox{s}}}}
\def\BibArts{\protect\pBibArts}

\def\bago{\command@misplace{\bago}}

\def\onlyhere{\command@misplace{\onlyhere}}
\def\onlyout{\command@misplace{\onlyout}}
\def\onlyvoll{\command@misplace{\onlyvoll}}
\def\onlykurz{\command@misplace{\onlykurz}}
\def\nosort{}
\expandafter\ifx\csname sort\endcsname\relax
 \def\sort{\command@misplace{\sort}}%
 \else \typeout@ba{ \string\sort\space is already defined ...
   ^^J \space I *only* change its local definition inside BibArts' arguments.}%
\fi
\def\ktit{{\errhelp{
   ^^JUse `\ktit{short-title}' only in the last argument of ...v..-cmds
   ^^Jto mark a part of the full-cited title (for being the short-title),
   ^^Je.g. \vli{Herbert} {Smith} {The \ktit{Story}, \ersch{Paris}{1977}}[22].
   ^^JIf you want to cite Smith's Story again, you may use the short-title
   ^^Jlater as last argument of a ...k..-cmd, e.g. \kli{Smith} {Story}[37].
   ^^JThe use of \ktit - and ...k.. - is necessary to set IBIDEM (in footnotes).^^J}%
   \errmessage@ba{Misplaced \string\ktit-cmd}}}
\def\kurz#1{\unskip{\cap@ba{announcektit}}\if@kurztoarq{\@initaddtoarq[]{}{#1}}\fi{\@herefunctions\setup@ba{\arqemph}{#1}}{\cap@ba{announcekend}}}
\def\kurz@ktit#1{\unskip\type@bawarn{\string\kurz\space and \string\ktit\space used}}
\def\outkurz#1{\unskip{} [{#1\ba@textmode}]}
\def\delkurz#1{\unskip}

\def\vollout#1{\onlyvoll{\onlyout{#1}}}
\def\vollhere#1{\onlyvoll{\onlyhere{#1}}}

\def\protmva#1#2{\dofrco@ba\@printvname{#1}{\bastrut\ }{#2}{0}{0}{\nsep}\ignorespaces}
\def\midvauthor{\protect\protmva}

\def\protva#1#2{\dofrco@ba\@printvname{#1}{\bastrut\ }{#2}{0}{0}}
\def\vauthor{\protect\protva}

\def\ntvauthor#1#2{\protect@onlyout\vauthor{#1}{#2}\protect\ntsepnta}

\def\protmka#1{\dofrco@ba\@printkname{#1}{0}{\nsep}\ignorespaces}
\def\midkauthor{\protect\protmka}

\def\protka#1{\dofrco@ba\@printkname{#1}{0}}
\def\kauthor{\protect\protka}

\def\ntkauthor#1{\protect@onlyout\kauthor{#1}\protect\ntsepnta}

\def\protect@onlyout{}
\def\ntsepnta{\printntsep\ignorespaces}

\def\printcatcode#1{\the\catcode\grave@ba#1}
  %% E.g. \printcatcode{\"} for value of " %%


%%


                %% internal %%

\expandafter\ifx\csname z@skip\endcsname\relax
\def\nulskip@ba{{\nobreak \hskip 0pt plus 0pt}}%
\else
\def\nulskip@ba{{\nobreak \hskip \z@skip}}%
\fi

\def\pbaslash{{\nobreak \hskip 0.24em plus 0.08em\lower -0.26ex\hbox{%
   \normalfont\scriptsize /}\penalty-\@m\hskip .2em plus 0.08em}}
\def\baslash{\protect\pbaslash}

\expandafter\ifx\csname inputlineno\endcsname\relax
   \typeout@ba{Install missing count \string\inputlineno: Can't handle file line numbers.}%
   \newcount\inputlineno\inputlineno=-1\fi

\def\line@ba{\the\inputlineno}
\def\lang@ba{\the\language}
\def\catq@ba{\the\catcode\grave@ba\"}
\def\erri@ba{\ifnum\catcode\grave@ba\?=13\string?\string?\else??\fi}
\def\setn@ba{{\thepage}\if@footnote{\@thefnmark}{@}\else{}{}\fi}

{\catcode\grave@ba\%=12\gdef\commentch@ba{%}}

\def\@leer{}
\def\@leerz{ }  %% \ifx %%

\newif\if@affixhints\@affixhintsfalse
\newif\if@kurztoarq\@kurztoarqtrue 
\newif\if@reportbaup\@reportbauptrue
\newif\if@bafrontcorr\@bafrontcorrtrue
\newif\if@showbacorr\@showbacorrfalse
\newif\if@bamathaufl\@bamathauflfalse
\newif\if@heraldktit\@heraldktittrue
\newif\if@baouter\@baoutertrue
\newif\if@rheraldktit\@rheraldktittrue
\newif\if@printhint\@printhinttrue
\newif\if@footnote\@footnotefalse
\newif\if@makektitk\@makektitktrue
\newif\if@ibidemize\@ibidemizetrue
\newif\ifwriwarn@ba\wriwarn@bafalse
\newif\if@bashowmem\@bashowmemfalse
\newif\ifba@varstring\ba@varstringfalse
\newif\if@allowconferize\@allowconferizetrue
\newif\if@prnbapf\@prnbapftrue
\newif\if@prnbapevo\@prnbapevotrue
\newif\if@pfvba
\newif\if@perba
\newif\if@kxxba
\newif\if@vxxbalist\@vxxbalistfalse
\newif\if@balist\@balistfalse
\newif\if@wnsn\@wnsntrue


\def\makeibid@ba{%
   \if@bashowmem
      \if@baminipage
              \protec@scr{^^J Minipage-FNT \thempfootnote}\else
              \protec@scr{^^J FNT \thefootnote}\fi
              \protec@scr{^^J -- outer: \space \tmemo@ba \space -- }%
                 \protec@scr{ ---------- inner: \space \tmemi@ba \space -- }%
      \if@baouter\protec@scr{ -- o-ref: \space \tref@ba \space -- ^^J}\else
                 \protec@scr{ ---------- i-ref: \space \tref@ba \space -- ^^J}\fi
   \fi
               \global\let\isibidem@ba=-%
    \if@baouter\global\let\lookpage@ba=-\fi
    \if@footnote \if@baouter\makethiso@ba\else\makethisi@ba\fi
       \if@baouter
          \ifx\lastto@ba+%
             \ifx\tmemo@ba\tref@ba \global\let\isibidem@ba=+%
                 \ifx\thisti@ba-\global\let\thisti@ba=+\fi
             \else
                 \filltmemi@ba{}{}{}{}%
                 \ifx\thisti@ba+\global\let\thisti@ba=.\fi
             \fi          
          \fi
       \else
          \ifx\lastti@ba+%
             \ifx\tmemi@ba\tref@ba \global\let\isibidem@ba=+\fi
          \fi
       \fi    
    \fi}

\def\makelast@ba{%
  \if@footnote
    \global\let\pmem@ba=\pref@ba
    \global\let\volmem@ba=\volref@ba
    \if@baouter
      \global\let\tmemo@ba=\tref@ba
      \global\let\lastto@ba=+%
      \global\let\nmem@ba=\nref@ba
    \else
      \global\let\tmemi@ba=\tref@ba
      \global\let\lastti@ba=+%
    \fi
  \fi}


%%%  You may comment out changes to footnote numbers from here ...

\expandafter\ifx\csname @footnotemark\endcsname\relax
\else
\let\ba@footnmark=\@footnotemark
\def\@footnotemark{\ifhmode{\nobreak \hskip 0.04em plus 0.01em}\else\leavevmode\fi\ba@footnmark}%
\fi

%%%  ... up to here.


\let\lastto@ba=+   %% \vli{A}{B+}{\ktit{C}} and \kli{B+}{C} in first fnt %%
\def\makethiso@ba{%
  \ifx\thisto@ba+\ifx\tmemo@ba\tref@ba\else\global\let\thisto@ba=.\fi\fi
  \ifx\thisto@ba-\global\let\thisto@ba=+\fi
  \ifx\pos@ba1\global\let\pos@ba=2\fi
  \ifx\pos@ba0\global\let\pos@ba=1\fi}

\let\lastti@ba=+
\def\makethisi@ba{%
  \ifx\thisti@ba+\ifx\tmemi@ba\tref@ba\else\global\let\thisti@ba=.\fi\fi
  \ifx\thisti@ba-\global\let\thisti@ba=+\fi}

\let\lastn@ba=-
\expandafter\ifx\csname @footnotetext\endcsname\relax
\type@bawarn{No footnote numbers}%
\else
\let\ba@footnotetext=\@footnotetext
\long\def\@footnotetext#1{\ba@footnotetext{%
   \global\let\thisto@ba=-%
   \global\let\thisti@ba=-%
   \global\let\thisp@ba=-%
   \global\let\thisvol@ba=-%
   \global\let\thiss@ba=-%
   \global\let\thisn@ba=-%
   \global\let\pos@ba=0%
    \kern 0.1em\nulskip@ba{\@footnotetrue\ignorespaces
    #1\nulskip@ba\ba@textmode}\global\let\lastto@ba=\thisto@ba
   \global\let\lastti@ba=\thisti@ba
   \global\let\lastp@ba=\thisp@ba
   \global\let\lastvol@ba=\thisvol@ba
   \global\let\lasts@ba=\thiss@ba
   \global\let\lastn@ba=\thisn@ba}}%
\fi

\expandafter\ifx\csname @mpfootnotetext\endcsname\relax
\type@bawarn{No minipage-footnote numbers}%
\else
\let\ba@mpfootnotetext=\@mpfootnotetext
\long\def\@mpfootnotetext#1{\ba@mpfootnotetext{%
   \global\let\thisto@ba=-%
   \global\let\thisti@ba=-%
   \global\let\thisp@ba=-%
   \global\let\thisvol@ba=-%
   \global\let\thiss@ba=-%
   \global\let\thisn@ba=-%
   \global\let\pos@ba=0%
    \kern 0.1em\nulskip@ba{\@footnotetrue\ignorespaces
    #1\nulskip@ba\ba@textmode}\global\let\lastto@ba=\thisto@ba
   \global\let\lastti@ba=\thisti@ba
   \global\let\lastp@ba=\thisp@ba
   \global\let\lastvol@ba=\thisvol@ba
   \global\let\lasts@ba=\thiss@ba
   \global\let\lastn@ba=\thisn@ba}}%
\fi


\newif\if@baminipage\@baminipagefalse
\newif\if@bainnerminipage\@bainnerminipagefalse

\let\ba@minipg=\minipage
\def\minipage{\if@baminipage\@bainnerminipagetrue\else
   \savemem@ba\clearmem@ba
   \global\let\lastto@ba=+%
   \global\let\lastti@ba=+%
   %\global\let\lastp@ba=-%
   %\global\let\lastvol@ba=-%
   %\global\let\lasts@ba=-%
   \global\let\lastn@ba=-%
   \global\let\pfilled@ba=-%
   \global\let\pevofilled@ba=-%
  \fi
  \global\@baminipagetrue\ba@minipg}

\let\ba@endminipg=\endminipage
\def\endminipage{\if@bainnerminipage\else
   \restoremem@ba\global\@baminipagefalse\fi
   \ba@endminipg}

\def\savemem@ba{%
   \global\let\Stmemo@ba=\tmemo@ba
   \global\let\Stmemi@ba=\tmemi@ba
   \global\let\Stref@ba=\tref@ba
   \global\let\Snmem@ba=\nmem@ba
   \global\let\Snref@ba=\nref@ba
   \global\let\Spmem@ba=\pmem@ba
   \global\let\Spref@ba=\pref@ba
   \global\let\Svolmem@ba=\volmem@ba
   \global\let\Svolref@ba=\volref@ba
   \global\let\Ssmem@ba=\smem@ba
   \global\let\Ssref@ba=\sref@ba
   \global\let\Slastto@ba=\lastto@ba
   \global\let\Slastti@ba=\lastti@ba
   \global\let\Slastp@ba=\lastp@ba
   \global\let\Slastvol@ba=\lastvol@ba
   \global\let\Slasts@ba=\lasts@ba
   \global\let\Slastn@ba=\lastn@ba
   \global\let\Spfilled@ba=\pfilled@ba
   \global\let\Svolfilled@ba=\pevofilled@ba
   }

\def\restoremem@ba{%
   \global\let\tmemo@ba=\Stmemo@ba    \global\let\Stmemo@ba\relax
   \global\let\tmemi@ba=\Stmemi@ba    \global\let\Stmemi@ba\relax
   \global\let\tref@ba=\Stref@ba      \global\let\Stref@ba\relax
   \global\let\nmem@ba=\Snmem@ba      \global\let\Snmem@ba\relax
   \global\let\nref@ba=\Snref@ba      \global\let\Snref@ba\relax
   \global\let\pmem@ba=\Spmem@ba      \global\let\Spmem@ba\relax
   \global\let\pref@ba=\Spref@ba      \global\let\Spref@ba\relax
   \global\let\volmem@ba=\Svolmem@ba  \global\let\Svolmem@ba\relax
   \global\let\volref@ba=\Svolref@ba  \global\let\Svolref@ba\relax
   \global\let\smem@ba=\Ssmem@ba      \global\let\Ssmem@ba\relax
   \global\let\sref@ba=\Ssref@ba      \global\let\Ssref@ba\relax
   \global\let\lastto@ba=\Slastto@ba  \global\let\Slastto@ba\relax
   \global\let\lastti@ba=\Slastti@ba  \global\let\Slastti@ba\relax
   \global\let\lastp@ba=\Slastp@ba    \global\let\Slastp@ba\relax
   \global\let\lastvol@ba=\Slastvol@ba\global\let\Slastvol@ba\relax
   \global\let\lasts@ba=\Slasts@ba    \global\let\Slasts@ba\relax
   \global\let\lastn@ba=\Slastn@ba    \global\let\Slastn@ba\relax
   \global\let\pfilled@ba=\Spfilled@ba\global\let\Spfilled@ba\relax
   \global\let\pevofilled@ba=\Svolfilled@ba\global\let\Svolfilled@ba\relax
   }



\def\anon@ba{\nulskip@ba\setup@ba{\authoremph}{\cap@ba{anonymous}}}

\def\@printvname#1#2#3#4#5{{\upshape
     \let\@testa=-%
   \def\@testd{#1}%
   \def\@testb{#3}%
     \def\@testc{\male}%
      \ifx\@testd\@testc\def\@testd{}\fi
      \ifx\@testb\@testc\def\@testb{}\fi
     \def\@testc{\female}%
      \ifx\@testd\@testc\def\@testd{}\fi
      \ifx\@testb\@testc\def\@testb{}\fi
   \ifx\@testd\@leer\ifx\@testb\@leer\anon@ba\fi\fi
   \ifx\@testd\@leerz\ifx\@testb\@leer\anon@ba\fi\fi
   \ifx\@testd\@leer\ifx\@testb\@leerz\anon@ba\fi\fi
   \ifx\@testd\@leerz\ifx\@testb\@leerz\anon@ba\fi\fi
   \ifx\@testd\@leer\else\ifx\@testd\@leerz\else
      \ifnum #4=1%
         \ifx\@testb\@leer\setup@ba{\authoremph}{#1}\ifnum #5=1\finddot@ba{#1}\fi\else\ifx\@testb\@leerz\setup@ba{\authoremph}{#1}\ifnum #5=1\finddot@ba{#1}\fi\else\setup@ba{\authoremph}{#1}{#2}\fi\fi  %% no \underline{#1#2}
      \else\ifx\@testb\@leer{\ignorespaces #1\ba@textmode}\ifnum #5=1\finddot@ba{#1}\fi\else\ifx\@testb\@leerz{\ignorespaces #1\ba@textmode}\ifnum #5=1\finddot@ba{#1}\fi\else
         {\ignorespaces #1#2\ba@textmode}\fi\fi
      \fi
   \fi\fi
   \ifx\@testb\@leer\else\ifx\@testb\@leerz\else
      \ifnum #4=0\setup@ba{\authoremph}{#3}\ifnum #5=1\finddot@ba{#3}\fi\else{\ignorespaces #3\ba@textmode}\ifnum #5=1\finddot@ba{#3}\fi\fi
   \fi\fi
   \ifx\@testa+\@bahasdot\fi}}

\def\@printkname#1#2{{%
     \let\@testa=-%
   \def\@testd{#1}%
   \ifx\@testd\@leer\anon@ba\else
      \ifx\@testd\@leerz\anon@ba\else
         \setup@ba{\authoremph}{#1}\ifnum #2=1\finddot@ba{#1}\fi\fi\fi
   \ifx\@testa+\@bahasdot\fi}}


\newbox\testbox@ba

\def\@printlastarg#1#2{{%
  \setbox\testbox@ba=\hbox{#2{\ignorespaces #1\ba@textmode}}%
  \ifdim\ht\testbox@ba=0pt%
    \if@kxxba
      \gdef\bacorr{}%  %% no \if@printhint\else in 2.2 %%
    \fi
  \else
    {\if@kxxba\iflasthasdot@ba{\not@bakntsepcorr}{\prep@bakntsepcorr}\else
      \not@bakntsepcorr\fi\ntsep}{\unhbox\testbox@ba}%
    \if@kxxba
       \let\@testa=-\finddot@ba{#1}%
        \ifx\@testa+\@bahasdot\gdef\bacorr{}\fi
       \let\@testb+%
       \do@banohint{\let\@testb-}%
      \ifx\@testb+%
        \@bastrut
        \ifx\@testa-{\bacorr}\fi
        \makecorrcmd@ba{}{\bacorr}%
      \else
        \ifx\@testa-\makecorrcmd@ba{\kxxemph}{\bacorr}\else
           \gdef\bacorr{}\fi
      \fi
    \else
      \if@vxxbalist
        \init@bacorr{#1}{}{\bacorr}%
      \else
        \gdef\bacorr{}%
      \fi
    \fi
  \fi}}


\def\@printoptarg#1#2{{%
   \def\@testb{#2}%
   \setbox\testbox@ba=\hbox{\ignorespaces #1\ba@textmode}%
   \ifdim\ht\testbox@ba=0pt\else
      \ifx\@testb\@leer\@bastrut\ \else  %% space before *{...}  %%
         {#2}\fi\fi                      %% #2 is \nsep at \x... %%
   {\unhbox\testbox@ba}%
     \let\@testa=-\finddot@ba{#1}%
     \ifx\@testa+\@bahasdot\fi}}


\newif\ifreprint@ba\reprint@bafalse
\newif\if@baktit\@baktitfalse
\def\@nobaktit#1{\if@baktit\else \ifmem@baouter\else
   {\errorcontextlines=-1\@qqertypeout{...v#1}{(inner ...v#1-cmd)}%
   \errhelp{
   ^^JIf you use a ...v#1-cmd inside the last arg of a ...v..-cmd, it is necessary
   ^^Jto use \ktit{...} to mark a part of the inner title as short title, because,
   ^^Jon the v#1-list, I transform inner full titles into short titles. For that
   ^^Jlist, I've inserted `??' as inner short title. (In case of an inner \vli, or
   ^^J\vqu, the inner full title will also be printed separately on the v..-list.)^^J}%
   \errmessage@ba{Missing \string\ktit{...} or shadowed {\string\ktit{...}} in last arg}}\fi\fi}

\def\@initvprintonly#1#2#3#4#5#6#7#8{{%    %%  #1 == li, qu  %%  
  \resetcorr@ba
  {\@memfunctions\@outsavety\@hereRfunctions\@hereFfunctions\fillnref@ba{#4}}%
  \if@footnote\global\let\isibidem@ba=-\warn@baname{v#1}{#2}%
      \if@baouter\global\let\nmem@ba=\nref@ba\fi
  \fi
  %%%%
  \let\ifmem@baouter=\if@baouter 
                  \@baouterfalse
  \let\@firstherald=\if@heraldktit
                      \@heraldktitfalse
      \ifmem@baouter{\filltmemo@ba{}{}{}{}}\else{\filltmemi@ba{}{}{}{}}\fi
  \def\@testa{#6}%
  \def\execute@ktit{\@nobaktit{#1}}%
               \@baktitfalse
  \def\ktit##1{\@baktittrue
     \def\kurz{\kurz@ktit}%
     \ba@varlabel{#4}{#5}{##1}%
     \if@footnote
        {\@memfunctions\@outsavety\@hereRfunctions\@hereFfunctions
         \ifmem@baouter\filltmemo@ba{#1}{#4}{#5}{##1}\global\let\lastto@ba=+%
         \else         \filltmemi@ba{#1}{#4}{#5}{##1}\global\let\lastti@ba=+%
         \fi}%
     \fi
     \if@makektitk{\@initaddtok{#4}{#5}{##1}{#1}{{\nsep}{#8}{v}}{1}}\fi
     \ifreprint@ba \def\execute@ktit{{\@kxxbatrue\@kprintonly{#1}{#2}{#4}{#5}{##1}{#7}}}%
     \else         \def\execute@ktit{{\@firstherald\if@rheraldktit
        \cap@ba{announcektit}\@rootponly{#1}{#4}*{#5}{##1}{#7}%
             \do@banohint{{\bacorr}}\cap@ba{announcekend}\fi\fi}}%
     \fi ##1\ba@textmode}%
    \ifreprint@ba
       {\setbox\testbox@ba=\hbox{#6\relax
         \if@baktit \global\let\gargc@ba=\execute@ktit
         \else \gdef\gargc@ba{\@kxxbatrue\@kprintonly{#1}{#2}{#4}{#5}{\erri@ba}{#7}}%
            \type@bawarn{Missing inner \string\ktit; use `??' as short title}%
         \fi}%
        {\@hereRfunctions\gargc@ba}%   %% <-> \@rootponly %%
        \global\let\gargc@ba=\relax
       }%
    \else
       \ifx\@testa\@leer{\@vprintonly{#1}{#2}{#3}{#4}{#5}{}{#7}}\else
        \ifx\@testa\@leerz{\@vprintonly{#1}{#2}{#3}{#4}{#5}{}{#7}}\else
                            {\@vprintonly{#1}{#2}{#3}{#4}{#5}{#6\relax\execute@ktit}{#7}}\fi\fi
    \fi
 }\if@footnote \if@baouter\makethiso@ba\else\makethisi@ba\fi \fi}


\def\clearmem@ba{{\@footnotetrue\filltmemo@ba{}{}{}{}\filltmemi@ba{}{}{}{}%
   \fillpmem@ba{}{}\fillvolmem@ba{}\fillnmem@ba{}}}

\def\filltmemo@ba#1#2#3#4{\if@footnote
\global\edef\tmemo@ba{{#1}{#2}{#3}{#4}}\fi}
{\@footnotetrue\filltmemo@ba{}{}{}{}}

\def\filltmemi@ba#1#2#3#4{\if@footnote
\global\edef\tmemi@ba{{#1}{#2}{#3}{#4}}\fi}
{\@footnotetrue\filltmemi@ba{}{}{}{}}

\def\filltref@ba#1#2#3#4{\if@footnote
\global\edef\tref@ba{{#1}{#2}{#3}{#4}}\fi}
{\@footnotetrue\filltref@ba{}{}{}{}}

\def\fillnmem@ba#1{\if@footnote
\global\edef\nmem@ba{#1}\fi}
{\@footnotetrue\fillnmem@ba{}}

\def\fillnref@ba#1{\if@footnote
\global\edef\nref@ba{#1}\fi}
{\@footnotetrue\fillnref@ba{}}

\def\errmsg@bawarn#1#2#3{{\errorcontextlines=-1\type@bawarn{...#1-cmd}%
  \protec@scr{ \space\space\space [#2] overwrites `{\nref@ba}',}%
  \protec@scr{ \space\space\space but the foregoing #3.^^J^^J}}}

\def\wrimsg@bawarn#1{\ifwriwarn@ba{#1}\{{\nref@ba}\}\penalty\@m \ \fi}

\def\warn@baname#1#2{%
  %%%%
  \if@baouter
     \ifx\thisn@ba+\ifx\nmem@ba\nref@ba\else\global\let\thisn@ba=.\fi\fi
     \ifx\thisn@ba-\global\let\thisn@ba=+\fi
  \fi
  %%%%
  {\if@wnsn
   \def\@testa{#2}%
   \ifx\isibidem@ba-%
      \ifx\nmem@ba\nref@ba\ifx\lastn@ba+%
         \ifx\@testa\@leer
            \ifx\nmem@ba\@leer\else\ifx\nmem@ba\@leerz\else
               \ifwriwarn@ba{$\bullet$\penalty\@m \ }\fi
               \if@baouter \type@bawarn{...#1-cmd repeats (first) author's lastname}%
               \else       \type@bawarn{Inner ...#1-cmd repeats author's lastname}%
               \fi
               \protec@scr{ \space\space\space `{\nmem@ba}'. Change to `...#1[m,f,p]'??^^J}%
            \fi\fi
         \else
            \wrimsg@bawarn{\boldmath$\heartsuit$}%
         \fi
      \fi\fi
      \ifx\@testa\@leer\else
         \ifx\lastn@ba-%
            \wrimsg@bawarn{\boldmath$\nabla$}%
            \errmsg@bawarn{#1}{#2}{footnote contains no authors (or is missed)}\fi
         \ifx\lastn@ba+\ifx\nmem@ba\nref@ba\else
            \wrimsg@bawarn{$\spadesuit$}%
            \errmsg@bawarn{#1}{#2}{lastname is `{\nmem@ba}'}\fi\fi
         \ifx\lastn@ba.%
            \wrimsg@bawarn{$\clubsuit$}%
            \errmsg@bawarn{#1}{#2}{footnote contains different authors}\fi
      \fi
   \fi
  \fi}%
  %%%%
  \global\let\lastn@ba=+}

\def\fillpmem@ba#1#2{\if@footnote
\global\edef\pmem@ba{{#1}{#2}}\fi}
{\@footnotetrue\fillpmem@ba{}{}}

\def\fillpref@ba#1#2{\if@footnote
\global\edef\pref@ba{{#1}{#2}}\fi}
{\@footnotetrue\fillpref@ba{}{}}

\def\fillvolmem@ba#1{\if@footnote
\global\edef\volmem@ba{#1}\fi}
{\@footnotetrue\fillvolmem@ba{}}

\def\fillvolref@ba#1{\if@footnote
\global\edef\volref@ba{#1}\fi}
{\@footnotetrue\fillvolref@ba{}}

\def\fillsmem@ba#1{\if@footnote
\global\edef\smem@ba{#1}\fi}
{\@footnotetrue\fillsmem@ba{}}

\def\fillsref@ba#1{\if@footnote
\global\edef\sref@ba{#1}\fi}
{\@footnotetrue\fillsref@ba{}}


\def\@vprintonly#1#2#3#4#5#6#7{{%
   \@herefunctions
   \def\@testa{#2}%
   \ifx\@testa\@leer         \@printvname{#3}{\bastrut\ }{#4}{0}{1}%
                             \@printoptarg{#5}{#7}%
   \else\oletter@ba{v#1}{#2}{\@printoptarg{#5}{#7}}%
   \fi           %%  #1 == li, qu  %%
   \@printlastarg{#6}{}\@heraldktitfalse}}



\def\@initprinthint#1{\if@printhint
  {\setbox\testbox@ba=\hbox{\cap@ba{hinttov#1}}%
     \if@affixhints \nobreak\ \else \ \fi
   \ifdim\ht\testbox@ba=0pt{[]}\else
     \unhbox\testbox@ba\fi}\fi}
  %% \cap@ba{hinttovli} \cap@ba{hinttovqu} %%

\def\@initkprintonly#1#2#3#4#5#6{\if@ibidemize\else\clearmem@ba\fi
   \resetcorr@ba
   {\@memfunctions\@outsavety\@herefunctions\filltref@ba{#1}{#3}{#4}{#5}\fillnref@ba{#3}}%
   \makeibid@ba
   \if@footnote\warn@baname{k#1}{#2}\fi
   \ifx\isibidem@ba-{\@herefunctions\@kprintonly{#1}{#2}{#3}{#4}{#5}{#6}}%
   \else\ibidemname@ba
   \fi
   \makelast@ba}


\def\getoletter@ba#1{\let\next@ba=#1}

\def\oletter@ba#1#2#3{{%
   \def\oarga@ba{}%
   \let\oargb@ba=\strut
   \setbox\testbox@ba=\hbox{\expandafter\getoletter@ba #2\relax
   \ifx\next@ba m\getom@ba #2\fi
   \ifx\next@ba f\getof@ba #2\fi
   \ifx\next@ba p\getop@ba #2\fi
  \ifx\next@ba m\else \ifx\next@ba f\else \ifx\next@ba p\else
     \global\let\oarga@ba=\erri@ba
     \errorcontextlines=-1\@qqerrmsg{...#1}{Bad syntax IN your [#2]-Arg.}%
     \errmessage@ba{You only may use [m], [f], [p], [m{...}], [f{...}], OR [p{...}] there}\fi\fi\fi}%
     {\oarga@ba}\ifx\oargb@ba\strut{#3}\else{\oargb@ba}\fi
   \global\let\oarga@ba=\relax \global\let\oargb@ba=\relax}}
  
\def\setoa@ba#1{\global\def\oarga@ba{\setup@ba{\edibidemph}{\cap@ba{#1}}}}

\def\geto@ba#1#2{\setoa@ba{#1}%
  {\def\@testa{#2}%
   \ifx\@testa\@leer
    \global\def\oargb@ba{#2}%
   \else
    \global\def\oargb@ba{\@bastrut #2}%
   \fi}}

\def\getom@ba m{\@ifnextchar\bgroup{\geto@ba{idem}}{\setoa@ba{idem}}}
\def\getof@ba f{\@ifnextchar\bgroup{\geto@ba{eadem}}{\setoa@ba{eadem}}}
\def\getop@ba p{\@ifnextchar\bgroup{\geto@ba{iidem}}{\setoa@ba{iidem}}}


\def\@kprintonly#1#2#3#4#5#6{{%
   \makeXcorrcmd@ba{\kxxemph}{\bacorr}%
   \def\@testa{#2}%
   \ifx\@testa\@leer \@printkname{#3}{1}\@printoptarg{#4}{#6}%
   \else        \oletter@ba{k#1}{#2}{\@printoptarg{#4}{#6}}%
   \fi}%
   \@printlastarg{#5}{\kxxemph}%
   \if@allowconferize
      \ifba@varstring\ \ba@varref{#3}{#4}{#5}%
      \else \@initprinthint{#1}%
      \fi
   \else    \@initprinthint{#1}%    %%  #1 == li, qu  %%
   \fi}


\def\@rootponly#1#2*#3#4#5{{%
   \makeXcorrcmd@ba{\kxxemph}{\bacorr}%
   \@hereRfunctions
   \@printkname{#2}{1}%
   \@printoptarg{#3}{#5}%
   {\@kxxbatrue\@printlastarg{#4}{\kxxemph}}%
   \@initprinthint{#1}}}   %%  #1 == li, qu  %%


%%


\def\next@ba{}

\def\getk@bapg#1]{\@bapg{#1}\bk@bapg}
\def\getxk@bapg#1]{\@baxpg{#1}\bk@bapg}
\def\getkf@bapg#1){\@bafolio{#1}\bk@bapg}
\def\getxkf@bapg#1){\@baxfolio{#1}\bk@bapg}
\def\getvolno@ba#1|{\initprintpevo@ba{#1}{vol}\ak@bapg}
\def\getperno@ba#1_{\initprintpevo@ba{#1}{per}\ak@bapg}

\def\xk@bapg{\afterassignment\getxkch@bapg\let\next@ba= }
\def\getxkch@bapg{%
   \ifx\next@ba[\let\next@ba=\getxk@bapg
      \global\let\pfilled@ba=+%
   \else
      \ifx\next@ba(\let\next@ba=\getxkf@bapg
         \global\let\pfilled@ba=+%
   \fi\fi
   \pknext@ba}

\def\lessinfoerror@ba#1#2#3#4#5{\if@baouter{ \erri@ba}{\errorcontextlines-1%
   \@qqertypeout{#2}{Automatic IBIDEM-setting in footnote:}%
   \errhelp{
   ^^JThe BibArts command before has had a #1 as #2-number,
   ^^Jbut the command now has none. The titles are the same. I set IBIDEM,
   ^^Jbut did you mean the whole #5? Later, you may type `passim', 
   ^^Jor what you've forgotten, as #2-number. (Then, you may set your
   ^^Jwhole BibArts-\cmd in {#4\cmd...}).^^J}%
   \errmessage@ba{Same title, before with :#3:, has now no #1 number}}\else
   \type@bawarn{Check #1 after inner IBIDEM}\fi}

\def\do@banohint#1{\if@printhint\else\ifba@varstring\else #1\fi\fi}

\def\makeendcorr@ba{\ifx\isibidem@ba-%
  \ifx\next@ba,\else\ifx\next@ba.\else\ifx\next@ba\strut\else
    \ifx\next@ba[\else\ifx\next@ba(\else\ifx\next@ba*\else\ifx\next@ba|\else\ifx\next@ba_\else
       \if@kxxba\do@banohint{{\bacorr}}\fi
    \fi\fi\fi\fi\fi
  \fi\fi\fi
  \ifx\next@ba.%
    \ifdim\lastskip=\notdotcode@ba
      \if@kxxba\if@printhint\else{\bacorr}\@banotdot\fi\fi
    \fi
  \fi
  \fi
  \ifx\next@ba.\else
     \spacefactorM@ba
  \fi}

\let\pfilled@ba=-
\let\pevofilled@ba=-
\def\ak@bapg{\afterassignment\getakch@bapg\let\next@ba= }
\def\getakch@bapg{%
    \ifx\last@ba-\makeendcorr@ba\fi
    \global\let\last@ba=+%
    \ifx\lockpevo@ba-\ifx\next@ba|\else\ifx\next@ba_\else
      \if@pfvba
       \ifx\isibidem@ba+\ifx\pevofilled@ba+%
       \ifx\volref@ba\@leer\else\lessinfoerror@ba{no./vol}{_n_- or |n|}{{pervol}{\volref@ba}}{\notprintlongpervol}{series}\fi
       \fi\fi
       \fillvolmem@ba{}%
       \global\let\pevofilled@ba=-%
      \fi
    \fi\fi\fi
   \ifx\next@ba[%
      \let\next@ba=\getk@bapg \if@pfvba\global\let\pfilled@ba=+\fi
   \else\ifx\next@ba(%
      \let\next@ba=\getkf@bapg \if@pfvba\global\let\pfilled@ba=+\fi
   \else\ifx\next@ba*%
      \let\next@ba=\xk@bapg
   \else\ifx\next@ba|%
       \ifx\lockpevo@ba-\if@pfvba\global\let\lockpevo@ba=+\fi
         \let\next@ba=\getvolno@ba \if@pfvba\global\let\onlypevo@ba=+\fi
       \fi \if@pfvba\global\let\pevofilled@ba=+\fi
   \else\ifx\next@ba_%
       \ifx\lockpevo@ba-\if@pfvba\global\let\lockpevo@ba=+\fi
         \let\next@ba=\getperno@ba \if@pfvba\global\let\onlypevo@ba=+\fi
       \fi \if@pfvba\global\let\pevofilled@ba=+\fi
   \else
    \if@pfvba
     \ifx\isibidem@ba+\ifx\pfilled@ba+%
        \lessinfoerror@ba{page/folio}{[n]- or (n)}{\pref@ba}{\notprintlongpagefolio}{document}%
         \ifx\lockpevo@ba-%
           \fillvolmem@ba{}%
           \global\let\pevofilled@ba=-%
         \fi
     \fi\fi
     \fillpmem@ba{}{}%
     \global\let\pfilled@ba=-%
     \ifx\next@ba.%
        \ifx\isibidem@ba+%
           \ifx\onlypevo@ba-%
              \if@ibidhp\let\next@ba=\relax\spacefactorMMM@ba\fi
           \fi
        \fi
     \else
       \spacefactorM@ba \@bastrut
     \fi
   \fi\fi\fi\fi\fi\fi
   \pknext@ba}  %% ||__ %%

\def\bk@bapg{\afterassignment\getbkch@bapg\let\next@ba= }
\def\getbkch@bapg{%
   \ifx\next@ba.\if@ibidhp
         \ifx\lookpage@ba+\let\next@ba=\relax\spacefactorMMM@ba\fi
   \fi \else \spacefactorM@ba
    \if@balist\else\@bastrut\fi
   \fi
   \pknext@ba}  %% []()*[]*() %%

\def\pknext@ba{%
   \if@pfvba
      \ifx.\next@ba
         \iflasthasdot@ba{\strut\let\next@ba\relax}{}%
         \iflastnotdot@ba{\strut\let\next@ba\relax}{}%
         \spacefactorMMM@ba
      \fi
   \else \if@filesw \if@nobreak\ifvmode\nobreak\fi\fi \fi
      \if@unusedbib\ignorespaces\else\@esphack\fi
   \fi
   \next@ba}

\def\pkcheck@ba{%
   \global\let\last@ba=-%
   \global\let\onlypevo@ba=-%
   \global\let\lockpevo@ba=-%
   \if@unusedbib\@pfvbafalse\fi
   \ak@bapg}
\def\pvcheck@ba{%
   \global\let\isibidem@ba=-%
   \global\let\lookpage@ba=-%
   \pkcheck@ba}


%%


\def\checkNvrun@AbcDe#1{\@kxxbafalse\@perbafalse\@ifnextchar[{\Check@LocalvArg{#1}}{\Check@LocalvArg{#1}[]}}

\def\Check@LocalvArg#1[#2]{\@ifnextchar\bgroup{\Check@ObligatoryvArgA{#1}[#2]}%
   {\Check@ObligatoryvArgA{#1}[#2]{\erri@ba}}}

\def\Check@ObligatoryvArgA#1[#2]#3{\@ifnextchar\bgroup{\Check@ObligatoryvArgB{#1}[#2]{#3}}%
   {{\errorcontextlines=-1\@qqerrhlp{#1}%
     \Check@ObligatoryvArgB{#1}[#2]{#3}{\erri@ba}%
     \errmessage@ba{#1 - CONTINUE - : \space Missing author's \ifx\erri@ba #3firstname(s) and \fi lastname as \ifx\erri@ba #3{a1}\fi{a2}}}}}

\def\Check@ObligatoryvArgB#1[#2]#3#4{\@ifnextchar *{\Check@OptionalvStar{#1}[#2]{#3}{#4}}%
   {\Check@OptionalvArg{#1}[#2]{#3}{#4}*{}}}

\def\Check@OptionalvStar#1[#2]#3#4*{\@ifnextchar\bgroup{\Check@OptionalvArg{#1}[#2]{#3}{#4}*}%
   {\Check@OptionalvArg{#1}[#2]{#3}{#4}*{\erri@ba}}}
 
\def\Check@OptionalvArg#1[#2]#3#4*#5{\@ifnextchar\bgroup{\Check@ObligatoryLastvArg{#1}[#2]{#3}{#4}*{#5}}%
   {{\errorcontextlines=-1\@qqerrmsg{#1}{Registered lastname (a2): {#4}}%
     \Check@ObligatoryLastvArg{#1}[#2]{#3}{#4}*{#5}{\erri@ba}%
     \errmessage@ba{#1: \space Missing OBLIGATORY Arg3 (LastArg). \space You may choose,
                 ^^J \space when you fix the problem later: \space Type a full-cited title as {a3},
                 ^^J \space OR set `*'-option, and type supplements and a full title as *{op}{a3}}}}}

\def\Check@ObligatoryLastvArg#1[#2]#3#4*#5#6{\csname @#1\endcsname[#2]{#3}{#4}*{#5}{#6\@leer}\pvcheck@ba}




\def\checkNkrun@AbCd#1{\@kxxbatrue\@perbafalse\@ifnextchar[{\Check@LocalkArg{#1}}{\Check@LocalkArg{#1}[]}}

\def\Check@LocalkArg#1[#2]{\@ifnextchar\bgroup{\Check@ObligatorykArgA{#1}[#2]}%
   {{\errorcontextlines=-1\@qqerrhlp{#1}%
     \Check@ObligatorykArgA{#1}[#2]{\erri@ba}%
     \errmessage@ba{#1 - CONTINUE - :
                 ^^J \space Missing even author's lastname as {a1}}}}}

\def\Check@ObligatorykArgA#1[#2]#3{\@ifnextchar *{\Check@OptionalkStar{#1}[#2]{#3}}%
   {\Check@OptionalkArg{#1}[#2]{#3}*{}}}

\def\Check@OptionalkStar#1[#2]#3*{\@ifnextchar\bgroup{\Check@OptionalkArg{#1}[#2]{#3}*}%
   {\Check@OptionalkArg{#1}[#2]{#3}*{\erri@ba}}}

\def\Check@OptionalkArg#1[#2]#3*#4{\@ifnextchar\bgroup{\Check@ObligatoryLastkArg{#1}[#2]{#3}*{#4}}%
   {{\errorcontextlines=-1\@qqerrmsg{#1}{Registered lastname (a1): {#3}}%
     \Check@ObligatoryLastkArg{#1}[#2]{#3}*{#4}{\erri@ba}%
     \errmessage@ba{#1: \space Missing OBLIGATORY Arg2 (LastArg). \space You may choose,
                 ^^J \space when you fix the problem later: \space Type a short-cited title as {a2},
                 ^^J \space OR set `*'-option, and type supplements and a short title as *{op}{a2}}}}}

\def\Check@ObligatoryLastkArg#1[#2]#3*#4#5{\csname @#1\endcsname[#2]{#3}*{#4}{#5}\pkcheck@ba}


%%


\def\type@bawarn#1{\typeout@ba{ \space BibArts Warning: #1 on input line \line@ba.}}

\def\protec@scr#1{{\@outsavety\@memfunctions\message{#1}}}

\def\@qqertypeout#1#2{%
   \typeout@ba{^^J \space ** Arg(s) of BibArts' #1-command: Error around line \line@ba!}%
   \protec@scr{    \space\space\space\space #2}%
   \typeout@ba{    \space <H><return> \space for immediate help,
               ^^J \space <return> \space\space\space\space to continue.}}

\def\command@misplace#1{\type@bawarn{\string#1\space was ignored:
   ^^J\space\space\space\space You've used it outside the args of ....li, ....qu, ...per, or ...arq}}

\def\@qqerrhlp#1{\errhelp{%
   ^^JTeX reports errors by SETTING UP in quoting your text - AFTER the error.
   ^^JIn case of footnotes, TeX reports only the end of the last footnote-line.
   ^^JIf TeX quotes nothing HERE, you've forgotten to type an/some argument(s).^^J
   ^^J...v..-commands have syntax ...v..{a1}{a2}{a3} , or ...v..{a1}{a2}*{op}{a3}
   ^^J...k..-commands have syntax ...k..{a1}{a2} , or ...k..{a1}*{op}{a2}
   ^^J -- you may use an op-Arg as [m,f,p] after ...v..- or ...k...commands --
   ^^J...per-commands have syntax ...per {periodical revue name}
   ^^J...arq-commands have syntax ...arq {source-doc} {archive-abbrev./shelfmark}^^J
   ^^JAdd numbers as |volume| and/or [page] or (folio) immediate after the last arg.^^J
   ^^JI've inserted arg(s) for that/those you probably have forgotten to type
   ^^Jbehind your #1-command. I put `??' into that/those arg(s).
   ^^JThat should fix the problem for the moment. <return> to continue.^^J}}

\def\@fqerrhlp#1{\errhelp{%
   ^^JCommands \addtogrr, \addtosrr, and \addtoprr have ONE {arg} . Their
   ^^Jfill...-commands have syntax e.g. \fillgrr{arg} {additional text to arg} ;
   ^^Jand \per{arg} could also be filled in the list with \fillper{arg} {add} :
   ^^J{arg} always should be identical to the ONE {arg} of the base command.
   ^^JAbbreviation definitions are ...abkdef{arg}{def} and ...defabk{def}{arg}
   ^^Jto write out \abk{a.b.c.} ; no fill-commands exist for abbreviations.
   ^^JIn case of \arq{document/paper} {archive/shelfmark} , only the second arg
   ^^Jgoes to the list - where \arqsection{s1} {s2} could create a heading:
   ^^Js1 should BEGIN with the same characters as does {archive/shelfmark},
   ^^Jbut s1 should have NOT ALL the characters of {archive/shelfmark}
   ^^J(e.g. \arq{X to Y} {PRO~1} and \arqsection{PRO} {Public Record Office} ).
   ^^J\fillarq{PRO~1} {Name of the file} could FILL the second arg of \arq.^^J
   ^^JI've inserted default-arg(s) for that/those you probably have forgotten
   ^^Jto type behind your #1-command. You have to fix that problem later.
   ^^J<return> to continue.^^J}}

\def\@qqerrmsg#1#2{\@qqerrhlp{#1}\@qqertypeout{#1}{#2}}
\def\@fqerrmsg#1{\@fqerrhlp{#1}\@qqertypeout{#1}{...}}


%%


                 %% full citations (v-cmds) %%


\def\shadowv{\@bsphack\@pfvbafalse\checkNvrun@AbcDe{shadowv}}  %% ... \@shadowv


\DeclareRobustCommand\vli{\dofrco@ba\@pfvbatrue\leavevmode\checkNvrun@AbcDe{vli}}  %% ... \@vli

\DeclareRobustCommand\vqu{\dofrco@ba\@pfvbatrue\leavevmode\checkNvrun@AbcDe{vqu}}  %% ... \@vqu


\DeclareRobustCommand\printonlyvli{\dofrco@ba\@pfvbatrue\checkNvrun@AbcDe{printonlyvli}}  %% ... \@printonlyvli

\DeclareRobustCommand\printonlyvqu{\dofrco@ba\@pfvbatrue\checkNvrun@AbcDe{printonlyvqu}}  %% ... \@printonlyvqu


\DeclareRobustCommand\addtovli{\@bsphack\@pfvbafalse\checkNvrun@AbcDe{addtovli}}  %% ... \@addtovli

\DeclareRobustCommand\addtovqu{\@bsphack\@pfvbafalse\checkNvrun@AbcDe{addtovqu}}  %% ... \@addtovqu



\DeclareRobustCommand\xvli{\dofrco@ba\@pfvbatrue\leavevmode\checkNvrun@AbcDe{xvli}}  %% ... \@xvli

\DeclareRobustCommand\xvqu{\dofrco@ba\@pfvbatrue\leavevmode\checkNvrun@AbcDe{xvqu}}  %% ... \@xvqu


\DeclareRobustCommand\xprintonlyvli{\dofrco@ba\@pfvbatrue\checkNvrun@AbcDe{xprintonlyvli}}  %% ... \@xprintonlyvli

\DeclareRobustCommand\xprintonlyvqu{\dofrco@ba\@pfvbatrue\checkNvrun@AbcDe{xprintonlyvqu}}  %% ... \@xprintonlyvqu


\DeclareRobustCommand\xaddtovli{\@bsphack\@pfvbafalse\checkNvrun@AbcDe{xaddtovli}}  %% ... \@xaddtovli

\DeclareRobustCommand\xaddtovqu{\@bsphack\@pfvbafalse\checkNvrun@AbcDe{xaddtovqu}}  %% ... \@xaddtovqu




                           %% Internal %%


\def\@shadowv[#1]#2#3*#4#5{}


\def\@vli[#1]#2#3*#4#5{\@addtovli[]{#2}{#3}*{#4}{#5}\@printonlyvli[#1]{#2}{#3}*{#4}{#5}}

\def\@vqu[#1]#2#3*#4#5{\@addtovqu[]{#2}{#3}*{#4}{#5}\@printonlyvqu[#1]{#2}{#3}*{#4}{#5}}


\def\@xvli[#1]#2#3*#4#5{\@xaddtovli[]{#2}{#3}*{#4}{#5}\@xprintonlyvli[#1]{#2}{#3}*{#4}{#5}}

\def\@xvqu[#1]#2#3*#4#5{\@xaddtovqu[]{#2}{#3}*{#4}{#5}\@xprintonlyvqu[#1]{#2}{#3}*{#4}{#5}}


\def\@printonlyvli[#1]#2#3*#4#5{\@initvprintonly{li}{#1}{#2}{#3}{#4}{#5}{}{false}}

\def\@printonlyvqu[#1]#2#3*#4#5{\@initvprintonly{qu}{#1}{#2}{#3}{#4}{#5}{}{false}}


\def\@xprintonlyvli[#1]#2#3*#4#5{\@initvprintonly{li}{#1}{#2}{#3}{#4}{#5}{\nsep}{true}}

\def\@xprintonlyvqu[#1]#2#3*#4#5{\@initvprintonly{qu}{#1}{#2}{#3}{#4}{#5}{\nsep}{true}}


\def\@addtovli[#1]#2#3*#4#5{\@initaddtovli{#2}{#3}{#4}{#5}{{\nsep}{false}}}

\def\@addtovqu[#1]#2#3*#4#5{\@initaddtovqu{#2}{#3}{#4}{#5}{{\nsep}{false}}}


\def\@xaddtovli[#1]#2#3*#4#5{\@initaddtovli{#2}{#3}{#4}{#5}{{\nsep}{true}}}

\def\@xaddtovqu[#1]#2#3*#4#5{\@initaddtovqu{#2}{#3}{#4}{#5}{{\nsep}{true}}}


\def\@initaddtovli#1#2#3#4#5{\if@filesw {\let\thepage\relax
   \@outsavety\@outfunctions
   \edef\@tempa{\write\@auxout{\commentch@ba\string
   \literentry{#2}{#1}{#3}{#4}{#5{}}{\setn@ba}[\catq@ba][\lang@ba](line \line@ba)}}%
   \expandafter}\@tempa \fi}

\def\@initaddtovqu#1#2#3#4#5{\if@filesw {\let\thepage\relax
   \@outsavety\@outfunctions
   \edef\@tempa{\write\@auxout{\commentch@ba\string
   \quellentry{#2}{#1}{#3}{#4}{#5{}}{\setn@ba}[\catq@ba][\lang@ba](line \line@ba)}}%
   \expandafter}\@tempa \fi}


\def\literentry#1#2#3#4#5#6[#7][#8](#9){}

\def\quellentry#1#2#3#4#5#6[#7][#8](#9){}


%%


                      %% shortened citations %%


\def\shadowk{\@bsphack\@pfvbafalse\checkNkrun@AbCd{shadowk}}  %% ... \@shadowk


\DeclareRobustCommand\kli{\dofrco@ba\@pfvbatrue\leavevmode\checkNkrun@AbCd{kli}}  %% ... \@kli

\DeclareRobustCommand\kqu{\dofrco@ba\@pfvbatrue\leavevmode\checkNkrun@AbCd{kqu}}  %% ... \@kqu


\DeclareRobustCommand\printonlykli{\dofrco@ba\@pfvbatrue\checkNkrun@AbCd{printonlykli}}  %% ... \@printonlykli

\DeclareRobustCommand\printonlykqu{\dofrco@ba\@pfvbatrue\checkNkrun@AbCd{printonlykqu}}  %% ... \@printonlykqu


\DeclareRobustCommand\addtokli{\@bsphack\@pfvbafalse\checkNkrun@AbCd{addtokli}}  %% ... \@addtokli

\DeclareRobustCommand\addtokqu{\@bsphack\@pfvbafalse\checkNkrun@AbCd{addtokqu}}  %% ... \@addtokqu



\DeclareRobustCommand\xkli{\dofrco@ba\@pfvbatrue\leavevmode\checkNkrun@AbCd{xkli}}  %% ... \@xkli

\DeclareRobustCommand\xkqu{\dofrco@ba\@pfvbatrue\leavevmode\checkNkrun@AbCd{xkqu}}  %% ... \@xkqu


\DeclareRobustCommand\xprintonlykli{\dofrco@ba\@pfvbatrue\checkNkrun@AbCd{xprintonlykli}}  %% ... \@xprintonlykli

\DeclareRobustCommand\xprintonlykqu{\dofrco@ba\@pfvbatrue\checkNkrun@AbCd{xprintonlykqu}}  %% ... \@xprintonlykqu


\DeclareRobustCommand\xaddtokli{\@bsphack\@pfvbafalse\checkNkrun@AbCd{xaddtokli}}  %% ... \@xaddtokli

\DeclareRobustCommand\xaddtokqu{\@bsphack\@pfvbafalse\checkNkrun@AbCd{xaddtokqu}}  %% ... \@xaddtokqu




                           %% Internal %%


\def\@shadowk[#1]#2*#3#4{}


\def\@kli[#1]#2*#3#4{\@addtokli[]{#2}*{#3}{#4}\@printonlykli[#1]{#2}*{#3}{#4}}

\def\@kqu[#1]#2*#3#4{\@addtokqu[]{#2}*{#3}{#4}\@printonlykqu[#1]{#2}*{#3}{#4}}


\def\@xkli[#1]#2*#3#4{\@xaddtokli[]{#2}*{#3}{#4}\@xprintonlykli[#1]{#2}*{#3}{#4}}

\def\@xkqu[#1]#2*#3#4{\@xaddtokqu[]{#2}*{#3}{#4}\@xprintonlykqu[#1]{#2}*{#3}{#4}}


\def\@printonlykli[#1]#2*#3#4{\@initkprintonly{li}{#1}{#2}{#3}{#4}{}}

\def\@printonlykqu[#1]#2*#3#4{\@initkprintonly{qu}{#1}{#2}{#3}{#4}{}}


\def\@xprintonlykli[#1]#2*#3#4{\@initkprintonly{li}{#1}{#2}{#3}{#4}{\nsep}}

\def\@xprintonlykqu[#1]#2*#3#4{\@initkprintonly{qu}{#1}{#2}{#3}{#4}{\nsep}}


\def\@addtokli[#1]#2*#3#4{\@initaddtok{#2}{#3}{#4}{li}{{\nsep}{false}{k}}{0}}

\def\@addtokqu[#1]#2*#3#4{\@initaddtok{#2}{#3}{#4}{qu}{{\nsep}{false}{k}}{0}}


\def\@xaddtokli[#1]#2*#3#4{\@initaddtok{#2}{#3}{#4}{li}{{\nsep}{true}{k}}{0}}

\def\@xaddtokqu[#1]#2*#3#4{\@initaddtok{#2}{#3}{#4}{qu}{{\nsep}{true}{k}}{0}}


\def\@initaddtok#1#2#3#4#5#6{\if@filesw {\let\thepage\relax
   \@outsavety\@outfunctions \ifnum#6=1\@hereFfunctions\fi
   \edef\@tempa{\write\@auxout{\commentch@ba\string
   \vkcitentry{#1}{#2}{#3}{#4}{#5}{\setn@ba}[\catq@ba][\lang@ba](line \line@ba)}}%
   \expandafter}\@tempa \fi}


\def\vkcitentry#1#2#3#4#5#6[#7][#8](#9){}

%%


                 %% periodicals and archive sources %%


\def\checkNonerun@a#1{\@kxxbafalse\@perbatrue\@ifnextchar\bgroup{\Check@perArg{#1}}{%
   {\errorcontextlines=-1\@qqerrmsg{#1}{...}%
   \Check@perArg{#1}{\erri@ba}%
   \errmessage@ba{#1: Missing Arg (periodical revue name)}}}}

\def\Check@perArg#1#2{\csname @#1\endcsname{#2}\pkcheck@ba}


\def\checkNtworun@ab#1{\@kxxbafalse\@perbafalse\@ifnextchar[{\Check@LocalarqArg{#1}}{\Check@LocalarqArg{#1}[]}}

\def\Check@LocalarqArg#1[#2]{\@ifnextchar\bgroup{\Check@arqArga{#1}[#2]}{%
   {\Check@arqArga{#1}[#2]{\erri@ba}}}}

\def\Check@arqArga#1[#2]#3{\@ifnextchar\bgroup{\Check@arqArgb{#1}[#2]{#3}}{%
   {\errorcontextlines=-1\@qqerrmsg{#1}{Registered doc (a1): {#3}}%
   \Check@arqArgb{#1}[#2]{#3}{\erri@ba}%
   \errmessage@ba{#1: Missing second Arg (archive abbrev./shelfmark [title])}}}}

\def\Check@arqArgb#1[#2]#3#4{\csname @#1\endcsname[#2]{#3}{#4}\pkcheck@ba}


\def\checkNrun@one#1{\@ifnextchar\bgroup{\Check@oneArg{#1}}{%
   {\errorcontextlines=-1\@fqerrmsg{#1}%
    \Check@oneArg{#1}{}\errmessage@ba{#1: \space Missing Arg}}}}

\def\Check@oneArg#1#2{\csname @#1\endcsname{#2}}


\def\checkNrun@two#1{\@ifnextchar\bgroup{\Check@FirstOfTwoArgs{#1}}{%
   {\Check@FirstOfTwoArgs{#1}{}}}}

\def\Check@FirstOfTwoArgs#1#2{\@ifnextchar\bgroup{\Check@SecondOfTwoArgs{#1}{#2}}{%
   {\errorcontextlines=-1\@fqerrmsg{#1}%
    \Check@SecondOfTwoArgs{#1}{#2}{\erri@ba}{\@outsavety\@memfunctions\errmessage@ba{#1: \space Missing 2nd Arg (after `#2')}}}}}

\def\Check@SecondOfTwoArgs#1#2#3{\csname @#1\endcsname{#2}{#3}}


\def\shadowone{\checkNrun@one{shadowone}} %% \@shadowone %%
\def\shadowtwo{\checkNrun@two{shadowtwo}} %% \@shadowtwo %%

\def\shadowo{\@bsphack\@pfvbafalse\checkNonerun@a{shadowo}}  %% \@shadowo
\def\shadowt{\@bsphack\@pfvbafalse\checkNtworun@ab{shadowt}}  %% \@shadowt

\DeclareRobustCommand\per{\dofrco@ba\@pfvbatrue\leavevmode\checkNonerun@a{per}}  %% \@per
\DeclareRobustCommand\arq{\dofrco@ba\@pfvbatrue\leavevmode\checkNtworun@ab{arq}}  %% \@arq

\DeclareRobustCommand\printonlyper{\dofrco@ba\@pfvbatrue\checkNonerun@a{printonlyper}}  %% \@printonlyper
\DeclareRobustCommand\printonlyarq{\dofrco@ba\@pfvbatrue\checkNtworun@ab{printonlyarq}}  %% \@printonlyarq

\DeclareRobustCommand\addtoper{\@bsphack\@pfvbafalse\checkNonerun@a{addtoper}}  %% \@addtoper
\DeclareRobustCommand\addtoarq{\@bsphack\@pfvbafalse\checkNtworun@ab{addtoarq}}  %% \@addtoarq


                           %% Internal %%

\def\@shadowo#1{}
\def\@shadowt[#1]#2#3{}

\def\@shadowone#1{\@bsphack\if@unusedbib\ignorespaces\else\@esphack\fi}
\def\@shadowtwo#1#2{\@bsphack\if@unusedbib\ignorespaces\else\@esphack\fi}

\def\@per#1{\@addtoper{#1}\@printonlyper{#1}}
\def\@arq[#1]#2#3{\@initaddtoarq[\ifx#1\@leer\else\lbrack #1\rbrack\space\space\fi]{#2}{#3}\@printonlyarq[#1]{#2}{#3}}

\def\@printonlyper#1{\if@ibidemize\else\clearmem@ba\fi
   \resetcorr@ba
   {\@memfunctions\@outsavety\@herefunctions\filltref@ba{per}{#1}{}{}\fillnref@ba{}}%
   \makeibid@ba
   \nulskip@ba
   \ifx\isibidem@ba-{\@herefunctions\setup@ba{\peremph}{#1}}%
     \let\@testa=-\finddot@ba{#1}%
     \ifx\@testa+\@bahasdot\fi
   \else
     \ibidemname@ba
   \fi
   \makelast@ba}

\def\@printonlyarq[#1]#2#3{\if@ibidemize\else\clearmem@ba\fi
   \resetcorr@ba
   {\@memfunctions\@outsavety\@herefunctions\filltref@ba{arq}{#3}{}{}\fillnref@ba{}}%
   \makeibid@ba
   \nulskip@ba
   \initprints@ba{#1}{#2}%
   \ifx\isibidem@ba-{\@herefunctions\setup@ba{\arqemph}{#3}}%
     \let\@testa=-\finddot@ba{#3}%
     \ifx\@testa+\@bahasdot\fi
   \else
     \ibidemname@ba
   \fi
   \makelast@ba}

\def\@addtoper#1{\if@filesw {\let\thepage\relax
   \@outsavety\@outfunctions
   \edef\@tempa{\write\@auxout{\commentch@ba\string
   \perioentry{#1}{}{{}{}{}{}}{\setn@ba}[\catq@ba][\lang@ba](line \line@ba)}}%
   \expandafter}\@tempa \fi}

\DeclareRobustCommand\fillper{\checkNrun@two{fillper}}
\def\@fillper#1#2{\@bsphack \if@filesw {\let\thepage\relax
   \@outsavety\@outfunctions
   \edef\@tempa{\write\@auxout{\commentch@ba\string
   \perioentry{#1}{#2}{{\perlistopen}{\perlistclose}{}{}}{{}{}{-}}[\catq@ba][\lang@ba](line \line@ba)}}%
   \expandafter}\@tempa \fi
   \if@unusedbib\ignorespaces\else\@esphack\fi}

\def\@addtoarq[#1]#2#3{\@initaddtoarq[]{#2}{#3}}

\def\@initaddtoarq[#1]#2#3{\if@filesw {\let\thepage\relax
   \@outsavety\@outfunctions
   \edef\@tempa{\write\@auxout{\commentch@ba\string
   \archqentry{#3}{}{{}{}{}{}}{\setn@ba}[\catq@ba][\lang@ba](line \line@ba)    
    \space\commentch@ba\commentch@ba \space
    \if@unusedbib (u) \space \else \if@footnote\if@baminipage (mpf) \else (f) \fi \space \fi\fi
    #1#2 \commentch@ba\commentch@ba}}%
   \expandafter}\@tempa \fi}

\DeclareRobustCommand\fillarq{\checkNrun@two{fillarq}}
\def\@fillarq#1#2{\@bsphack \if@filesw {\let\thepage\relax
   \@outsavety\@outfunctions
   \edef\@tempa{\write\@auxout{\commentch@ba\string
   \archqentry{#1}{#2}{{\arqlistopen}{\arqlistclose}{}{}}{{}{}{-}}[\catq@ba][\lang@ba](line \line@ba)}}%
   \expandafter}\@tempa \fi
   \if@unusedbib\ignorespaces\else\@esphack\fi}

\DeclareRobustCommand\arqsection{\checkNrun@aBC{arqsection}}
\DeclareRobustCommand\arqsubsection{\checkNrun@aBC{arqsubsection}}
\DeclareRobustCommand\arqsubsubsection{\checkNrun@aBC{arqsubsubsection}}

\def\checkNrun@aBC#1{\@ifnextchar[{\Check@optionOfarqsec{#1}}%
   {\Check@optionOfarqsec{#1}[]}}

\def\Check@optionOfarqsec#1[#2]{\@ifnextchar\bgroup{\Check@FirstOfarqsec{#1}[#2]}{%
   {\Check@FirstOfarqsec{#1}[#2]{}}}}

\def\Check@FirstOfarqsec#1[#2]#3{\@ifnextchar\bgroup{\Check@SecondOfarqsec{#1}[#2]{#3}}{%
   {\errorcontextlines=-1\@fqerrmsg{#1}%
    \Check@SecondOfarqsec{#1}[#2]{#3}{\erri@ba}{\@outsavety\@memfunctions\errmessage@ba{#1: \space Missing 2nd Arg}}}}}

\def\Check@SecondOfarqsec#1[#2]#3#4{\csname @#1\endcsname{#2}{#3}{#4}}


\def\@arqsection#1#2#3{\@arqcontent{#2}{#3}{\arqsectionopen}{\arqsectionclose}{1}{#1}}
\def\@arqsubsection#1#2#3{\@arqcontent{#2}{#3}{\arqsubsectionopen}{\arqsubsectionclose}{2}{#1}}
\def\@arqsubsubsection#1#2#3{\@arqcontent{#2}{#3}{\arqsubsubsectionopen}{\arqsubsubsectionclose}{3}{#1}}
\def\@arqcontent#1#2#3#4#5#6{\@bsphack \if@filesw {\let\thepage\relax
   \@outsavety\@outfunctions
   \edef\@tempa{\write\@auxout{\commentch@ba\string
   \archqentry{#1}{#2}{{#3}{#4}{#5}{#6}}{{}{}{-}}[\catq@ba][\lang@ba](line \line@ba)}}%
   \expandafter}\@tempa \fi
   \if@unusedbib\ignorespaces\else\@esphack\fi}


\def\perioentry#1#2#3#4[#5][#6](#7){}
\def\archqentry#1#2#3#4[#5][#6](#7){}


%%


                          %% abbreviations %%

\def\abkemph{\sffamily}
\def\dofrco@baabk{\ba@textmode
   \if@bafrontcorr{\abkemph{\ifdim\fontdimen\@ne\font=\z@\dofrco@ba@abk\fi}}\fi}

\def\next@printabk{\afterassignment\@makeendabk\let\next@ba= }
\def\@makeendabk{\ifx\next@ba,%
  \else\ifx\next@ba.%
    \iflasthasdot@ba{\strut\let\next@ba\relax}{}%
    \iflastnotdot@ba{\strut\let\next@ba\relax\bacorr}{}%
    \spacefactorMMM@ba
  \else\ifx\next@ba\strut
    \nulskip@ba\strut\let\next@ba\relax
  \else\nulskip@ba\strut\bacorr\fi\fi\fi
  \next@ba}
\def\@abk#1{\@initaddtoabk{#1}\@printonlyabk{#1}%
   \let\@testa=-\finddot@ba{#1}%
   \ifx\@testa+\@bahasdot\fi
   \next@printabk}
\DeclareRobustCommand\abk{\dofrco@baabk\leavevmode\resetcorr@ba\checkNrun@one{abk}} %% \@abk %%

\def\@printonlyabk#1{{\@herefunctions\printfirstarg@ba{\abkemph}{#1}{abk...}}%
  \init@baXcorr{#1}{\abkemph}{\bacorr}}

\def\@cprintonlyabk#1{\@printonlyabk{#1}%
   \let\@testa=-\finddot@ba{#1}%
   \ifx\@testa+\@bahasdot\fi
   \next@printabk}
\DeclareRobustCommand\printonlyabk{\dofrco@baabk\resetcorr@ba\checkNrun@one{cprintonlyabk}} %% \@cprintonlyabk %%

\def\@addtoabk#1{\@initaddtoabk{#1}}
\DeclareRobustCommand\addtoabk{\checkNrun@one{addtoabk}} %% \@addtoabk %%

\def\@abkdef#1#2{\@initabkdef{#1}{#2}\@printonlyabkdef{#1}{#2}} 
\DeclareRobustCommand\abkdef{\dofrco@baabk\leavevmode\resetcorr@ba\checkNrun@two{abkdef}} %% \@abkdef %%

\def\@defabk#1#2{\@initabkdef{#2}{#1}\@printonlydefabk{#1}{#2}}
\DeclareRobustCommand\defabk{\ba@textmode\leavevmode\resetcorr@ba\checkNrun@two{defabk}} %% \@defabk %%

\def\@printonlyabkdef#1#2{\@printonlyabk{#1}\strut
   {\@herefunctions\@banonumtrue\printsecondarg@ba{\abkdefopen}{#2}{\abkdefclose}{\abkemph}}\next@printabk}
\DeclareRobustCommand\printonlyabkdef{\dofrco@baabk\resetcorr@ba\checkNrun@two{printonlyabkdef}} %% \@printonlyabkdef %%


\newif\if@ba@newLTX\@ba@newLTXfalse
\def\pndefabk{\@ba@newLTXfalse}
\def\negcorrdefabk{\protect\pndefabk}
\def\pnndefabk{\@ba@newLTXtrue}
\def\notnegcorrdefabk{\protect\pnndefabk}

\def\@printonlydefabk#1#2{{\@herefunctions\ignorespaces #1}\nulskip@ba\strut
   {\abkemph{\ifdim\fontdimen\@ne\font=\z@\gdef\bacorr{\@baupcorr}\else
            \if@ba@newLTX\gdef\bacorr{}\else\gdef\bacorr{\@badowncorr}\fi\fi}}%
   {\let\@testa=-\finddot@ba{#1}%
    \ifx\@testa+\@bahasdot\fi
   }%
   {\defabkopen}\@printonlyabk{#2}%
   {\let\@testa=-\finddot@ba{#2}%
    \ifx\@testa+\@bahasdot
      {\defabkclose}\gdef\bacorr{}%
    \else
      \setbox\testbox@ba=\hbox{\def\corrrrule@ba{}\defabkclose}%
      \ifdim\ht\testbox@ba=0pt%
        \def\bacorr{}{\defabkclose}%
      \else
        {\defabkclose}\gdef\bacorr{}%
      \fi
    \fi
   }\spacefactorM@ba\next@printabk}

\DeclareRobustCommand\printonlydefabk{\ba@textmode\resetcorr@ba\checkNrun@two{printonlydefabk}} %% \@printonlydefabk %%

\def\@addtoabkdef#1#2{\@initabkdef{#1}{#2}}
\DeclareRobustCommand\addtoabkdef{\checkNrun@two{addtoabkdef}} %% \@addtoabkdef %%

\def\@addtodefabk#1#2{\@initabkdef{#2}{#1}}
\DeclareRobustCommand\addtodefabk{\checkNrun@two{addtodefabk}} %% \@addtodefabk %%

\def\@initabkdef#1#2{\if@unusedbib\else\@bsphack\fi
   \if@filesw {\let\thepage\relax
   \@outsavety\@outfunctions
   \edef\@tempa{\write\@auxout{\commentch@ba\string
   \abkrzentry{#1}{#2}{{\abklistopen}{\abklistclose}{}{}}{\setn@ba}[\catq@ba][\lang@ba](line \line@ba)}}%
   \expandafter}\@tempa
   \if@nobreak\ifvmode\nobreak\fi\fi \fi
   \if@unusedbib\ignorespaces\else\@esphack\fi}

\def\@initaddtoabk#1{\if@unusedbib\else\@bsphack\fi
   \if@filesw {\let\thepage\relax
   \@outsavety\@outfunctions
   \edef\@tempa{\write\@auxout{\commentch@ba\string
   \abkrzentry{#1}{}{{}{}{}{}}{\setn@ba}[\catq@ba][\lang@ba](line \line@ba)}}%
   \expandafter}\@tempa
   \if@nobreak\ifvmode\nobreak\fi\fi \fi
   \if@unusedbib\ignorespaces\else\@esphack\fi}

\def\@abkper#1{\@addtoabk{#1}\checkNonerun@a{per}{#1}}  %% \@per %%
\DeclareRobustCommand\abkper{\dofrco@ba\@pfvbatrue\leavevmode\checkNrun@one{abkper}}  %% \@abkper %%

\def\abkrzentry#1#2#3#4[#5][#6](#7){}



\def\@addtogrr#1{\@initaddtoreg{\geogrentry}{#1}{}{\setn@ba}}
\DeclareRobustCommand\addtogrr{\checkNrun@one{addtogrr}} %% \@addtogrr %%

\def\@addtoprr#1{\@initaddtoreg{\persrentry}{#1}{}{\setn@ba}}
\DeclareRobustCommand\addtoprr{\checkNrun@one{addtoprr}} %% \@addtoprr %%

\def\@addtosrr#1{\@initaddtoreg{\subjrentry}{#1}{}{\setn@ba}}
\DeclareRobustCommand\addtosrr{\checkNrun@one{addtosrr}} %% \@addtosrr %%


\def\@fillgrr#1#2{\@initaddtoreg{\geogrentry}{#1}{#2}{{}{}{-}}}
\DeclareRobustCommand\fillgrr{\checkNrun@two{fillgrr}} %% \@fillgrr %%

\def\@fillprr#1#2{\@initaddtoreg{\persrentry}{#1}{#2}{{}{}{-}}}
\DeclareRobustCommand\fillprr{\checkNrun@two{fillprr}} %% \@fillprr %%

\def\@fillsrr#1#2{\@initaddtoreg{\subjrentry}{#1}{#2}{{}{}{-}}}
\DeclareRobustCommand\fillsrr{\checkNrun@two{fillsrr}} %% \@fillsrr %%


\def\@initaddtoreg#1#2#3#4{\if@unusedbib\else\@bsphack\fi
   \if@filesw {\let\thepage\relax
   \@outsavety\@outfunctions
   \edef\@tempa{\write\@auxout{\commentch@ba\string
   #1{#2}{#3}{{\xrrlistopen}{\xrrlistclose}{}{}}{#4}[\catq@ba][\lang@ba](line \line@ba)}}%
   \expandafter}\@tempa
   \if@nobreak\ifvmode\nobreak\fi\fi \fi
   \if@unusedbib\ignorespaces\else\@esphack\fi}


\def\geogrentry#1#2#3#4[#5][#6](#7){}
\def\persrentry#1#2#3#4[#5][#6](#7){}
\def\subjrentry#1#2#3#4[#5][#6](#7){}

%%


                         %% lists %%

\expandafter\ifx\csname MakeUppercase\endcsname\relax
\def\uc@ba{\uppercase}%
\else
\def\uc@ba{\MakeUppercase}%
\fi

\expandafter\ifx\csname @mkboth\endcsname\relax
\def\bamarkboth#1{}%
\else
\def\bamarkboth#1{\@mkboth{\uc@ba{\cap@ba{#1}}}{\uc@ba{\cap@ba{#1}}}}%
\fi

\def\titleline@ba#1#2{{\csname #2\endcsname*{\cap@ba{#1title}}\relax}}
\def\contents@ba#1#2#3{\expandafter\ifx\csname #2\endcsname\relax
   {\errorcontextlines=-1\@qqertypeout{print#1title}{...}%
    \errhelp{Your [OptArg] is unknown.}%
    \errmessage@ba{Undefined title size}}%
   \else\addcontentsline{toc}{#2}{\cap@ba{#1title}}\fi
   \bamarkboth{#1title}{#3}}
\def\printlist@ba#1#2#3{{\csname @print#2#3list\endcsname{#1}}}

\def\title@ba#1[#2]{\titleline@ba{#1}{#2}\contents@ba{#1}{#2}{}}
\def\Check@batitle#1#2{\@ifnextchar[{\title@ba{#1}}{\title@ba{#1}[#2]}}

\def\balist@ba#1#2#3[#4]{\if@oldba\else\titleline@ba{#3}{#4}\contents@ba{#3}{#4}{}\fi \printlist@ba{#1}{#2}{#3}}
\def\Check@balist#1#2#3#4{\@ifnextchar[{\balist@ba{#1}{#2}{#3}}{\balist@ba{#1}{#2}{#3}[#4]}}

\def\batwocoltopskip{10pt}
\def\dotcbalist@ba#1#2#3[#4]{\twocolumn[\titleline@ba{#3}{#4}%
  \if@bibsorthead \vskip \batwocoltopskip\else\if@bibsortspace\vskip \batwocoltopskip\fi\fi]\relax
  \contents@ba{#3}{#4}{\thispagestyle{plain}}\printlist@ba{#1}{#2}{#3}}
\def\tcbalist@ba#1#2#3#4[#5]{{%
  #2{\if@twocolumn\dotcbalist@ba{#1}{#3}{#4}[#5]\clearpage
     \else        \dotcbalist@ba{#1}{#3}{#4}[#5]\onecolumn
     \fi}}}
\def\Check@tcbalist#1#2#3#4#5{\@ifnextchar[{\tcbalist@ba{#1}{#2}{#3}{#4}}{\tcbalist@ba{#1}{#2}{#3}{#4}[#5]}}


\def\printabktitle{\ba@textmode\Check@batitle{abk}{subsection}}
\def\printarqtitle{\ba@textmode\Check@batitle{arq}{subsection}}
\def\printbibtitle{\ba@textmode\Check@batitle{bib}{section}}
\def\printgrrtitle{\ba@textmode\Check@batitle{grr}{subsection}}
\def\printpertitle{\ba@textmode\Check@batitle{per}{subsection}}
\def\printprrtitle{\ba@textmode\Check@batitle{prr}{subsection}}
\def\printsrrtitle{\ba@textmode\Check@batitle{srr}{subsection}}
\def\printvkctitle{\ba@textmode\Check@batitle{vkc}{subsection}}
\def\printvlititle{\ba@textmode\Check@batitle{vli}{subsection}}
\def\printvqutitle{\ba@textmode\Check@batitle{vqu}{subsection}}


\def\@balistnumemph{\normalfont\balistnumemph\relax\upshape}
\def\@baloopspace{\def\ {\penalty\@m\hskip 0.25em plus 0.2em minus 0.1em}}
\def\@baindexlist{%
  \def\first@baidx##1{\leavevmode
    {\@baloopspace\@balistnumemph{{\frompagesep}##1}}\ignorespaces}%
  \def\follo@baidx##1{{\@baloopspace\@balistnumemph{##1}}\ignorespaces}}

\newif\if@banonum\@banonumfalse

\def\@printnumvlilist#1{\resetcorr@ba{\@vxxbalisttrue\@kxxbafalse\def\literentry{\@listventry}\@baindexlist\@balist{vli}{#1}}}
 \def\printnumvlilist{\ba@textmode\@printnumvlilist{\@baitemdefs}}

\def\@printvlilist#1{\resetcorr@ba{\@vxxbalisttrue\@kxxbafalse\@banonumtrue\def\literentry{\@listventry}\@balist{vli}{#1}}}
 \def\printvlilist{\ba@textmode\@printvlilist{\@baitemdefs}}


\def\@printnumvqulist#1{\resetcorr@ba{\@vxxbalisttrue\@kxxbafalse\def\quellentry{\@listventry}\@baindexlist\@balist{vqu}{#1}}}
 \def\printnumvqulist{\ba@textmode\@printnumvqulist{\@baitemdefs}}

\def\@printvqulist#1{\resetcorr@ba{\@vxxbalisttrue\@kxxbafalse\@banonumtrue\def\quellentry{\@listventry}\@balist{vqu}{#1}}}
 \def\printvqulist{\ba@textmode\@printvqulist{\@baitemdefs}}


\def\@printnumperlist#1{\resetcorr@ba{\def\perioentry{\@perioentry}\@baindexlist\@balist{per}{#1}}}
 \def\printnumperlist{\ba@textmode\@printnumperlist{\@baitemdefs}}

\def\@printperlist#1{\resetcorr@ba{\@banonumtrue\def\perioentry{\@perioentry}\@balist{per}{#1}}}
 \def\printperlist{\ba@textmode\@printperlist{\@baitemdefs}}


\def\@printnumarqlist#1{\resetcorr@ba{\def\archqentry{\@archqentry}\@baindexlist\@balist{arq}{#1}}}
 \def\printnumarqlist{\ba@textmode\@printnumarqlist{\@baitemdefs}}

\def\@printarqlist#1{\resetcorr@ba{\@banonumtrue\def\archqentry{\@archqentry}\@balist{arq}{#1}}}
 \def\printarqlist{\ba@textmode\@printarqlist{\@baitemdefs}}


\def\@printabklist#1{{\@banonumtrue\def\abkrzentry{\@abkrzentry}%
  \@balist{abk}{#1}}}
 \def\printabklist{\ba@textmode\@printabklist{\@baitemdefs}}

\def\@printnumabklist#1{\resetcorr@ba{\def\abkrzentry{\@abkrzentry}%
  \@baindexlist
  \@balist{abk}{#1}}}
 \def\printnumabklist{\ba@textmode\@printnumabklist{\@baitemdefs}}


\def\@printvkclist#1{\resetcorr@ba{\@kxxbatrue\@banonumtrue\def\vkcitentry{\@vkcitentry}%
  \@balist{vkc}{#1}}}
 \def\printvkclist{\ba@textmode\@printvkclist{\@baitemdefs}}

\def\@printnumvkclist#1{\resetcorr@ba{\@kxxbatrue\def\vkcitentry{\@vkcitentry}%
  \@baindexlist
  \@balist{vkc}{#1}}}
 \def\printnumvkclist{\ba@textmode\@printnumvkclist{\@baitemdefs}}


\def\@printgrrlist#1{\resetcorr@ba{\@banonumtrue\def\geogrentry{\@baTWOentry}%
  \@balist{grr}{#1}}}
 \def\printgrrlist{\ba@textmode\@printgrrlist{\@baitemdefs}}

\def\@printnumgrrlist#1{\resetcorr@ba{\def\geogrentry{\@baTWOentry}%
  \@baindexlist
  \@balist{grr}{#1}}}
 \def\printnumgrrlist{\ba@textmode\@printnumgrrlist{\@baitemdefs}}


\def\@printprrlist#1{\resetcorr@ba{\@banonumtrue\def\persrentry{\@baTWOentry}%
  \@balist{prr}{#1}}}
 \def\printprrlist{\ba@textmode\@printprrlist{\@baitemdefs}}

\def\@printnumprrlist#1{\resetcorr@ba{\def\persrentry{\@baTWOentry}%
  \@baindexlist
  \@balist{prr}{#1}}}
 \def\printnumprrlist{\ba@textmode\@printnumprrlist{\@baitemdefs}}


\def\@printsrrlist#1{\resetcorr@ba{\@banonumtrue\def\subjrentry{\@baTWOentry}%
  \@balist{srr}{#1}}}
 \def\printsrrlist{\ba@textmode\@printsrrlist{\@baitemdefs}}

\def\@printnumsrrlist#1{\resetcorr@ba{\def\subjrentry{\@baTWOentry}%
  \@baindexlist
  \@balist{srr}{#1}}}
 \def\printnumsrrlist{\ba@textmode\@printnumsrrlist{\@baitemdefs}}


\def\printnumvli{\ba@textmode\Check@balist{\@baonecoldefs}{num}{vli}{subsection}}
\def\printnumvqu{\ba@textmode\Check@balist{\@baonecoldefs}{num}{vqu}{subsection}}
\def\printnumper{\ba@textmode\Check@balist{\@baonecoldefs}{num}{per}{subsection}}
\def\printnumarq{\ba@textmode\Check@balist{\@baonecoldefs}{num}{arq}{subsection}}

\def\printvli{\ba@textmode\Check@balist{\@baonecoldefs}{}{vli}{subsection}}
\def\printvqu{\ba@textmode\Check@balist{\@baonecoldefs}{}{vqu}{subsection}}
\def\printper{\ba@textmode\Check@balist{\@baonecoldefs}{}{per}{subsection}}
\def\printarq{\ba@textmode\Check@balist{\@baonecoldefs}{}{arq}{subsection}}

\def\printabk{\ba@textmode\Check@tcbalist{\@batwocoldefs}{\footnotesize}{}{abk}{subsection}}
\def\printnumabk{\ba@textmode\Check@tcbalist{\@batwocoldefs}{\footnotesize}{num}{abk}{subsection}}

\def\printvkc{\ba@textmode\Check@tcbalist{\@batwocoldefs}{\small}{}{vkc}{subsection}}
\def\printnumvkc{\ba@textmode\Check@tcbalist{\@batwocoldefs}{\small}{num}{vkc}{subsection}}

\def\printgrr{\ba@textmode\Check@tcbalist{\@batwocoldefs}{\small}{}{grr}{subsection}}
\def\printnumgrr{\ba@textmode\Check@tcbalist{\@batwocoldefs}{\small}{num}{grr}{subsection}}

\def\printprr{\ba@textmode\Check@tcbalist{\@batwocoldefs}{\small}{}{prr}{subsection}}
\def\printnumprr{\ba@textmode\Check@tcbalist{\@batwocoldefs}{\small}{num}{prr}{subsection}}

\def\printsrr{\ba@textmode\Check@tcbalist{\@batwocoldefs}{\small}{}{srr}{subsection}}
\def\printnumsrr{\ba@textmode\Check@tcbalist{\@batwocoldefs}{\small}{num}{srr}{subsection}}



\def\info@emptyba#1{\typeout@ba{BibArts Warning: No ...entries in \jobname.#1 on input line \line@ba.}%
    {\item{}\BibArts: File \jobname.#1 was empty. Did you start
     \LaTeX\ only once\string? Or did you forget to command
     \string`bibsort \jobname\string'\string?}}


\def\ignore@unused#1{\type@bawarn{Can't `addto' \string#1}}


\def\@reprintfunctions{%
   \def\onlyhere##1{}%
   \def\onlyout##1{##1}%
   \def\onlyvoll##1{##1}%
   \def\onlykurz##1{}%
   \def\ktit##1{##1\ba@textmode}%
   \@fileswfalse%  %% not influences \label, \index, \glossary %%
   \def\sort##1{}%
}

\def\@reprintkfunctions{%  %% if bibsort is not used %%
   \def\onlyhere##1{}%
   \def\onlyout##1{##1}%
   \def\onlyvoll##1{}%
   \def\onlykurz##1{##1}%
}


\def\language@barep#1#2{%
   \ifnum\language=#1%
   \else\typeout@ba{BibArts list line \line@ba: Reproduce hyphenation #1 as in LaTeX file #2.}%
        \language=#1%
   \fi}

\def\activech@barep#1#2{
   \ifnum\catcode\grave@ba\"=#1%
   \else\typeout@ba{^^JBibArts warning for page \thepage\space (entry from LaTeX file #2): " troubles!
                 ^^J \space\space I can't reproduce DOUBLEQUOTE in line \line@ba\space of the current BibArts file.
                 ^^J \space\space The catcode of that character has been #1 in your LaTeX file, instead
                 ^^J \space\space of \the\catcode\grave@ba\", which is - and remains - the value here in the BibArts list.
                 ^^J \space\space If you use [n]german.sty: DID YOU START bibsort USING OPTION -x ??
                 ^^J \space\space If you've used e.g. \string\"a instead of "a there, you may ignore that warning.
                 ^^J}%
   \fi}

%% No \message without german.sty: %%
\def\bagermanTeX#1{%
  \expandafter\ifx\csname  ngermanTeX\endcsname\relax\else \ngermanTeX{#1}\message{(new)}\fi
  \expandafter\ifx\csname   germanTeX\endcsname\relax\else  \germanTeX{#1}\message{(old)}\fi}
\def\baoriginalTeX#1{%
  \expandafter\ifx\csname originalTeX\endcsname\relax\else
   \expandafter\ifx\csname AfterBabelLanguage\endcsname\relax\originalTeX{#1}\fi  %% not babel
  \fi}


\newif\if@baaddx\@baaddxfalse
\def\addxadd@ba#1#2#3{\def\nsep{#1}\relax\csname @baaddx#2\endcsname}

\def\first@baidx#1{\ignorespaces}
\def\follo@baidx#1{\ignorespaces}

\def\@listventry#1#2#3#4#5#6[#7][#8](#9){%
   \addxadd@ba#5\relax\relax\relax
   \language@barep{#8}{#9}%
   \activech@barep{#7}{#9}%
   \gdef\bacorr{}%
   \item{}\@printvname{#1}{\listlnfnsep}{#2}{1}{1}%
 \if@baaddx\@printoptarg{#3}{\nsep}\else\@printoptarg{#3}{}\fi
   {\reprint@batrue \@printlastarg{#4}{}}\if@banonum{\fromnopagevxxsep}\fi\@reportbaupfalse\ignorespaces}

\def\@vkcitentry#1#2#3#4#5#6[#7][#8](#9){\@reprintkfunctions
   \addxadd@ba#5\relax\relax\relax
   \language@barep{#8}{#9}%
   \activech@barep{#7}{#9}%
   \makeXcorrcmd@ba{\kxxemph}{\bacorr}%
   \item{}\@printkname{#1}{1}%
   \if@baaddx\@printoptarg{#2}{\nsep}\else\@printoptarg{#2}{}\fi
   \@printlastarg{#3}{\kxxemph}\@initprinthint{#4}%
   \if@banonum{\fromnopagevkcsep}\fi
   \@reportbaupfalse\ignorespaces}


\def\printfirstarg@ba#1#2#3{{\nulskip@ba
   \setbox\testbox@ba=\hbox{#1{\ignorespaces #2\ba@textmode}}%
   \ifdim\ht\testbox@ba=0pt{\erri@ba}\type@bawarn{Empty ...#3}\else{\unhbox\testbox@ba}\fi}}

\def\printsecondarg@ba#1#2#3#4{{%
   \setbox\testbox@ba=\hbox{\ignorespaces #2\ba@textmode}%
   \ifdim\ht\testbox@ba=0pt{#4{\ifdim\fontdimen\@ne\font=\z@\gdef\bacorr{}\fi}}\else
   {#1}{\unhbox\testbox@ba}%
       \init@bacorr{#2}{}{\bacorr}%
   {#3}\if@banonum\spacefactorM@ba\else
         \setbox\testbox@ba=\hbox{#3}%
         \ifdim\ht\testbox@ba=0pt\else
           \init@bacorr{#3}{}{\bacorr}%
         \fi
       \fi
   \fi}}

\def\addTadd@ba#1#2#3#4{\def\@baopen{#1}\relax\def\@baclose{#2}}
\def\addAadd@ba#1#2#3#4{%
   \ifx#31\arqsectionbegin\relax\fi
   \ifx#32\arqsubsectionbegin\relax\fi
   \ifx#33\arqsubsubsectionbegin\relax\fi
   \def\@baopen{#1}\relax\def\@baclose{#2}}
\def\addBadd@ba#1#2#3#4{%
   \ifx#31\arqsectionend\relax\fi
   \ifx#32\arqsubsectionend\relax\fi
   \ifx#33\arqsubsubsectionend\relax\fi}

\def\@baTWOentry#1#2#3#4[#5][#6](#7){%
   \addTadd@ba#3\relax\relax\relax\relax
   \language@barep{#6}{#7}%
   \activech@barep{#5}{#7}%
   \item{}\printfirstarg@ba{\xrrlistemph}{#1}{.rr}%
      \init@bacorr{#1}{\xrrlistemph}{\bacorr}%
        \printsecondarg@ba{\@baopen}{#2}{\@baclose}{\xrrlistemph}%
   \if@banonum{\fromnopagexrrsep}\fi \@reportbaupfalse\ignorespaces}

\def\@archqentry#1#2#3#4[#5][#6](#7){{%
   \addAadd@ba#3%
   \language@barep{#6}{#7}%
   \activech@barep{#5}{#7}%
   \item{}\printfirstarg@ba{\arqlistemph}{#1}{arq}%
      \init@bacorr{#1}{\arqlistemph}{\bacorr}%
        \printsecondarg@ba{\@baopen}{#2}{\@baclose}{\arqlistemph}%
   \if@banonum{\fromnopagearqsep}\addBadd@ba#3\relax\else
     \ifdim\lastskip=\hasdotcode@ba\addBadd@ba#3\relax\@bahasdot\else
     \addBadd@ba#3\relax\fi
   \fi}%
   \@reportbaupfalse\ignorespaces}

\def\@perioentry#1#2#3#4[#5][#6](#7){%
   \addTadd@ba#3\relax\relax\relax\relax
   \language@barep{#6}{#7}%
   \activech@barep{#5}{#7}%
   \item{}\printfirstarg@ba{\perlistemph}{#1}{per}%
      \init@bacorr{#1}{\perlistemph}{\bacorr}%
        \printsecondarg@ba{\@baopen}{#2}{\@baclose}{\perlistemph}%
   \if@banonum{\fromnopagepersep}\fi \@reportbaupfalse\ignorespaces}

\def\@abkrzentry#1#2#3#4[#5][#6](#7){%
   \addTadd@ba#3\relax\relax\relax\relax
   \language@barep{#6}{#7}%
   \activech@barep{#5}{#7}%
   \item{}\printfirstarg@ba{\abklistemph}{#1}{abk...}%
      \init@bacorr{#1}{\abklistemph}{\bacorr}%
        \printsecondarg@ba{\@baopen}{#2}{\@baclose}{\abklistemph}%
   \if@banonum{\fromnopageabksep}\fi \@reportbaupfalse\ignorespaces}

\def\bamyitemdefs#1{\@bsphack\def\@baitemdefs{#1}\@esphack}
\def\batwocolitemdefs{\def\@baitemdefs{\@batwocoldefs}}
\def\@batwocoldefs{\parsep 0ex \itemsep 0pt \parskip 0pt \lineskip 0pt \rightskip 1cm minus 1cm}
\def\baonecolitemdefs{\def\@baitemdefs{\@baonecoldefs}}
\def\@baonecoldefs{\parsep 0ex \itemsep -.5ex}
\def\notbaitemdefs{\def\@baitemdefs{}}
\notbaitemdefs

\def\listparm@ba{}
\def\@balist#1#2{\message{ \string<\string< #1\string:}%
   {\errorcontextlines=-1\catcode\grave@ba\@=11\balisttype{}%
   \@herefunctions\@reprintfunctions\@rheraldktitfalse
   \@allowconferizefalse \genderingfalse \@balisttrue
   %%%
   \gdef\listparm@ba{#2}%
   %%%
   \if@bibsortspace
       \let\bibsortpreparespace\do@bibsortspace
   \fi
   %%%
   \if@bibsorthead
       \let\bibsortpreparexspace\do@bibsortspace
     \if@twocolumn
       \let\bibsortpreparehead\do@twocolumnbsh
       {\edef\@testa{\listparm@ba}%
        \ifx\@testa\@batwocoldefs
        \else
         \type@bawarn{Set TWOcolitemdefs (TWOcol+heads)}%
         \gdef\listparm@ba{\@batwocoldefs}%
        \fi}%
     \else
       \let\bibsortpreparehead\do@onecolumnbsh
       {\edef\@testa{\listparm@ba}%
        \ifx\@testa\@batwocoldefs
         \type@bawarn{Reject TWOcolitemdefs (ONEcol+heads)}%
         \gdef\listparm@ba{}%
        \fi}%
     \fi
   \fi
   %%%
   \sloppy\begin{description}
     \listparm@ba\relax
     \@input{\jobname.#1}
     \def\@noitemerr{\info@emptyba{#1}}
   \end{description}\fussy}\message{\string>\string> }}



\def\@hereUfunctions{%
   \def\par{}%
   \def\vli{\addtovli}%
   \def\vqu{\addtovqu}%
   \def\kli{\addtokli}%
   \def\kqu{\addtokqu}%
   \def\printonlyvli{\ignore@unused{\printonlyvli}\shadowv}%
   \def\printonlyvqu{\ignore@unused{\printonlyvqu}\shadowv}%
   \def\printonlykli{\ignore@unused{\printonlykli}\shadowk}%
   \def\printonlykqu{\ignore@unused{\printonlykqu}\shadowk}%
   \def\xvli{\xaddtovli}%
   \def\xvqu{\xaddtovqu}%
   \def\xkli{\xaddtokli}%
   \def\xkqu{\xaddtokqu}%
   \def\xprintonlyvli{\ignore@unused{\xprintonlyvli}\shadowv}%
   \def\xprintonlyvqu{\ignore@unused{\xprintonlyvqu}\shadowv}%
   \def\xprintonlykli{\ignore@unused{\xprintonlykli}\shadowk}%
   \def\xprintonlykqu{\ignore@unused{\xprintonlykqu}\shadowk}%
   \def\per{\addtoper}%
   \def\abkper{\addtoper}%
   \def\arq{\addtoarq}%
   \def\abk{\ignore@unused{\abk}\shadowone}%
   \def\addtoabk{\ignore@unused{\addtoabk}\shadowone}%
   \def\abkdef{\addtoabkdef}%
   \def\defabk{\addtodefabk}%
   \def\printonlyper{\ignore@unused{\printonlyper}\shadowo}%
   \def\printonlyarq{\ignore@unused{\printonlyarq}\shadowt}%
   \def\printonlyabk{\ignore@unused{\printonlyabk}\shadowone}%
   \def\printonlyabkdef{\ignore@unused{\printonlyabkdef}\shadowtwo}%
   \def\printonlydefabk{\ignore@unused{\printonlydefabk}\shadowtwo}%
}

\newif\if@unusedbib\@unusedbibfalse

\expandafter\ifx\csname newenvironment\endcsname\relax
\else\newenvironment{unused}{\@unusedbibtrue\@hereUfunctions\ignorespaces}{}\fi


%%


                      %% hyphenation setting %%


\expandafter\ifx\csname language\endcsname\relax
   \typeout@ba{Install missing count \string\language: Hyphenation features will probably not work.}%
   \newcount\language
\fi

\def\psethyphenation#1{\@bsphack\sethyphen@ba{#1}{You've called \string\sethyphenation{#1}.}\@esphack}
\def\sethyphenation{\protect\psethyphenation}

\def\sethyphen@ba#1#2{%
   \expandafter \ifx\csname l@#1\endcsname\relax
   {\errhelp{
     ^^JI will not set `#1' hyphenation,
     ^^Jbecause that `[LanguageName]' is no preloaded feature.
     ^^JYou have to fix that later: <return>.^^J
    }%
    \errorcontextlines=-1\@qqertypeout{sethyphenation}{#2}%
    \errmessage@ba{Language-name `#1' is undefined. (Old VALUE remains valid: \lang@ba)}%
   }%
   \else \ifnum255=\csname l@#1\endcsname
   {\errhelp{
    ^^JLanguage `#1' is defined, but as hyphenation 255.
    ^^JThat probably is an error-value for a not preloaded feature.
    ^^JI myself will NOT set \language= 255.^^J
    }%
    \errorcontextlines=-1\@qqertypeout{sethyphenation}{#2}%
    \errmessage@ba{No `#1' hyphenation. (Old VALUE remains valid: \lang@ba)}%
   }%
   \else\language=\csname l@#1\endcsname
   \fi
   \fi}

\def\Check@originalquote[#1]{\begin{quote}\originalquotetype{}\ifx #1\erri@ba\else
   \sethyphen@ba{#1}{You've called \string\begin{originalquote}[#1].}\fi}

\expandafter\ifx\csname newenvironment\endcsname\relax
\else\newenvironment{originalquote}{\def\bakorr@fnr{{\vskip\topsep}{\vskip\partopsep}}%
   \@ifnextchar[{\Check@originalquote}{\Check@originalquote[\erri@ba]}}{\end{quote}\pagebreak[2]}%
\fi


%%


                    %% cross-references %%


%% No italics-corr on 2.09: %%
\expandafter\ifx\csname ba@its\endcsname\relax
\def\prepare@baref{}%
\else
\def\prepare@baref{\gdef\barefcorr{}%
   \def\itshape{\ba@its\makecorrcmd@ba{}{\barefcorr}}%
   \def\slshape{\ba@sls\makecorrcmd@ba{}{\barefcorr}}%
}%
\fi

\def\insref@ba#1{{%
   \def\@testa{#1}%
   \ifx\@testa\@leerz\else\ifx\@testa\@leer\else
      {\ignorespaces #1}\penalty\@m \ \fi\fi}}

\def\ba@ref[#1]#2{{\gdef\barefcorr{}%
      \cap@ba{refvbeg}\insref@ba{#1}\cap@ba{refvpag}%
   \expandafter\ifx\csname r@baf.#2\endcsname\relax
     {\prepare@baref\pageref{#2}}\else
     {\prepare@baref\pageref{baf.#2}}\cap@ba{refvfnt}{\prepare@baref\ref{baf.#2}}\fi
      \cap@ba{refvend}}}
\def\pbaref{\@ifnextchar[{\ba@ref}{\ba@ref[\cap@ba{refverb}]}}
\def\baref{\protect\pbaref}

\def\ba@label#1{\@bsphack
   \if@footnote
     \@ifundefined{r@#1}{}{\@warning{Label \string`#1\string' multiply defined [BibArts]}}%
       \if@baminipage{\let\@currentlabel=\thempfootnote\label{baf.#1}}%
       \else         {\let\@currentlabel=\thefootnote  \label{baf.#1}}%
       \fi
   \else             {\let\@currentlabel=\@leer        \label{#1}}%
   \fi
   \@esphack}
\def\pbalabel{\ba@label}
\def\balabel{\protect\pbalabel}


%%

\def\ba@varref#1#2#3{%
   \makevarstring@ba{#1}{#2}{#3}\ba@ref[\cap@ba{confer}]{\insvarstring@ba}}

\def\ba@varlabel#1#2#3{\ifba@varstring\if@filesw\if@allowconferize
   \makevarstring@ba{#1}{#2}{#3}\ba@label{\insvarstring@ba}\fi\fi\fi}

 %%  \newlabel at \conferize
 %% ------------------------
 %%   (X   \l \L \o \O \ss's  [X = l, L, o, O, ss]
 %%   )    \^
 %%   *    \"
 %%   [    \`
 %%   ]    \'
 %%   +    \c
 %%   -    \~
 %%   oe   \oe
 %%   OE   \OE
 %%   ae   \ae
 %%   AE   \AE
 %%   a    \aa
 %%   A    \AA
 %%   i    \i
 %%   j    \j


\newif\if@bains@lab
\newcount\count@ba

\def\reset@allbalabvars{%
   \global\let\bavar@xA=\@leer
   \global\let\bavar@xB=\@leer
   \global\let\bavar@xC=\@leer
   \global\let\bavar@xD=\@leer
   \global\let\bavar@xE=\@leer
   \global\let\bavar@xF=\@leer
   \global\let\bavar@xG=\@leer
   \global\let\bavar@xH=\@leer
   \global\let\bavar@xI=\@leer
   \global\let\bavar@xJ=\@leer
   \global\let\bavar@xK=\@leer
   \global\let\bavar@xL=\@leer
   \global\let\bavar@yA=\@leer
   \global\let\bavar@yB=\@leer
   \global\let\bavar@yC=\@leer
   \global\let\bavar@yD=\@leer
   \global\let\bavar@yE=\@leer
   \global\let\bavar@yF=\@leer
   \global\let\bavar@yG=\@leer
   \global\let\bavar@yH=\@leer
   \global\let\bavar@yI=\@leer
   \global\let\bavar@yJ=\@leer
   \global\let\bavar@yK=\@leer
   \global\let\bavar@yL=\@leer
   \global\let\bavar@zA=\@leer
   \global\let\bavar@zB=\@leer
   \global\let\bavar@zC=\@leer
   \global\let\bavar@zD=\@leer
   \global\let\bavar@zE=\@leer
   \global\let\bavar@zF=\@leer
   \global\let\bavar@zG=\@leer
   \global\let\bavar@zH=\@leer
   \global\let\bavar@zI=\@leer
   \global\let\bavar@zJ=\@leer
   \global\let\bavar@zK=\@leer
   \global\let\bavar@zL=\@leer
   \global\let\bavar@zM=\@leer
   \global\let\bavar@zN=\@leer
   \global\let\bavar@zO=\@leer
   \global\let\bavar@zP=\@leer
   \global\let\bavar@zQ=\@leer
   \global\let\bavar@zR=\@leer
   \global\let\bavar@zS=\@leer
   \global\let\bavar@zT=\@leer
   \global\let\bavar@zU=\@leer
   \global\let\bavar@zV=\@leer
   \global\let\bavar@zW=\@leer
   \global\let\bavar@zX=\@leer
   }

\def\makevarstring@ba#1#2#3{%
   \reset@allbalabvars
  {\@hereRfunctions
    \def\SS{{SS}}%     %% \ 
    \def\aa{{\r{a}}}%  %%   > avoid [T1] errors
    \def\AA{{\r{A}}}%  %% /
   \ifba@varstring           \@bains@labtrue
   \getnext@baA#1\endlist@ba \@bains@labtrue
   \getnext@baB#2\endlist@ba \@bains@labtrue
   \getnext@baC#3\endlist@ba\fi}}

\def\endlist@ba{\endlist@ba}

\def\getnext@baA{\afterassignment\doba@labA\let\next@ba= }
\def\getnext@baB{\afterassignment\doba@labB\let\next@ba= }
\def\getnext@baC{\afterassignment\doba@labC\let\next@ba= }


\def\refch@ba#1#2{\let\next@ba=#2\csname savn@bavar#1\endcsname}
\def\refop@ba#1{\refch@ba{#1}{(}}


\def\sonderz@banext#1{%
   \ifx     \ck\next@ba \refch@ba{#1}{c}\refch@ba{#1}{k}\fi
   \ifx     \CK\next@ba \refch@ba{#1}{C}\refch@ba{#1}{K}\fi
   \ifx    \hyc\next@ba \refch@ba{#1}{c}\fi
   \ifx \oldhyc\next@ba \refch@ba{#1}{c}\fi
   \ifx    \HYC\next@ba \refch@ba{#1}{C}\fi
   \ifx \OLDHYC\next@ba \refch@ba{#1}{C}\fi
   \ifx    \hyl\next@ba \refch@ba{#1}{l}\fi
   \ifx \oldhyl\next@ba \refch@ba{#1}{l}\fi
   \ifx    \HYL\next@ba \refch@ba{#1}{L}\fi
   \ifx \OLDHYL\next@ba \refch@ba{#1}{L}\fi
   \ifx    \hym\next@ba \refch@ba{#1}{m}\fi
   \ifx \oldhym\next@ba \refch@ba{#1}{m}\fi
   \ifx    \HYM\next@ba \refch@ba{#1}{M}\fi
   \ifx \OLDHYM\next@ba \refch@ba{#1}{M}\fi
   \ifx    \hyn\next@ba \refch@ba{#1}{n}\fi
   \ifx \oldhyn\next@ba \refch@ba{#1}{n}\fi
   \ifx    \HYN\next@ba \refch@ba{#1}{N}\fi
   \ifx \OLDHYN\next@ba \refch@ba{#1}{N}\fi
   \ifx    \hyp\next@ba \refch@ba{#1}{p}\fi
   \ifx \oldhyp\next@ba \refch@ba{#1}{p}\fi
   \ifx    \HYP\next@ba \refch@ba{#1}{P}\fi
   \ifx \OLDHYP\next@ba \refch@ba{#1}{P}\fi
   \ifx    \hyr\next@ba \refch@ba{#1}{r}\fi
   \ifx \oldhyr\next@ba \refch@ba{#1}{r}\fi
   \ifx    \HYR\next@ba \refch@ba{#1}{R}\fi
   \ifx \OLDHYR\next@ba \refch@ba{#1}{R}\fi
   \ifx    \hyt\next@ba \refch@ba{#1}{t}\fi
   \ifx \oldhyt\next@ba \refch@ba{#1}{t}\fi
   \ifx    \HYT\next@ba \refch@ba{#1}{T}\fi
   \ifx \OLDHYT\next@ba \refch@ba{#1}{T}\fi
   \ifx    \hyf\next@ba \refch@ba{#1}{f}\fi
   \ifx \oldhyf\next@ba \refch@ba{#1}{f}\fi
   \ifx    \HYF\next@ba \refch@ba{#1}{F}\fi
   \ifx \OLDHYF\next@ba \refch@ba{#1}{F}\fi
   \ifx\oldhyss\next@ba \refop@ba{#1}\refch@ba{#1}{s}\refch@ba{#1}{s}\fi
   \ifx\OLDHYSS\next@ba \refch@ba{#1}{S}\refch@ba{#1}{S}\fi
   \ifx\newhyss\next@ba \refop@ba{#1}\refch@ba{#1}{s}\refch@ba{#1}{s}\fi
   \ifx\NEWHYSS\next@ba \refch@ba{#1}{S}\refch@ba{#1}{S}\fi
   \ifx   \hyss\next@ba \refop@ba{#1}\refch@ba{#1}{s}\refch@ba{#1}{s}\fi
   \ifx   \HYSS\next@ba \refch@ba{#1}{S}\refch@ba{#1}{S}\fi
   \ifx     \ss\next@ba \refop@ba{#1}\refch@ba{#1}{s}\refch@ba{#1}{s}\fi
   \ifx     \SS\next@ba \refch@ba{#1}{S}\refch@ba{#1}{S}\fi
   \ifx     \sz\next@ba \refop@ba{#1}\refch@ba{#1}{s}\refch@ba{#1}{z}\fi
   \ifx     \SZ\next@ba \refch@ba{#1}{S}\refch@ba{#1}{Z}\fi
   \ifx      \3\next@ba \refop@ba{#1}\refch@ba{#1}{s}\refch@ba{#1}{s}\fi
   \ifx\oe\next@ba \refch@ba{#1}{o}\refch@ba{#1}{e}\fi
   \ifx\OE\next@ba \refch@ba{#1}{O}\refch@ba{#1}{E}\fi
   \ifx\ae\next@ba \refch@ba{#1}{a}\refch@ba{#1}{e}\fi
   \ifx\AE\next@ba \refch@ba{#1}{A}\refch@ba{#1}{E}\fi
   \ifx\aa\next@ba \refch@ba{#1}{a}\fi
   \ifx\AA\next@ba \refch@ba{#1}{A}\fi
   \ifx \o\next@ba \refop@ba{#1}\refch@ba{#1}{o}\fi
   \ifx \O\next@ba \refop@ba{#1}\refch@ba{#1}{O}\fi
   \ifx \l\next@ba \refop@ba{#1}\refch@ba{#1}{l}\fi
   \ifx \L\next@ba \refop@ba{#1}\refch@ba{#1}{L}\fi
   \ifx \i\next@ba \refch@ba{#1}{i}\fi
   \ifx \j\next@ba \refch@ba{#1}{j}\fi 
   \ifx \"\next@ba \refch@ba{#1}{*}\fi
   \ifx \`\next@ba \refch@ba{#1}{[}\fi
   \ifx \'\next@ba \refch@ba{#1}{]}\fi
   \ifx \^\next@ba \refch@ba{#1}{)}\fi
   \ifx \~\next@ba \ifnum\catcode\grave@ba\-=12\refch@ba{#1}{-}\fi \fi
   \ifx \c\next@ba \ifnum\catcode\grave@ba\+=12\refch@ba{#1}{+}\fi \fi
}


 {\catcode\grave@ba\~=12%
  \catcode\grave@ba\"=12%
  \catcode\grave@ba\:=12%
  \catcode\grave@ba\;=12%
  \catcode\grave@ba\!=12%
  \catcode\grave@ba\?=12%
  \catcode\grave@ba\'=12%
  \catcode\grave@ba\`=12%
  \catcode\grave@ba\<=12%
  \catcode\grave@ba\>=12%
\global\def\prepnumplussonder@ba#1{%
   \ifx "\next@ba \else\ifx .\next@ba \else\ifx ,\next@ba \else\ifx /\next@ba \else
   \ifx *\next@ba \else\ifx [\next@ba \else\ifx ]\next@ba \else\ifx |\next@ba \else
   \ifx -\next@ba \else\ifx =\next@ba \else\ifx +\next@ba \else\ifx (\next@ba \else
   \ifx )\next@ba \else\ifx @\next@ba \else
   \ifx ~\next@ba \else\ifx :\next@ba \else\ifx ;\next@ba \else\ifx !\next@ba \else
   \ifx ?\next@ba \else\ifx `\next@ba \else\ifx '\next@ba \else
   \ifx <\next@ba \else\ifx >\next@ba \else
      \ifcat 1\next@ba  \csname savn@bavar#1\endcsname
      \else           \sonderz@banext{#1}%
      \fi
   \fi\fi
   \fi\fi\fi
   \fi\fi\fi\fi
   \fi\fi
   \fi\fi\fi\fi
   \fi\fi\fi\fi
   \fi\fi\fi\fi}%
}

\def\analyselabeltext@ba#1{%
  \expandafter\ifx \csname next@ba\endcsname\relax\else
   \ifx \onlyvoll\next@ba \@bains@labfalse \count@ba0 \else
      \ifx \onlyout \next@ba \@bains@labfalse \count@ba0 \else
         \ifx \vauthor \next@ba \@bains@labfalse \count@ba0 \else
            \ifx \midvauthor \next@ba \@bains@labfalse \count@ba0
   \fi\fi\fi\fi
   \if@bains@lab
      \ifcat A\next@ba \csname savn@bavar#1\endcsname
      \else   \prepnumplussonder@ba{#1}%
      \fi
   \else
      \ifx \bgroup\next@ba \advance\count@ba by 1 \else
         \ifx \egroup\next@ba \advance\count@ba by -1
            \ifnum 0=\count@ba  \@bains@labtrue
      \fi\fi\fi
   \fi
  \fi}

\def\doba@labA{%
  \ifx\next@ba\endlist@ba \let\next@ba\@leer
  \else  \ifx\bavar@xL\@leer \analyselabeltext@ba{A}\fi
     \let\next@ba\getnext@baA
  \fi \next@ba}

\def\doba@labB{%
  \ifx\next@ba\endlist@ba \let\next@ba\@leer
  \else  \ifx\bavar@yL\@leer \analyselabeltext@ba{B}\fi
     \let\next@ba\getnext@baB
  \fi \next@ba}

\def\doba@labC{%
  \ifx\next@ba\endlist@ba \let\next@ba\@leer
  \else  \ifx\bavar@zX\@leer \analyselabeltext@ba{C}\fi
     \let\next@ba\getnext@baC
  \fi \next@ba}

\def\savn@bavarA{%
   \ifx\bavar@xA\@leer \global\let\bavar@xA=\next@ba \else
   \ifx\bavar@xB\@leer \global\let\bavar@xB=\next@ba \else
   \ifx\bavar@xC\@leer \global\let\bavar@xC=\next@ba \else
   \ifx\bavar@xD\@leer \global\let\bavar@xD=\next@ba \else
   \ifx\bavar@xE\@leer \global\let\bavar@xE=\next@ba \else
   \ifx\bavar@xF\@leer \global\let\bavar@xF=\next@ba \else
   \ifx\bavar@xG\@leer \global\let\bavar@xG=\next@ba \else
   \ifx\bavar@xH\@leer \global\let\bavar@xH=\next@ba \else
   \ifx\bavar@xI\@leer \global\let\bavar@xI=\next@ba \else
   \ifx\bavar@xJ\@leer \global\let\bavar@xJ=\next@ba \else
   \ifx\bavar@xK\@leer \global\let\bavar@xK=\next@ba \else
   \ifx\bavar@xL\@leer \global\let\bavar@xL=\next@ba
   \fi\fi\fi\fi\fi\fi\fi\fi\fi\fi\fi\fi}

\def\savn@bavarB{%
   \ifx\bavar@yA\@leer \global\let\bavar@yA=\next@ba \else
   \ifx\bavar@yB\@leer \global\let\bavar@yB=\next@ba \else
   \ifx\bavar@yC\@leer \global\let\bavar@yC=\next@ba \else
   \ifx\bavar@yD\@leer \global\let\bavar@yD=\next@ba \else
   \ifx\bavar@yE\@leer \global\let\bavar@yE=\next@ba \else
   \ifx\bavar@yF\@leer \global\let\bavar@yF=\next@ba \else
   \ifx\bavar@yG\@leer \global\let\bavar@yG=\next@ba \else
   \ifx\bavar@yH\@leer \global\let\bavar@yH=\next@ba \else
   \ifx\bavar@yI\@leer \global\let\bavar@yI=\next@ba \else
   \ifx\bavar@yJ\@leer \global\let\bavar@yJ=\next@ba \else
   \ifx\bavar@yK\@leer \global\let\bavar@yK=\next@ba \else
   \ifx\bavar@yL\@leer \global\let\bavar@yL=\next@ba
   \fi\fi\fi\fi\fi\fi\fi\fi\fi\fi\fi\fi}

\def\savn@bavarC{%
   \ifx\bavar@zA\@leer \global\let\bavar@zA=\next@ba \else
   \ifx\bavar@zB\@leer \global\let\bavar@zB=\next@ba \else
   \ifx\bavar@zC\@leer \global\let\bavar@zC=\next@ba \else
   \ifx\bavar@zD\@leer \global\let\bavar@zD=\next@ba \else
   \ifx\bavar@zE\@leer \global\let\bavar@zE=\next@ba \else
   \ifx\bavar@zF\@leer \global\let\bavar@zF=\next@ba \else
   \ifx\bavar@zG\@leer \global\let\bavar@zG=\next@ba \else
   \ifx\bavar@zH\@leer \global\let\bavar@zH=\next@ba \else
   \ifx\bavar@zI\@leer \global\let\bavar@zI=\next@ba \else
   \ifx\bavar@zJ\@leer \global\let\bavar@zJ=\next@ba \else
   \ifx\bavar@zK\@leer \global\let\bavar@zK=\next@ba \else
   \ifx\bavar@zL\@leer \global\let\bavar@zL=\next@ba \else
   \ifx\bavar@zM\@leer \global\let\bavar@zM=\next@ba \else
   \ifx\bavar@zN\@leer \global\let\bavar@zN=\next@ba \else
   \ifx\bavar@zO\@leer \global\let\bavar@zO=\next@ba \else
   \ifx\bavar@zP\@leer \global\let\bavar@zP=\next@ba \else
   \ifx\bavar@zQ\@leer \global\let\bavar@zQ=\next@ba \else
   \ifx\bavar@zR\@leer \global\let\bavar@zR=\next@ba \else
   \ifx\bavar@zS\@leer \global\let\bavar@zS=\next@ba \else
   \ifx\bavar@zT\@leer \global\let\bavar@zT=\next@ba \else
   \ifx\bavar@zU\@leer \global\let\bavar@zU=\next@ba \else
   \ifx\bavar@zV\@leer \global\let\bavar@zV=\next@ba \else
   \ifx\bavar@zW\@leer \global\let\bavar@zW=\next@ba \else
   \ifx\bavar@zX\@leer \global\let\bavar@zX=\next@ba
   \fi\fi\fi\fi\fi\fi\fi\fi\fi\fi\fi\fi\fi\fi\fi\fi\fi\fi\fi\fi\fi\fi\fi\fi}

\def\spendother@ba#1{%
   \ifx 1#11\fi
   \ifx 2#12\fi
   \ifx 3#13\fi
   \ifx 4#14\fi
   \ifx 5#15\fi
   \ifx 6#16\fi
   \ifx 7#17\fi
   \ifx 8#18\fi
   \ifx 9#19\fi
   \ifx 0#10\fi
   \ifx [#1[\fi   %% \`  %%
   \ifx ]#1]\fi   %% \'  %%
   \ifx (#1(\fi   %% \o \O \l \L \ss \hyss ... %%
   \ifx )#1)\fi   %% \^  %%
   \ifx *#1*\fi   %% \"  %%
   \ifx +#1+\fi   %% \c  %%
   \ifx -#1-\fi   %% \~  %%
   }%

\def\spendletter@ba#1{%
   \ifx a#1a\fi
   \ifx b#1b\fi
   \ifx c#1c\fi
   \ifx d#1d\fi
   \ifx e#1e\fi
   \ifx f#1f\fi
   \ifx g#1g\fi
   \ifx h#1h\fi
   \ifx i#1i\fi
   \ifx j#1j\fi
   \ifx k#1k\fi
   \ifx l#1l\fi
   \ifx m#1m\fi
   \ifx n#1n\fi
   \ifx o#1o\fi
   \ifx p#1p\fi
   \ifx q#1q\fi
   \ifx r#1r\fi
   \ifx s#1s\fi
   \ifx t#1t\fi
   \ifx u#1u\fi
   \ifx v#1v\fi
   \ifx w#1w\fi
   \ifx x#1x\fi
   \ifx y#1y\fi
   \ifx z#1z\fi
   \ifx A#1A\fi
   \ifx B#1B\fi
   \ifx C#1C\fi
   \ifx D#1D\fi
   \ifx E#1E\fi
   \ifx F#1F\fi
   \ifx G#1G\fi
   \ifx H#1H\fi
   \ifx I#1I\fi
   \ifx J#1J\fi
   \ifx K#1K\fi
   \ifx L#1L\fi
   \ifx M#1M\fi
   \ifx N#1N\fi
   \ifx O#1O\fi
   \ifx P#1P\fi
   \ifx Q#1Q\fi
   \ifx R#1R\fi
   \ifx S#1S\fi
   \ifx T#1T\fi
   \ifx U#1U\fi
   \ifx V#1V\fi
   \ifx W#1W\fi
   \ifx X#1X\fi
   \ifx Y#1Y\fi
   \ifx Z#1Z\fi
   }%

\def\spendchar@ba#1{\ifcat#1A\spendletter@ba{#1}\else\spendother@ba{#1}\fi}

\def\insvarstring@ba{%
            \ifx \bavar@xA\@leer \else
   \spendchar@ba \bavar@xA
            \ifx \bavar@xB\@leer \else
   \spendchar@ba \bavar@xB
            \ifx \bavar@xC\@leer \else
   \spendchar@ba \bavar@xC
            \ifx \bavar@xD\@leer \else
   \spendchar@ba \bavar@xD
            \ifx \bavar@xE\@leer \else
   \spendchar@ba \bavar@xE
            \ifx \bavar@xF\@leer \else
   \spendchar@ba \bavar@xF
            \ifx \bavar@xG\@leer \else
   \spendchar@ba \bavar@xG
            \ifx \bavar@xH\@leer \else
   \spendchar@ba \bavar@xH
            \ifx \bavar@xI\@leer \else
   \spendchar@ba \bavar@xI
            \ifx \bavar@xJ\@leer \else
   \spendchar@ba \bavar@xJ
            \ifx \bavar@xK\@leer \else
   \spendchar@ba \bavar@xK
            \ifx \bavar@xL\@leer \else
   \spendchar@ba \bavar@xL
  \fi\fi\fi\fi\fi\fi\fi\fi\fi\fi\fi\fi
   .%
            \ifx \bavar@yA\@leer \else
   \spendchar@ba \bavar@yA
            \ifx \bavar@yB\@leer \else
   \spendchar@ba \bavar@yB
            \ifx \bavar@yC\@leer \else
   \spendchar@ba \bavar@yC
            \ifx \bavar@yD\@leer \else
   \spendchar@ba \bavar@yD
            \ifx \bavar@yE\@leer \else
   \spendchar@ba \bavar@yE
            \ifx \bavar@yF\@leer \else
   \spendchar@ba \bavar@yF
            \ifx \bavar@yG\@leer \else
   \spendchar@ba \bavar@yG
            \ifx \bavar@yH\@leer \else
   \spendchar@ba \bavar@yH
            \ifx \bavar@yI\@leer \else
   \spendchar@ba \bavar@yI
            \ifx \bavar@yJ\@leer \else
   \spendchar@ba \bavar@yJ
            \ifx \bavar@yK\@leer \else
   \spendchar@ba \bavar@yK
            \ifx \bavar@yL\@leer \else
   \spendchar@ba \bavar@yL
  \fi\fi\fi\fi\fi\fi\fi\fi\fi\fi\fi\fi
   .%
            \ifx \bavar@zA\@leer \else
   \spendchar@ba \bavar@zA
            \ifx \bavar@zB\@leer \else
   \spendchar@ba \bavar@zB
            \ifx \bavar@zC\@leer \else
   \spendchar@ba \bavar@zC
            \ifx \bavar@zD\@leer \else
   \spendchar@ba \bavar@zD
            \ifx \bavar@zE\@leer \else
   \spendchar@ba \bavar@zE
            \ifx \bavar@zF\@leer \else
   \spendchar@ba \bavar@zF
            \ifx \bavar@zG\@leer \else
   \spendchar@ba \bavar@zG
            \ifx \bavar@zH\@leer \else
   \spendchar@ba \bavar@zH
            \ifx \bavar@zI\@leer \else
   \spendchar@ba \bavar@zI
            \ifx \bavar@zJ\@leer \else
   \spendchar@ba \bavar@zJ
            \ifx \bavar@zK\@leer \else
   \spendchar@ba \bavar@zK
            \ifx \bavar@zL\@leer \else
   \spendchar@ba \bavar@zL
            \ifx \bavar@zM\@leer \else
   \spendchar@ba \bavar@zM
            \ifx \bavar@zN\@leer \else
   \spendchar@ba \bavar@zN
            \ifx \bavar@zO\@leer \else
   \spendchar@ba \bavar@zO
            \ifx \bavar@zP\@leer \else
   \spendchar@ba \bavar@zP
            \ifx \bavar@zQ\@leer \else
   \spendchar@ba \bavar@zQ
            \ifx \bavar@zR\@leer \else
   \spendchar@ba \bavar@zR
            \ifx \bavar@zS\@leer \else
   \spendchar@ba \bavar@zS
            \ifx \bavar@zT\@leer \else
   \spendchar@ba \bavar@zT
            \ifx \bavar@zU\@leer \else
   \spendchar@ba \bavar@zU
            \ifx \bavar@zV\@leer \else
   \spendchar@ba \bavar@zV
            \ifx \bavar@zW\@leer \else
   \spendchar@ba \bavar@zW
            \ifx \bavar@zX\@leer \else
   \spendchar@ba \bavar@zX
  \fi\fi\fi\fi\fi\fi\fi\fi\fi\fi\fi\fi\fi\fi\fi\fi\fi\fi\fi\fi\fi\fi\fi\fi
   }


%%


                       %% ... %%


\def\ncn@ersch#1{{\csname #1erschnohousename\endcsname}}
\def\nyn@ersch#1{{\csname #1erschnoyearname\endcsname}}

{\catcode\grave@ba\>=12%
\gdef\@@ersch#1|#2|[#3]#4#5{\nulskip@ba
   {\def\@testa{#2}%
   \ifx\@testa\@leer \else
   \ifx\@testa\@leerz\else
         {\ignorespaces #2}\kern -0.1em\penalty\@m \
         \ifnum#2>1{\csname #1erschvolumepname\endcsname}\else
                   {\csname #1erschvolumename\endcsname}\fi \penalty-\@m \
   \fi\fi}%
   \nulskip@ba{\def\@testa{#3}\def\@testb{#4}%
   \if@bamathaufl
      \ifx\@testb\@leer \ncn@ersch{#1}\ \else
      \ifx\@testb\@leerz\ncn@ersch{#1}\ \else
            {\ignorespaces #4\ba@textmode}\
      \fi\fi
      \ifx\@testa\@leer \else \ifx\@testa\@leerz \else
         \kern  -0.4pt\fup{#3}\kern 0.4pt\nulskip@ba
      \fi\fi
   \else
      \ifx\@testa\@leer \else \ifx\@testa\@leerz \else
         {\csname #1ordinal\endcsname{#3\ba@textmode}}%
         {\setbox\testbox@ba=\hbox{\ignorespaces\csname #1erscheditionname\endcsname}%
           \ifdim\ht\testbox@ba=0pt\else{\unhbox\testbox@ba}\fi}\
      \fi\fi
      \ifx\@testb\@leer \ncn@ersch{#1}\ \else
      \ifx\@testb\@leerz\ncn@ersch{#1}\ \else
            {\ignorespaces #4\ba@textmode}\
      \fi\fi
   \fi}%
   {\def\@testa{#5}%
   \ifx\@testa\@leer \nyn@ersch{#1}\else
   \ifx\@testa\@leerz\nyn@ersch{#1}\else
         {\ignorespaces #5\ba@textmode}%
   \fi\fi}}%
}
\def\@ersch#1|#2|{\@ifnextchar[{\@@ersch{#1}|#2|}{\@@ersch{#1}|#2|[]}}
\def\persch#1{\leavevmode\ba@textmode\@ifnextchar|{\@ersch{#1}}{\@ersch{#1}||}}
\def\ersch{\protect\persch{\langcap@ba}}

\def\peordinal#1{{\errorcontextlines=-1\leavevmode \count@ba #1\relax
        \ifnum\count@ba\string<0 \count@ba -\count@ba\fi
  \loop \ifnum\count@ba\string>999 \advance\count@ba -1000\repeat
  \loop \ifnum\count@ba\string>99 \advance\count@ba -100\repeat
  \loop \ifnum\count@ba\string>29 \advance\count@ba -10\repeat
        \ifnum\count@ba\string>19 \advance\count@ba -20\fi
  {\ignorespaces #1}\kern 0.8pt%
  \fup{\ifcase\number\count@ba th\or
  \kern -1.4pt st\or nd\or rd\or \kern -0.7pt th\or th\or th\or th\or th\or th\or th\or  %% 1-10
  \kern -1.4pt th\or th\or th\or \kern -0.7pt th\else th\fi \kern 0.2pt}\nulskip@ba}}  %% 11-14
\def\eordinal{\protect\peordinal}


\def\pfordinal#1#2{{\errorcontextlines=-1\leavevmode \count@ba #2\relax
        \ifnum\count@ba\string<0 \count@ba -\count@ba\fi
  \loop \ifnum\count@ba\string>1019 \advance\count@ba -1000\repeat
  \loop \ifnum\count@ba\string>119 \advance\count@ba -100\repeat
  \loop \ifnum\count@ba\string>19 \advance\count@ba -10\repeat
  {\ignorespaces #2}\kern 0.8pt%
  \fup{\ifcase\number\count@ba e\or
  \kern -1.4pt{#1}\kern 0.2pt \or e\or \kern -0.3pt e\or \kern -0.7pt e\or \kern -0.3pt e\or e\or e\or e\or e\or e\or  %% 1-10
  \kern -1.4pt               e\or e\or \kern -0.3pt e\or \kern -0.7pt e\or \kern -0.3pt e\else e\fi}\nulskip@ba}}  %% 11-14
\def\fordinalf{\protect\pfordinal{re}}
\def\fordinalm{\protect\pfordinal{er}}
\let\fordinal=\fordinalf  %\let\fordinal=\fordinalm

\def\pgordinal#1{{\ignorespaces #1.}\nulskip@ba}
\def\gordinal{\protect\pgordinal}

\expandafter\ifx\csname pteskip\endcsname\relax
 \def\pteskip{\nobreak \hskip 0.2em plus 0.1em minus 0.05em}%
\fi
 \def\teskip{\protect\pteskip}

\expandafter\ifx\csname pfupskip\endcsname\relax
 \def\pfupskip{\nobreak \hskip 0.2em plus 0.1em minus 0.05em}%
\fi
 \def\fupskip{\protect\pfupskip}


%%


\def\next@hy{}
\def\test@hy{}
\def\txen@hy{}

\def\Atest@hy{A@}

\def\acckorr@hy#1{%
 \def\test@hy{#1}%
 \ifx#1A\kern -0.06em\fi  \ifx\test@hy\Atest@hy\kern -0.06em\fi
 \ifx#1V\kern -0.1em\fi
 \ifx#1W\kern -0.1em\fi
 \ifx#1T\kern -0.1em\fi
 \ifx#1v\kern -0.04em\fi
 \ifx#1w\kern -0.04em\fi
 \ifx#1X\kern -0.06em\fi
 \ifx#1Y\kern -0.12em\fi
 \ifx#1y\kern -0.04em\fi
 \ifx#1x\kern -0.04em\fi
 \txen@hy{#1}}

\def\accentnum@hy#1 #2{%
 \ifx#2A\kern -0.06em\fi
 \ifx#2V\kern -0.1em\fi
 \ifx#2W\kern -0.1em\fi
 \ifx#2T\kern -0.1em\fi
 \ifx#2v\kern -0.04em\fi
 \ifx#2w\kern -0.04em\fi
 \ifx#2X\kern -0.06em\fi
 \ifx#2Y\kern -0.12em\fi
 \ifx#2y\kern -0.04em\fi
 \ifx#2x\kern -0.04em\fi
 \accent #1 #2}

\def\aktacckorr@hy#1{\ifx#1\dq@prtct \else
  \message{[ HYKO: Get unexpected \string#1 ] }\fi
 \acckorr@hy}

\def\getarg@hy{\afterassignment\nextarg@hy\let\txen@hy= }

\def\nextarg@hy{\bgroup
 \ifx\txen@hy\accent
 \expandafter\accentnum@hy\else
 \expandafter\txen@hy\fi}

\def\gonext@hy{\let\txen@hy=\next@hy \let\next@hy=\acckorr@hy}
\def\goact@hy{\let\txen@hy=\next@hy \let\next@hy=\aktacckorr@hy}

{\catcode\grave@ba\"=13%
 \catcode\grave@ba\`=12%
 \catcode\grave@ba\'=12%
\gdef\hykorr@hy{%
 \if@hyko
 \ifx\next@hy A\kern -0.06em\fi
 \ifx\next@hy V\kern -0.1em\fi
 \ifx\next@hy W\kern -0.1em\fi
 \ifx\next@hy T\kern -0.1em\fi
 \ifx\next@hy v\kern -0.04em\fi
 \ifx\next@hy w\kern -0.04em\fi
 \ifx\next@hy X\kern -0.06em\fi
 \ifx\next@hy Y\kern -0.12em\fi
 \ifx\next@hy y\kern -0.04em\fi
 \ifx\next@hy x\kern -0.04em\fi
 \ifx\next@hy          "\gonext@hy\fi
 \ifx\next@hy \newumlaut\gonext@hy\fi
 \ifx\next@hy \active@dq\goact@hy \fi
 \ifx\next@hy \bgroup   \let\next@hy=\getarg@hy\fi
 \ifx\next@hy \accent\let\next@hy=\accentnum@hy\fi
 \ifx\next@hy \"\gonext@hy\fi
 \ifx\next@hy \.\gonext@hy\fi
 \ifx\next@hy \=\gonext@hy\fi
 \ifx\next@hy \^\gonext@hy\fi
 \ifx\next@hy \'\gonext@hy\fi
 \ifx\next@hy \`\gonext@hy\fi
 \ifx\next@hy \~\gonext@hy\fi
 \ifx\next@hy \b\gonext@hy\fi  \ifx\next@hy \pb\gonext@hy\fi
 \ifx\next@hy \c\gonext@hy\fi  \ifx\next@hy \pc\gonext@hy\fi
 \ifx\next@hy \d\gonext@hy\fi  \ifx\next@hy \pd\gonext@hy\fi
 \ifx\next@hy \H\gonext@hy\fi
 \ifx\next@hy \k\gonext@hy\fi
 \ifx\next@hy \r\gonext@hy\fi
 \ifx\next@hy \u\gonext@hy\fi
 \ifx\next@hy \v\gonext@hy\fi
 \ifx\next@hy `\kern 0.04em\fi
 \ifx\next@hy '\kern 0.04em\fi
 \ifx\next@hy \glq\kern 0.04em\fi  \ifx\next@hy \@glq\kern 0.04em\fi
 \ifx\next@hy ]\kern -0.04em\fi
 \ifx\next@hy )\kern -0.04em\fi
 \ifx\next@hy \}\kern -0.05em\fi  \ifx\next@hy \@rb\kern -0.05em\fi
 \fi
 \nulskip@ba\next@hy}%
}

\def\after@hy{\afterassignment\hykorr@hy\let\next@hy= }

\newif\if@hyko\@hykotrue

\def\phyko{\@hykotrue}%
\def\hyko{\protect\phyko}%

\def\pnothyko{\@hykofalse}%
\def\nothyko{\protect\pnothyko}%

\def\phy{\leavevmode\nulskip@ba\ifmmode\hbox{-}\else\discretionary{-}{}{-}\fi\after@hy}
%\def\phy{\leavevmode\nulskip@ba\ifmmode\hbox{-}\else\discretionary{-}{}{-}\fi\nulskip@ba}
\def\pfhy{\leavevmode\nulskip@ba\hbox{-}\after@hy}
%\def\pfhy{\leavevmode\nulskip@ba\hbox{-}\nulskip@ba}

\def\hy{\protect\phy}
\def\fhy{\protect\pfhy}


%%


\def\te{.\protect\pteskip}

\def\pko{\ifhmode\nobreak\hskip -0.07em plus 0em\fi}
\def\ko{\protect\pko}


\expandafter\ifx\csname omicron\endcsname\relax\def\omicron{o}\fi

\def\pbasimgl{\normalfont} %{\normalfont\rule[.3ex]{.02em}{.5ex}\kern-.02em}
\def\basimgreeklatin{\protect\pbasimgl}
\expandafter\ifx\csname Alpha\endcsname\relax\def\Alpha{\mbox{\basimgreeklatin A}}\fi
\expandafter\ifx\csname Beta\endcsname\relax\def\Beta{\mbox{\basimgreeklatin B}}\fi
\expandafter\ifx\csname Epsilon\endcsname\relax\def\Epsilon{\mbox{\basimgreeklatin E}}\fi
\expandafter\ifx\csname Zeta\endcsname\relax\def\Zeta{\mbox{\basimgreeklatin Z}}\fi
\expandafter\ifx\csname Eta\endcsname\relax\def\Eta{\mbox{\basimgreeklatin H}}\fi
\expandafter\ifx\csname Iota\endcsname\relax\def\Iota{\mbox{\basimgreeklatin I}}\fi
\expandafter\ifx\csname Kappa\endcsname\relax\def\Kappa{\mbox{\basimgreeklatin K}}\fi
\expandafter\ifx\csname Mu\endcsname\relax\def\Mu{\mbox{\basimgreeklatin M}}\fi
\expandafter\ifx\csname Nu\endcsname\relax\def\Nu{\mbox{\basimgreeklatin N}}\fi
\expandafter\ifx\csname Omicron\endcsname\relax\def\Omicron{\mbox{\basimgreeklatin O}}\fi
\expandafter\ifx\csname Rho\endcsname\relax\def\Rho{\mbox{\basimgreeklatin P}}\fi
\expandafter\ifx\csname Tau\endcsname\relax\def\Tau{\mbox{\basimgreeklatin T}}\fi
\expandafter\ifx\csname Chi\endcsname\relax\def\Chi{\mbox{\basimgreeklatin X}}\fi


%%


                     %% German word division %%


%% A very old replacement for \ss, IF no sharp S exists, e.g. in \scshape: %%
\expandafter\ifx\csname sz\endcsname\relax
\def\sz{{sz}}%
\else
\typeout{\string\sz-command used. I do not redefine.}%
\fi

\expandafter\ifx\csname SZ\endcsname\relax
\def\SZ{{SZ}}%
\else
\typeout{\string\SZ-command used. I do not redefine.}%
\fi

%%

%% A sharp S which ALWAYS splits s-s (to be used between vovels, e.g. %%
%% au\oldhyss er).  Use YOUR sharp S at OTHER positions (e.g. da\ss): %%
\def\oldhyss{\penalty\@M\discretionary{s-}{s}{\ss}\protect\nulskip@ba}
\def\OLDHYSS{\penalty\@M\discretionary{S-}{S}{\SS}\protect\nulskip@ba}


{\catcode\grave@ba\>=12%
\gdef\@newhyss#1{{%
  \def\@testa{#1}%
  \def\@testb{\SS}%
  \ifx\@testa\@testb
    {\OLDHYSS}%
  \else
    \setbox\testbox@ba=\hbox{#1}%
    \ifdim\ht\testbox@ba>1.4ex
      {\ss}%       %% split as def in \language %%
    \else
      {\oldhyss}%  %% INVISIBLE in \showhyphens %%
    \fi
  \fi}}%
}

%% A sharp S which splits s-s ONLY in small caps; ELSE %%
%% as \language says (-\ss ?). For use between vovels: %%
\def\newhyss{\protect\@newhyss{\ss}}
\def\NEWHYSS{\protect\@newhyss{\SS}}


%% In Old German (=Old Austrian ?) hyphenation, %% 
%% \hyss splits as \oldhyss;  ELSE as \newhyss: %%
\def\hyss{\expandafter\ifx\csname l@german\endcsname\relax \newhyss\else \ifnum\language=\l@german\oldhyss\else\newhyss\fi \fi}
\def\HYSS{\expandafter\ifx\csname l@german\endcsname\relax \NEWHYSS\else \ifnum\language=\l@german\OLDHYSS\else\NEWHYSS\fi \fi}

%%

\def\hycons@ba#1#2{\penalty\@M\discretionary{#1-}{}{#2}\protect\nulskip@ba}
\def\HYCONS@BA#1#2{\penalty\@M\discretionary{#1-}{}{#2}\protect\nulskip@ba}

\def\hyvari@ba#1#2{\expandafter\ifx\csname l@german\endcsname\relax {#1}\else \ifnum\language=\l@german \csname oldhy#2\endcsname \else {#1}\fi \fi}
\def\HYVARI@BA#1#2{\expandafter\ifx\csname l@german\endcsname\relax {#1}\else \ifnum\language=\l@german \csname OLDHY#2\endcsname \else {#1}\fi \fi}


%% "Inside-c before k": %%
\def\oldhyc{\hycons@ba{k}{c}}   %% always old:  Dru\oldhyc ker
\def\OLDHYC{\HYCONS@BA{K}{C}}
   \def\hyc{\hyvari@ba{c}{c}}   %% spells new in ngerman, naustrian
   \def\HYC{\HYVARI@BA{C}{C}}


%% "Triple consonant before a vovel": %%
\def\oldhyl{\hycons@ba{ll}{l}}  %% always old:  Scha\oldhyl leistung
\def\OLDHYL{\HYCONS@BA{LL}{L}}
   \def\hyl{\hyvari@ba{ll}{l}}  %% spells new in ngerman, naustrian
   \def\HYL{\HYVARI@BA{LL}{L}}

\def\oldhym{\hycons@ba{mm}{m}}  %% Sta\oldhym mutter
\def\OLDHYM{\HYCONS@BA{MM}{M}}
   \def\hym{\hyvari@ba{mm}{m}}
   \def\HYM{\HYVARI@BA{MM}{M}}

\def\oldhyn{\hycons@ba{nn}{n}}  %% Ke\oldhyn nummer
\def\OLDHYN{\HYCONS@BA{NN}{N}}
   \def\hyn{\hyvari@ba{nn}{n}}
   \def\HYN{\HYVARI@BA{NN}{N}}

\def\oldhyp{\hycons@ba{pp}{p}}  %% Ste\oldhyp pullover
\def\OLDHYP{\HYCONS@BA{PP}{P}}
   \def\hyp{\hyvari@ba{pp}{p}}
   \def\HYP{\HYVARI@BA{PP}{P}}

\def\oldhyr{\hycons@ba{rr}{r}}  %% Sta\oldhyr rahmen
\def\OLDHYR{\HYCONS@BA{RR}{R}}
   \def\hyr{\hyvari@ba{rr}{r}}
   \def\HYR{\HYVARI@BA{RR}{R}}

\def\oldhyt{\hycons@ba{tt}{t}}  %% Schri\oldhyt tempo
\def\OLDHYT{\HYCONS@BA{TT}{T}}
   \def\hyt{\hyvari@ba{tt}{t}}
   \def\HYT{\HYVARI@BA{TT}{T}}

\def\oldhyf{\hycons@ba{ff}{f}}  %% Sto\oldhyf figur
\def\OLDHYF{\HYCONS@BA{FF}{F}}
   \def\hyf{\hyvari@ba{ff}{f}}
   \def\HYF{\HYVARI@BA{FF}{F}}


%%


%% Dummy for systems with parameter stack size=60 %%
\expandafter\ifx\csname footnotetext\endcsname\relax
\else
{\setbox\testbox@ba=\hbox{\footnotetext{\printonlyvli{}{}{}}}}\clearmem@ba
\fi


\def\escb@ba{\ifvmode\leavevmode\lower -1ex\hbox{\strut}\else\nulskip@ba\fi}

\def\babbrack#1{\escb@ba{\upshape
   \lower 0.25ex\hbox{\tiny [}\hbox{#1}%
   \lower 0.25ex\hbox{\tiny ]}\kern 0.02em{}}}

\def\bambrack#1{\iflasthasdot@ba{}{\@baupcorr}\escb@ba{\upshape
   \lower -0.5ex\hbox{\lower 1.5pt\hbox{\tiny [}}\hbox{#1}%
   \lower -0.5ex\hbox{\lower 1.5pt\hbox{\tiny ]}}\kern 0.02em{}}}

\def\batbrack#1{\iflasthasdot@ba{}{\@baupcorr}\escb@ba{\upshape
   \lower -1.4ex\hbox{\lower 3pt\hbox{\tiny [}}\hbox{#1}%
   \lower -1.4ex\hbox{\lower 3pt\hbox{\tiny ]}}}{\@baendcorr}\kern 0.02em{}}


{\catcode\grave@ba\"=12%
 \expandafter\ifx\csname dq\endcsname\relax
  \gdef\dq{"}%  %% compatibility to 2.0 %%
 \fi
 \gdef\dq@bapas{\dq}}

{\catcode\grave@ba\"=13%
 \catcode\grave@ba\'=12%
 \catcode\grave@ba\`=12%
 \gdef\rqq@baakt{"'}%
 \gdef\lqq@baakt{"`}%
 \catcode\grave@ba\'=13%
 \catcode\grave@ba\`=13%
 \gdef\rqq@baaaa{"'}%
 \gdef\lqq@baaaa{"`}}

{\catcode\grave@ba\'=12%
 \gdef\c@bapas{'}%
 \gdef\cc@bapas{''}%
 \gdef\cp@bapas{\active@dq\dq@prtct{'}}}
{\catcode\grave@ba\'=13%
 \gdef\c@baakt{'}%
 \gdef\cc@baakt{''}%
 \gdef\cp@baakt{\active@dq\dq@prtct{'}}}

{\catcode\grave@ba\`=12%
 \gdef\o@bapas{`}%
 \gdef\oo@bapas{``}%
 \gdef\op@bapas{\active@dq\dq@prtct{`}}}
{\catcode\grave@ba\`=13%
 \gdef\o@baakt{`}
 \gdef\oo@baakt{``}%
 \gdef\op@baakt{\active@dq\dq@prtct{`}}}

\def\@abra#1{{\errorcontextlines=-1%
   \def\@testa{#1}%
   \def\testk{,}%
   \def\testp{.}%
   \def\testm{$-$}%
   \def\testh{-}%
   \def\testH{--}%
   \def\testL{---}%
   \def\testl{\glq}%
   \def\teatl{\@glq}%   %% commands in old versions of german.sty
   \def\testr{\grq}%
   \def\teatr{\@grq}%   %%
   \def\testO{\glqq}%
   \def\teatO{\@glqq}%  %%
   \def\testC{\grqq}%
   \def\teatC{\@grqq}%  %%
   \def\testd{...}%
   \def\testD{\dots}%
   \ifx\@testa\oo@bapas \oo@abra{\oo@bapas}\else
   \ifx\@testa\oo@baakt \oo@abra{\oo@baakt}\else
   \ifx\@testa\cc@bapas \cc@abra{\cc@bapas}\else
   \ifx\@testa\cc@baakt \cc@abra{\cc@baakt}\else
   \ifx\@testa\cp@bapas\rqq@abra{\cp@bapas}\else
   \ifx\@testa\cp@baakt\rqq@abra{\cp@baakt}\else
   \ifx\@testa\op@bapas\lqq@abra{\op@bapas}\else
   \ifx\@testa\op@baakt\lqq@abra{\op@baakt}\else
   \ifx\@testa\o@bapas   \o@abra{\o@bapas}\else
   \ifx\@testa\o@baakt   \o@abra{\o@baakt}\else
   \ifx\@testa\c@bapas   \c@abra{\c@bapas}\else
   \ifx\@testa\c@baakt   \c@abra{\c@baakt}\else
   \ifx\@testa\testk    \babbrack{\kern -0.02em{\testk}\kern -0.02em}\else
   \ifx\@testa\testp    \babbrack{\kern -0.02em{\testp}\kern -0.02em}\else
   \ifx\@testa\testm    \bambrack{\kern -0.03em{\testm}\kern -0.035em}\else
   \ifx\@testa\testh    \bambrack{\kern -0.01em{\testh}\kern -0.05em}\else
   \ifx\@testa\testH    \bambrack{\kern  0.03em{\testH}\kern  0.03em}\else
   \ifx\@testa\testL    \bambrack{\kern  0.03em{\testL}\kern  0.03em}\else
   \ifx\@testa\testl    \lq@abra{\testl}\else
   \ifx\@testa\teatl    \lq@abra{\teatl}\else
   \ifx\@testa\testr    \rq@abra{\testr}\else
   \ifx\@testa\teatr    \rq@abra{\teatr}\else
   \ifx\@testa\testO    \lqq@abra{\testO}\else
   \ifx\@testa\teatO    \lqq@abra{\teatO}\else
   \ifx\@testa\testC    \rqq@abra{\testC}\else
   \ifx\@testa\teatC    \rqq@abra{\teatC}\else
   \ifx\@testa\lqq@baakt\lqq@abra{\lqq@baakt}\else
   \ifx\@testa\lqq@baaaa\lqq@abra{\lqq@baaaa}\else
   \ifx\@testa\rqq@baakt\rqq@abra{\rqq@baakt}\else
   \ifx\@testa\rqq@baaaa\rqq@abra{\rqq@baaaa}\else
   \ifx\@testa\dq        \dq@abra{\dq}\else
   \ifx\@testa\dq@bapas  \dq@abra{\dq@bapas}\else
   \ifx\@testa\testd    \babbrack{\kern -0.01em{\testd}\kern -0.03em}\else
   \ifx\@testa\testD    \babbrack{\kern  0.12em{\testD}\kern -0.08em}\else
   \iflasthasdot@ba{}{\@baupcorr}\ifhmode\nulskip@ba\fi{\upshape [{#1}]}\fi\fi\fi\fi\fi\fi\fi\fi\fi\fi\fi\fi\fi\fi\fi\fi\fi\fi\fi\fi\fi\fi\fi\fi\fi\fi\fi\fi\fi\fi\fi\fi\fi\fi
   }}

 \def\oo@abra#1{\batbrack{\if@batone{\kern  0.04em{#1}\kern -0.06em}{\kern -0.11em{#1}}}}
 \def\cc@abra#1{\batbrack{\if@batone{\kern  0.03em{#1}\kern -0.05em}{\kern  0.01em{#1}\kern -0.12em}}}
  \def\o@abra#1{\batbrack{\kern -0.02em{#1}\kern -0.02em}}
 \def\lq@abra#1{\babbrack{\if@batone{\kern -0.02em{#1}\kern -0.1034em}{\kern -0.02em{#1}\kern 0.02em}}}
  \def\c@abra#1{\batbrack{\kern -0.02em{#1}\kern -0.02em}}
\def\lqq@abra#1{\babbrack{\if@batone{\kern  0.03em{#1}\kern -0.05em}{\kern 0.01em{#1}\kern -0.08em}}}
\def\rqq@abra#1{\batbrack{\if@batone{\kern  0.04em{#1}\kern -0.06em}{\kern -0.04em{#1}\kern -0.07em}}}
 \def\dq@abra#1{\batbrack{\if@batone{\kern -0.043em{#1}\kern -0.06em}{\kern 0.01em{#1}\kern -0.12em}}}
 \def\rq@abra#1{\batbrack{\if@batone{\kern -0.02em{#1}\kern -0.02em}{\kern -0.01em{#1}\kern -0.0875em}}}

\def\pabra#1{\@abra{#1}{\hskip 0pt plus 0pt}}
\def\abra{\protect\pabra}

\def\pfabra#1{\@abra{#1}{\nulskip@ba}}
\def\fabra{\protect\pfabra}


\def\pbaromannum#1{{\romannumeral #1}}
\def\baromannum{\protect\pbaromannum}

\def\pbaRomannum#1{\uppercase\expandafter{\romannumeral #1}}
\def\baRomannum{\protect\pbaRomannum}


%%


                        %% Layout %%


\def\bakorr@fnr{}    %%{originalquote}%%
\let\fnrbasave=\footnoterule
\def\footnoterule{\bakorr@fnr\vfill\fnrbasave}
%% \vfill INSTEAD OF \flushbottom %%

%\footnotesep=2ex

\def\bibsortargs{unknown (no BibArts list printed yet)}

\def\@baposvskip{\vskip  \baselineskip \vskip  \lineskip}
\def\@banegvskip{\vskip -\baselineskip \vskip -\lineskip}
\newif\if@bibsortspace\@bibsortspacefalse
\newif\if@bibsorthead\@bibsortheadfalse
\def\do@bibsortspace{\@baposvskip\pagebreak[3]}
\def\do@twocolumnbsh#1{\@baposvskip\pagebreak[3]%
  \item{}\rule{5pt}{0pt}\nopagebreak
    \@baposvskip\rule{5pt}{0pt}\pagebreak[3]%    
  \item{}\@banegvskip\@banegvskip\@banegvskip
    {\@baheademph{#1}}\nopagebreak
  }
\def\do@onecolumnbsh#1{%
  \nopagebreak\@baposvskip\@baposvskip\pagebreak[3]\@banegvskip\item{}{\@baheademph{#1}}\nopagebreak
  }
\def\do@nobibsortspace{}
\def\do@nobibsorthead#1{}
\def\@baheademph{\normalfont\large\bfseries\sffamily}

\let\bibsortpreparespace\do@nobibsortspace
\let\bibsortpreparexspace\do@nobibsortspace
\let\bibsortpreparehead\do@nobibsorthead

\def\bibsortspaces{\protect\@bibsortspacetrue\protect\@bibsortheadfalse}
\def\notbibsortspaces{\protect\@bibsortspacefalse\protect\@bibsortheadfalse}
\def\bibsortheads{\protect\@bibsortspacefalse\protect\@bibsortheadtrue}
\def\notbibsortheads{\protect\@bibsortspacefalse\protect\@bibsortheadfalse}

\def\pbafootnoteframe#1{/#1/}
\def\bafootnoteframe{\protect\pbafootnoteframe}
\def\pbapageframe#1{/#1/}
\def\bapageframe{\protect\pbapageframe}



                %% Compatibility to BibArts 3.1 %%

\def\bib{\arq{}}
\def\printonlybib{\printonlyarq{}}
\def\addtobib{\addtoarq{}}
\newif\if@oldba\@oldbafalse
\def\makebar{\typeout@ba{ \space ***** \space That is obviously a file based on BibArts 1.x \space *****
   ^^J \space ***** \space BibArts 2.2 starts compatibility mode for 1.3 \space *****}%
  \def\bibarts{\BibArts}%
  \def\schrift{}%
  \def\barschrift{}%
  \def\indschrift{}%
  \newif\ifbibarts\bibartsfalse
  \newif\iffootnote\footnotefalse
  \def\Kapitell##1{}%
  \def\@Kapitell##1##2{}%
  \def\printind{\ba@textmode\type@bawarn{I use arq-list for 1.3 cmd \string\printind}%
    \Check@tcbalist{\@batwocoldefs}{\bibsortheads
     \def\arqlistemph{}\def\balistnumemph{}%
     \def\earqtitlename{Index}\def\farqtitlename{Index}%
     \def\garqtitlename{Index}\small}{num}{arq}{subsection}}%
  \@oldbatrue}
\def\printind{\errhelp{Forget so set \makebar to switch to BibArts 1.3 compatibility mode?}%
  \@qqertypeout{printind}{Expiring cmd.}\errmessage@ba{\string\printind\space without \string\makebar}}

\def\pstressing#1{\@bsphack\def\authoremph{\upshape\csname #1\endcsname}\@esphack}
 \def\stressing{\protect\pstressing}

\def\gbibmarkname{im Folgenden: }
\def\fbibmarkname{par la suite: }
\def\ebibmarkname{cited as: }
\def\pbibref#1{{#1} {\ba@varstringtrue\ba@varref{}{BIB}{#1}}}
 \def\bibref{\protect\pbibref}
\def\pxbibref#1#2{{#2} {\ba@varstringtrue\ba@varref{}{XBIB}{#1}}}
 \def\xbibref#1#2{\protect\pxbibref{#2}{#1}}
\def\pbibmark#1{{\cap@ba{bibmark}}{#1}{\ba@varstringtrue\ba@varlabel{}{BIB}{#1}}}
 \def\bibmark{\protect\pbibmark}
\def\pxbibmark#1#2{{\cap@ba{bibmark}}{#1}{\ba@varstringtrue\ba@varlabel{}{XBIB}{#2}}}
 \def\xbibmark{\protect\pxbibmark}


\message{Load BibArts\string: End.}

\endinput
