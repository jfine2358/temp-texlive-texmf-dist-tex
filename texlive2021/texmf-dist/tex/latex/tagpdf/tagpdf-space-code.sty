%%
%% This is file `tagpdf-space-code.sty',
%% generated with the docstrip utility.
%%
%% The original source files were:
%%
%% tagpdf-space.dtx  (with options: `space')
%% 
%% Copyright (C) 2019 Ulrike Fischer
%% 
%% It may be distributed and/or modified under the conditions of
%% the LaTeX Project Public License (LPPL), either version 1.3c of
%% this license or (at your option) any later version.  The latest
%% version of this license is in the file:
%% 
%%    https://www.latex-project.org/lppl.txt
%% 
%% This file is part of the "tagpdf bundle" (The Work in LPPL)
%% and all files in that bundle must be distributed together.
%% 
%% File: tagpdf-space.dtx
\ProvidesExplPackage {tagpdf-space-code} {2021/02/23} {0.80}
 {part of tagpdf - code related to real space chars}

\sys_if_engine_pdftex:T
  {
    \pdfglyphtounicode{space}{0020}
    \keys_define:nn { __tag / setup }
      {
        interwordspace .choices:nn = { true, on }  { \pdfinterwordspaceon },
        interwordspace .choices:nn = { false, off }{ \pdfinterwordspaceon },
        show-spaces .bool_set:N = \l__tag_showspaces_bool
      }
  }

\sys_if_engine_luatex:T
  {
    \keys_define:nn { __tag / setup }
      {
        interwordspace .choices:nn =
                                 { true, on }
                                 { \directlua{ltx.__tag.func.markspaceon()} },
        interwordspace .choices:nn =
                                 { false, off }
                                 {\directlua{ltx.__tag.func.markspaceoff()} },
        show-spaces      .choice:,
        show-spaces  / true  .code:n =
                                 {\directlua{ltx.__tag.trace.showspaces=true}},
        show-spaces  / false .code:n =
                                 {\directlua{ltx.__tag.trace.showspaces=nil}},
        show-spaces .default:n = true
      }

    \cs_new_protected:Nn \__tag_fakespace:
      {
        \group_begin:
        \setattribute\g__tag_interwordspace_attr{1}
        \setattribute\g__tag_interwordfont_attr
          {
            \directlua{tex.print(\the\catcodetable@latex, font.current())}
          }
        \skip_horizontal:n{\c_zero_skip}
        \group_end:
      }
  }

\sys_if_engine_xetex:T
  {
    \keys_define:nn { __tag / setup }
      {
        interwordspace .choices:nn = { true, on }  { \msg_warning:nnn {tag}{sys-no-interwordspace}{xetex}  },
        interwordspace .choices:nn = { false, off }{ \msg_warning:nnn {tag}{sys-no-interwordspace}{xetex}  },
        show-spaces .bool_set:N = \l__tag_showspaces_bool
      }
  }

%% 
%%
%% End of file `tagpdf-space-code.sty'.
